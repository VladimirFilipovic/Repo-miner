arXiv:0802.4155v3 [quant-ph] 30 Sep 2009
The Security of Practical Quantum Key Distribution
Valerio Scarani1,2, Helle Bechmann-Pasquinucci 3,4, Nicolas J. Cerf5, Miloslav Duˇsek 6, Norbert L¨utkenhaus7,8,
Momtchil Peev9
1 Centre for Quantum Technologies and Department of Physics, National University of Singapore, Singapore
2 Group of Applied Physics, University of Geneva, Geneva, Switzerland
3 University of Pavia, Dipartimento di Fisica “A. Volta”, Pavia, Italy
4 UCCI.IT, Rovagnate (LC), Italy
5 Quantum Information and Communication, Ecole Polytechnique, Universit´e Libre de Bruxelles, Brussels, Belgium
6 Department of Optics, Faculty of Science, Palack´y University, Olomouc, Czech Republic
7 Institute for Quantum Computing & Department for Physics and Astronomy, University of Waterloo, Waterloo, Canada
8 Max Planck Research Group, Institute for Optics, Information
and Photonics, University of Erlangen-Nuremberg, Erlangen, Germany
9 Quantum Technologies, Smart Systems Division, Austrian Research Centers GmbH ARC, Vienna,
Austria
(Dated: September 30, 2009)
Quantum key distribution (QKD) is the first quantum information task to reach the level of
mature technology, already fit for commercialization. It aims at the creation of a secret key between authorized partners connected by a quantum channel and a classical authenticated channel.
The security of the key can in principle be guaranteed without putting any restriction on the
eavesdropper’s power.
The first two sections provide a concise up-to-date review of QKD, biased toward the practical
side. The rest of the paper presents the essential theoretical tools that have been developed to
assess the security of the main experimental platforms (discrete variables, continuous variables
and distributed-phase-reference protocols).
Contents
I. Introduction 2
A. Cryptography 2
B. Basics of Quantum Key Distribution (QKD) 3
1. Generic setting 3
2. The origin of security 3
3. The choice of light 4
4. The BB84 protocol 4
5. An example of eavesdropping 5
6. Beyond the example: the field of QKD 5
C. Scope of this review 6
1. Focus 6
2. Outline 6
II. The Elements of Practical QKD 6
A. Milestones 6
1. Foundations: 1984-1995 6
2. The theory-experiment gap opens: 1993-2000 6
3. Closing the gap: 2000 to present 7
B. Generic QKD Protocol 8
1. Classical and quantum channels 8
2. Quantum information processing 8
3. Classical information processing 9
4. Secret fraction and secret key rate 9
C. Notions of Security 9
1. Unconditional security, and its conditions 9
2. Definition of security 10
3. Security proofs 10
D. Explicit Protocols 11
1. Three families 11
2. Discrete-variable Protocols 12
3. Continuous-variable Protocols 13
4. Distributed-phase-reference Protocols 14
E. Sources 15
1. Lasers 15
2. Sub-Poissonian Sources 16
3. Sources of Entangled Photons 16
F. Physical Channels 17
1. Fiber Links 17
2. Free Space Links 18
G. Detectors 18
1. Photon Counters 18
2. Homodyne Detection 18
H. Synchronization and alignment 19
1. Generalities 19
2. Phase coding: two configurations 20
III. Secret Key Rate 21
A. Raw key rate 21
B. Secret fraction 21
1. Classical information post-processing 21
2. Individual, Collective and Coherent Attacks 23
3. Quantum side channels and zero-error attacks 25
4. Hacking on Practical QKD 25
5. A crutch: the “uncalibrated-device scenario” 26
IV. Discrete-variable protocols 26
A. Generic Assumptions and Tools 26
1. Photon-number statistics 26
2. Qubits and Modes 27
3. Secret key rate 27
B. BB84 coding: lower bounds 28
1. Prepare-and-Measure: Generalities 28
2. P&M without decoy states 28
3. P&M with decoy states 28
4. P&M: analytical estimates 29
5. Entanglement-Based 30
C. BB84 coding: upper bounds incorporating the
calibration of the devices 31
1. Statistical parameters 31
2. Upper bounds 31
D. Bounds for the SARG04 coding 32
V. Continuous-variable protocols 32
A. Status of security proofs 322
B. Bounds for Gaussian protocols 33
1. Generalities 33
2. Modeling the noise 34
3. Information Alice-Bob 34
4. Individual attacks 35
5. Collective attacks 35
6. Collective attacks and post-selection 35
VI. Distributed-phase-reference protocols 36
A. Status of security proofs 36
B. Bounds for DPS and COW 36
1. Collective beam-splitting attack 36
2. More sophisticated attacks 37
VII. Comparison of experimental platforms 37
A. Generalities 37
1. Model for the source and channel 38
2. Choice of the parameters 38
B. Comparisons based on K 39
1. All platforms on a plot 39
2. Upper bound incorporating the calibration of the
devices 40
C. Comparison based on the “cost of a linear network” 40
VIII. Perspectives 41
A. Perspectives within QKD 41
1. Finite-key analysis 41
2. Open issues in unconditional security 41
3. Black-box security proofs 42
4. Toward longer distances: satellites and repeaters 42
5. QKD in networks 42
B. QKD versus other solutions 43
Note added in proof 44
Acknowledgements 44
A. Unconditional security bounds for BB84 and
six-states, single-qubit signals 44
B. Elementary estimates for quantum repeaters 45
1. Quantum memories 45
2. Model of quantum repeater 46
a. Definition of the model 46
b. Detection rates 46
References 47
I. INTRODUCTION
A. Cryptography
Cryptography is a field of applications that provide privacy, authentication and confidentiality to users. An important subfield is that of secure communication, aiming
at allowing confidential communication between different
parties such that no unauthorized party has access to the
content of the messages. This field has a long history of
successes and failures, as many methods to encode messages emerged along the centuries, always to be broken
some time later.
History needs not repeat forever, though. In 1917, Vernam invented the so-called One-Time Pad encryption,
which uses a symmetric, random secret key shared between sender and receiver (Vernam, 1926). This scheme
cannot be broken in principle, provided the parties do
not reuse their key. Three decades later, Shannon proved
that the Vernam scheme is optimal: there is no encryption method that requires less key (Shannon, 1949). This
means that the key is being used up in the process. To
employ this scheme, therefore, the communicating parties must have a secure method to share a key as long
as the text to be encrypted. Because of this limitation,
which becomes severe in case huge amounts of information have to be securely transmitted, most cryptographic
applications nowadays are based on other schemes, whose
security cannot be proved in principle, but is rather based
on our experience that some problems are hard to solve.
In other words, these schemes can be broken, but with
a substantial amount of computational power. One can
therefore set a security parameter to a value, such that
the amount of required computational power lies beyond
the amount deemed to be available to an adversary; the
value can be adjusted in time, along with technological
advances.
The picture has changed in the last two decades,
thanks to unexpected inputs from quantum physics. In
the early 1980s, Bennett and Brassard proposed a solution to the key distribution problem based on quantum
physics (Bennett and Brassard, 1984); this idea, independently re-discovered by Ekert a few years later (Ekert,
1991), was the beginning of quantum key distribution
(QKD) which was to become the most promising task of
quantum cryptography1. Since then, QKD devices have
constantly increased their key generation rate and have
started approaching maturity, needed for implementation
in realistic settings.
In an intriguing independent development, ten years
after the advent of QKD, Peter Shor discovered that large
numbers can in principle be factorized efficiently if one
1 Quantum cryptography is often identified with QKD, but actually comprises all possible tasks related to secrecy that are
implemented with the help of quantum physics. The first appearance of a link between secrecy and quantum physics was
Wiesner’s idea of quantum money, which dates back to the early
1970s although was published a decade later (Wiesner, 1983).
To our knowledge, there is nothing else before Bennett’s and
Brassard’s first QKD protocol. In 1999, two new tasks were
invented and both were given the same name, quantum secret sharing. In one case, the protocol is a multi-partite generalization of key distribution (Hillery, Buˇzek and Berthiaume,
1999; Karlsson, Koashi and Imoto, 1999); in the other case
it refers to the sharing of secret quantum information, i.e.
the goal is for the authorized partners to share quantum information (instead of a list of classical random variables) known only to them (Cleve, Gottesman and Lo, 1999;
Cr´epeau, Gottesman and Smith, 2005). Other examples of cryptographic tasks are bit commitment or oblivious transfer; for
these tasks, contrary to the case of QKD and secret sharing, quantum physics cannot guarantee unconditional security
(Lo and Chau, 1997; Lo, 1997; Mayers, 1997) and therefore their
interest seems limited — though new paradigms like “boundedstorage models” may change this perception in the future
(Damgaard et al., 2005, 2007; Wehner, Schaffner and Terhal,
2008).3
can perform coherent manipulations on many quantum
systems (Shor, 1994, 1997). Factorizing large numbers is
an example of a mathematical task considered classically
hard to solve and for this reason related to a class of
cryptographic schemes which are currently widely used.
Though quantum computers are not realized yet, the
mere fact that they could be built brought into awareness
that the security of some cryptographic schemes may be
threatened2.
This review focuses therefore on the cryptographic task
of key distribution, and in particular on its realization using quantum physics. Note that a secret key serves many
useful purposes in cryptography other than message encryption: it can be used, for example, to authenticate
messages, that is, to prove that a message has been indeed sent by the claimed sender.
B. Basics of Quantum Key Distribution (QKD)
In this paragraph, we introduce the basic elements
of quantum key distribution (QKD), for the sake of
those readers who would not be familiar with the field.
Alternative presentations of this material are available in many sources, ranging from books with rather
general scope (Ekert et al., 2001; Le Bellac, 2006; Lo,
1998; Scarani, 2006) to other review articles specific
to the topic (Duˇsek, L¨utkenhaus and Hendrych, 2006;
Gisin, Ribordy, Tittel and Zbinden, 2002; Lo and Zhao,
2008).
1. Generic setting
Y U r
C
FIG. 1 (Color online) The setting of QKD: Alice and Bob
are connected by a quantum channel, on which Eve can tap
without any restriction other than the laws of physics; and by
an authenticated classical channel, which Eve can only listen
to.
The generic settings of QKD are schematically represented in Fig. 1. The two authorized partners, those that
want to establish a secret key at a distance, are traditionally called Alice and Bob. They need to be connected by
two channels: a quantum channel, allowing them to share
quantum signals; and a classical channel, on which they
can send classical messages forth and back.
2 This issue will be discussed in more detail in Sec. VIII.B.
The classical channel needs to be authenticated: this
means that Alice and Bob identify themselves; a third
person can listen to the conversation but cannot participate in it. The quantum channel, however, is open to any
possible manipulation from a third person. Specifically,
the task of Alice and Bob is to guarantee security against
an adversarial eavesdropper, usually called Eve3, tapping
on the quantum channel and listening to the exchanges
on the classical channel.
By “security” we mean that“a non-secret key is never
used”: either the authorized partners can indeed create
a secret key (a common list of secret bits known only to
themselves), or they abort the protocol4. Therefore, after
the transmission of a sequence of symbols, Alice and Bob
must estimate how much information about their lists of
bits has leaked out to Eve. Such an estimate is obviously impossible in classical communication: if someone
is tapping on a telephone line, or when Eve listens to the
exchanges on the classical channel for that matters, the
communication goes on unmodified. This is where quantum physics comes into the game: in a quantum channel,
leakage of information is quantitatively related to a degradation of the communication. The next paragraph delves
a bit deeper into the physical reasons for this statement.
2. The origin of security
The origin of security of QKD can be traced back to
some fundamental principles of quantum physics. One
can argue for instance that any action, by which Eve extracts some information out of quantum states, is a generalized form of measurement; and a well-known tenet of
quantum physics says that measurement in general modifies the state of the measured system. Alternatively, one
may think that Eve’s goal is to have a perfect copy of
the state that Alice sends to Bob; this is however forbidden by the no-cloning theorem (Wootters and Zurek,
1982), which states that one cannot duplicate an unknown quantum state while keeping the original intact.
Both these arguments appear already in the seminal paper (Bennett and Brassard, 1984); they lead to the same
formalization. A third physical argument can be invoked,
which is usually considered rather as a fact than as a
principle, but a very deep one: quantum correlations ob-
3 The name, obtained from assonance with the English term
“eavesdropping”, is remarkably suited for someone whose task
is to mess things up!
4 No physical principle can prevent an adversary to cut the channels, thus blocking all transfer of information between Alice and
Bob. Stepping back then, one can imagine the following eavesdropping strategy (suggested to one of us by A. Beveratos): Eve
systematically cuts all QKD channels, until Alice and Bob, who
after all want to communicate, opt for less secure methods —
and then Eve gets the information. There is obviously a point
of humor in this idea but, given that Eve has no hope if QKD is
used correctly, this strategy may be the most effective indeed.4
tained by separated measurements on members of entangled pairs violate Bell’s inequalities and cannot therefore
have been created by pre-established agreement. In other
words, the outcomes of the measurements did not exist
before the measurements; but then, in particular, Eve
could not know them (Ekert, 1991). This argument supposes that QKD is implemented with entangled states.
The fact that security can be based on general principles of physics suggests the possibility of unconditional
security, i.e. the possibility of guaranteeing security without imposing any restriction on the power of the eavesdropper (more on this notion in Sec. II.C.1). Indeed, at
the moment of writing, unconditional security has been
proved for several QKD protocols.
3. The choice of light
In general, quantum information processing can be
implemented with any system, and one indeed finds
proposal to implement quantum computing with ions,
atoms, light, spins... Abstractly, this is the case also
for QKD: one could imagine to perform a QKD experiment with electrons, ions, molecules; however, light is
the only practical choice. Indeed, the task of key distribution makes sense only if Alice and Bob are separated
by a macroscopic distance: if they are in the same room,
they have much easier ways of generating a common secret key.
Now, as well known, light does not interact easily with
matter; therefore quantum states of light can be transmitted to distant locations basically without decoherence,
in the sense that little perturbations are expected in the
definition of the optical mode. The problem with light
is scattering, i.e. losses: quite often, the photons just
don’t arrive. The way losses affect QKD varies with
the protocol and the implementation; we shall deal with
these issues in detail later, but it’s useful to give here a
rapid overview. First and quite obviously, losses impose
bounds on the secret key rate (that cannot scale with the
distance better than the transmittivity of the line) and
on the achievable distance (when losses are so large that
the signal is lost in spurious events, the “dark counts”).
Second: losses may leak information to the eavesdropper,
according to the nature of the quantum signal: for coherent pulses it is certainly the case, for single photons it is
not, the case for entangled beams is more subtle. A third
basic difference is determined by the detection scheme.
Indeed, implementations that use photon counters rely
on post-selection: if a photon does not arrive, the detector does not click and the event is simply discarded5.
5 Note that this is possible because the task is to distribute a
random key. In the days of booming of quantum information, some authors considered the possibility of sending directly the message on the quantum channel (Beige et al., 2002;
Bostr¨om and Felbinger, 2002). This task has been called “QuanOn the contrary, implementations that use homodyne detection always give a signal, therefore losses translate as
additional noise.
In summary, QKD is always implemented with light
and there is no reason to believe that things will change
in the future. As a consequence, the quantum channel is
any medium that propagates light with reasonable losses:
typically, either an optical fiber, or just free space provided Alice and Bob have a line of sight.
4. The BB84 protocol
All the points and concepts introduced above will be
dealt in more depth and detail in the main sections of this
review. Let us first practice the generic ideas on a very
concrete example: the first QKD protocol, published by
Bennett and Brassard in 1984 and called therefore BB84
(Bennett and Brassard, 1984).
Suppose Alice holds a source of single photons. The
spectral properties of the photons are sharply defined,
so the only degree of freedom left is polarization. Alice
and Bob align their polarizers and agree to use either the
Horizontal/Vertical (+) basis, or the complementary basis of linear polarizations i.e. +45/-45 (×). Specifically,
the coding of bits is
|Hi codes for 0+
|V i codes for 1+
| + 45i codes for 0×
| − 45i codes for 1×
. (1)
We see that both bit values 0 and 1 are coded in two
possible ways, more precisely in non-orthogonal states,
because
| ± 45i = √12|Hi ± |V i . (2)
Given this coding, the BB84 protocol goes as follows:
1. Alice prepares a photon in one of the four states
above and sends it to Bob on the quantum channel.
Bob measures it in either the + or the × basis. This
step is repeated N times. Both Alice and Bob have
now a list of N pairs (bit,basis).
2. Alice and Bob communicate over the classical channel and compare the “basis” value of each item and
discard those instances in which they have used different bases. This step is called sifting. At its end,
tum Secure Direct Communication” and has generated some interest. However, it was soon recognized (even by some of the
original authors) that the idea suffers of two major defaults with
respect to standard QKD: (i) It is obviously not robust against
losses: you cannot afford losing a significant amount of the message. (ii) It allows no analog of privacy amplification: if an
eavesdropper obtains information, it is information on the message itself and cannot of course be erased.5
Alice and Bob have a list of approximately N/2
bits, with the promise that for each of them Alice’s
coding matched Bob’s measurement. This list is
called raw key.
3. Alice and Bob now reveal a random sample of the
bits of their raw keys and estimate the error rate
in the quantum channel, thus in turn Eve’s information. In the absence of errors, the raw key is
identical for Alice and Bob and Eve has no information: in this case, the raw key is already the
secret key. If there are errors however, Alice and
Bob have to correct them and to erase the information that Eve could have obtained6. Both tasks
can be performed by communication on the classical channel, so this part of the protocol is called
classical post-processing. At the end of this processing, Alice and Bob share either a truly secret
key or nothing at all (if Eve’s information was too
large).
5. An example of eavesdropping
A particularly simple eavesdropping strategy is the one
called intercept-resend. To obtain information, Eve does
the same as Bob: she intercepts the photon coming from
Alice and measures it either in the + or in the × basis.
But Bob is waiting for some signal to arrive. Let’s then
suppose that Eve resends the same photon to Bob (Eve
is limited only by the laws of physics, therefore in particular she can perform a quantum non-demolition measurement). If Eve has measured in the basis of Alice’s
preparation, the photon is intact: on such instances, Eve
has got full information on Alice’s bit without introducing any errors. However, when Eve has chosen the wrong
basis, her result is uncorrelated with Alice’s bit; moreover, she has modified the state so that, even if Bob uses
the same basis as Alice, half of the times he will get the
wrong result.
In average over long keys then, this particular attack
gives Eve full information on half of the bits of the raw
key (IE = 0.5) at the price of introducing an error rate
Q = 0.25. Can a secure key be extracted under such
conditions? One has to know how to quantify the length
of the final key that can be extracted. For this particular case, under some assumptions on the classical postprocessing it holds (Csisz´ar and K¨orner, 1978)
r = max{I(A : B) − IE, 0} . (3)
where I(A : B) = H(A) + H(B) − H(AB) is the mutual
information between Alice’s and Bob’s raw keys (H is
6 Historical note: the procedure that erases the information of
the eavesdropper was not discussed in (Bennett and Brassard,
1984) and appears for the first time a few years later
(Bennett, Brassard and Robert, 1988).
Shannon entropy). Assuming that both bit values are
equally probable, i.e. H(A) = H(B) = 1, one has I(A :
B) = 1 − h(Q) where h is binary entropy. Having these
elements, one can plug in the values obtained for the
intercept-resend attack and find that I(A : B) < IE:
Eve has more information on Alice’s string than Bob,
therefore no secret key can be extracted7.
Another simple exercise consists in supposing that Eve
perform the intercept-resend attack only on a fraction
p of the photons sent by Alice, and leaves the others
untouched. Then obviously Q = p/4 and IE = p/2 = 2Q;
this leads to conclude that, if Q > ∼ 17%, a secure key
cannot be extracted from the BB84 protocol — at least,
if the classical post-processing is done according to the
assumptions of (Csisz´ar and K¨orner, 1978).
6. Beyond the example: the field of QKD
The basic example that we have just presented calls
for a number of important questions:
• The adversary is clearly not restricted to perform
the intercept-resend attack. What is the maximal
amount of information Eve can possibly obtain, if
she is allowed to do anything that is compatible
with the laws of physics? This is the question about
the possibility of proving unconditional security.
• The BB84 protocol is just a particular protocol.
What about other forms of coding and/or of processing the data?
• The protocol supposed that the quantum signal is a
qubit — explicitly, a bimodal single photon, i.e. an
elementary excitation of the light field in only two
modes (polarization in the explicit example). How
close can an implementation come to this? And after all, should any implementation of QKD actually
aim at coming close to this?
• In a real device, information may leak out in channels that are neglected in a theoretical description.
What are the potential threats in an implementation?
The whole field of QKD has developed along the answer
to these and similar questions.
7 This conclusion is valid for all protocols: no secret
key can be extracted if the observed statistics are compatible with Eve performing the intercept-resend attack
(Curty, Lewenstein and L¨utkenhaus, 2004). The reason is that
this attack “breaks” the quantum channel into two pieces, in
which case the correlations between Alice and Bob can always
be obtained with classical signals; and no secrecy can be distributed with classical communication.6
C. Scope of this review
1. Focus
The label “quantum cryptography” applies nowadays
to a very wide range of interests, going from abstract
mathematical considerations to strictly technological issues.
This review focuses somewhere in the middle of this
range, in the realm where theoretical and experimental
physics meet, that we call practical QKD. There, theorists cannot pursue pure formal elegance and are compelled to complicate their models in order to take real
effects into account; and experimentalists must have a
serious grasp on theoretical issues in order to choose the
right formulas and make the correct claims about the security of their devices. Specifically, we want to address
the following two concerns:
1. On the one hand, the theoretical tools have reached
a rather satisfactory level of development; but from
outside the restricted group of experts, it has become almost impossible to follow this development,
due also to the fact that quite a few strong security claims made in the past had to be revisited
in the light of better understanding. As theorists
involved in the development of security proofs, we
want to provide an updated review of the status of
such proofs.
2. On the other hand, several competing experimental
platforms exist nowadays. It is desirable to have a
synthetic view of those, highlighting the interest
and possible shortcomings of each choice. Also, we
want to raise the awareness of the complexity of
any comparison: “physical” figures of merit like the
secret key rate or the maximal achievable distance
are in competition with “practical” figures of merit
like stability and cost.
Along the review, we shall make reference also to some
strictly mathematical or strictly technological progresses,
but without any claim of exhaustiveness.
2. Outline
The review is structured as follows. Section II introduces all the basic elements of practical QKD. Section III is devoted to the rate at which a secret key is
produced: this is the fundamental parameter of QKD,
and depends both on the speed and efficiency of the devices, and on the intrinsic security of the protocol against
eavesdropping. The next three sections provide a detailed analysis, with a consistent set of explicit formulas, for the three main families of protocols: those based
on discrete-variable coding (Section IV), those based on
continuous-variable coding (Section V) and the more recent distributed-phase-reference coding (Section VI). In
Section VII, we put everything together and sketch some
directions for comparison of different experimental platforms. Finally, in Section VIII, we discuss future perspectives for QKD, both as a field in itself and in the
broader context of key distribution.
II. THE ELEMENTS OF PRACTICAL QKD
A. Milestones
1. Foundations: 1984-1995
QKD unfolded with the presentation of the first complete protocol (Bennett and Brassard, 1984), which was
based on earlier ideas by Wiesner (Wiesner, 1983). In
the BB84 protocol, bits are coded in two complementary
bases of a two level system (qubit); this qubit is sent by
Alice to Bob, who measures it. The no-cloning theorem
is explicitly mentioned as the reason for security. This
work was published in conference proceedings and was
largely unknown to the community of physicists. It was
not until 1991, when Artur Ekert, independently from
the earlier developments, published a paper on quantum
key distributions, that the field gained a rapid popularity (Ekert, 1991). Ekert’s argument for security had a
different flavor: an eavesdropper introduces “elements of
reality” into the correlations shared by Alice and Bob;
so, if they observe correlations that violate a Bell inequality, the communication cannot have been completely broken by Eve. Shortly later, Bennett, Brassard and Mermin argued8 that entanglement-based protocols, such as
E91, are equivalent to prepare&measure protocols, such
as the BB84 protocol (Bennett, Brassard and Mermin,
1992). The same year 1992 witnessed two additional
milestones: the invention of the B92 protocol (Bennett,
1992) and the very first in-principle experimental demonstration (Bennett et al., 1992). One can reasonably conclude the foundational period of QKD with the definition of privacy amplification, the classical post-processing
needed to erase Eve’s information from the raw key
(Bennett et al., 1995).
2. The theory-experiment gap opens: 1993-2000
After these foundational works, the interest and feasibility of QKD became apparent to
many. Improved experimental demonstrations
took place, first in the lab with a growing distance of optical fiber next to the optical table
8 The argument is correct under some assumptions; only around
the year 2006 it was fully realized that Ekert’s view is qualitatively different and allows to reduce the set of assumptions about
Alice’s and Bob’s devices; see VIII.A.3. This is also why the Ekert protocol was not implemented as such in an experiment until
very recently (Ling et al., 2008).7
(Br´eguet, Muller and Gisin, 1994; Franson and Ilves,
1994; Townsend, Rarity and Tapster, 1993), then in
installed optical fibers (Muller, Zbinden and Gisin,
1995), thereby demonstrating that QKD can be made
sufficiently robust for a real-world implementation. In
this development, an obvious milestone is the invention
of the so-called Plug&Play setups by the Geneva group
(Muller et al., 1997; Ribordy et al., 1998). By the year
2000, QKD over large distances was demonstrated
also with entangled photons (Jennewein et al., 2000;
Naik et al., 2000; Tittel et al., 2000).
Theorists became very active too. New protocols were
proposed. For instance, the elegant six-state protocol,
first mentioned back in 1984 as a possible extension of
BB84 (Bennett et al., 1984), was rediscovered and studied in greater detail (Bechmann-Pasquinucci and Gisin,
1999; Bruß, 1998). But by far a more complex task was
at stake: the derivation of rigorous security proofs that
would replace the intuitive arguments and the first, obviously sub-optimal estimates. The first such proof has
been given by Mayers, who included even advanced features such as the analysis of finite key effects (Mayers,
1996, 2001). However, this proof is not very intuitive, and
other proofs emerged, starting with the basic principle
of entanglement distillation ideas (Deutsch et al., 1996)
which were put into a rigorous framework by Lo and
Chau (Lo and Chau, 1999). These entanglement based
proofs would require the ability to perform quantum logic
operations on signals. At present, we do not have the experimental capability to do so. Therefore the result by
Shor and Preskill (Shor and Preskill, 2000) provided a
step forward, as it combined the property of Mayers result of using only classical error correction and privacy
amplification with a very intuitive way of proving the security of the BB84 protocol. That result uses the ideas
of quantum error correction methods, and reduces the
corresponding quantum protocol to an actual classicallyassisted prepare-and-measure protocol.
As of the year 2000 therefore, both experimental and
theoretical QKD had made very significant advances.
However, almost inevitably, a gap had opened between
the two: security proofs had been derived only for very
idealized schemes; setups had been made practical without paying attention to all the security issues.
3. Closing the gap: 2000 to present
The awareness of the gap was triggered by the
discovery of photon-number-splitting (PNS) attacks (Brassard et al., 2000), which had actually
been anticipated years before (Bennett, 1992;
Duˇsek, Haderka and Hendrych, 1999; Huttner et al.,
1995) but had passed rather unnoticed. The focus is on
the source: the theoretical protocols supposed singlephoton sources, but experiments were rather using attenuated laser pulses, with average photon numbers below
one. In these pulses, photons are distributed according to
the Poissonian statistics: in particular, there are sometimes two or more photons, and this opens an important
loophole. Security proofs could be adapted to deal
with the case (Gottesman, Lo, L¨utkenhaus and Preskill,
2004; Inamori, L¨utkenhaus and Mayers, 2001-2007;
L¨utkenhaus, 2000): the extractable secret key rate was
found to scale much worse with the distance than for
single-photon sources (t2 compared to t, where t is the
transmittivity of the quantum channel).
It took a few years to realize that methods can
be devised to reduce the power of PNS attacks while
keeping the very convenient laser sources. One improvement can be made by a mere change of software
by modifying the announcements of the BB84 protocol (Scarani, Ac´ın, Ribordy and Gisin, 2004): in this
SARG04 protocol, the key rate scales as t3/2 (Koashi,
2005; Kraus, Gisin and Renner, 2005). Another significant improvement can be made by an easy change of
hardware: by varying the quantum state along the protocol (decoy states), one can perform a more complete
test of the quantum channel (Hwang, 2003). When the
decoy state idea is applied to laser sources, the key rate
scales as t (Lo, Ma and Chen, 2005; Wang, 2005).
Parallel to this development, the field of practical
QKD9 has grown in breadth and maturity. New families of protocols have been proposed, notably continuousvariable protocols (Cerf, L´evy and Van Assche, 2001;
Gottesman and Preskill, 2001; Grosshans and Grangier,
2002a; Hillery, 2000; Ralph, 1999; Silberhorn et al., 2002)
and the more recent distributed-phase-reference protocols
(Inoue, Waks and Yamamoto, 2002; Stucki et al., 2005).
Critical thinking on existing setups has lead to the awareness that the security against Eve tapping on the quantum channel is not all: one should also protect the devices against more commonplace hacking attacks and verify that information does not leak out in side-channels
(Makarov and Hjelme, 2005). Since a short time, QKD
has also reached the commercial market: at least three
companies10 are offering working QKD devices. New
questions can now be addressed: in which applications
QKD can help (All´eaume et al., 2007), how to implement
a network of QKD systems11, how to certify QKD devices for commercial markets (including the verification
that these devices indeed fulfill the specifications of the
corresponding security proofs) etc.
9 The whole field of QKD witnessed many other remarkable developments, especially in theoretical studies, which are not included
in this paragraph but are mentioned in due place in the paper.
10 idQuantique, Geneva (Switzerland), www.idquantique.com;
MagiQ Technologies, Inc., New York., www.magiqtech.com; and
Smartquantum, Lannion (France), www.smartquantum.com.
11 This is the aim of the European Network SECOQC,
www.secoqc.net.8
B. Generic QKD Protocol
1. Classical and quantum channels
As introduced in Sec. I.B, Alice and Bob need to be
connected by two channels. On the quantum channel,
Alice can send quantum signals to Bob. Eve can interact
with these signal, but if she does, the signals are changed
because of the laws of quantum physics – the essence of
QKD lies precisely here.
On the classical channel, Alice and Bob can send classical messages forth and back. Eve can listen without
penalty to all communication that takes place on this
channel. However, in contrast to the quantum channel, the classical channel is required to be authenticated,
so that Eve cannot change the messages that are being
sent on this channel. Failure to authenticate the classical
channel can lead to the situation where Eve impersonates
one of the parties to the other, thus entirely compromising the security. Unconditionally secure authentication12
of the classical channel requires Alice and Bob to preshare an initial secret key or at least partially secret but
identical random strings (Renner and Wolf, 2003). QKD
therefore does not create a secret key out of nothing:
rather, it will expand a short secret key into a long one,
so strictly speaking it is a way of key-growing. This remark calls for two comments. First, key growing cannot
be achieved by use of classical means alone, whence QKD
offers a real advantage. Second, it is important to show
that the secret key emerging from QKD is composable,
that is, it can be used like a perfect random secret key in
any task (more in Sec. II.C.2), because one has to use a
part of it as authentication key for the next round.
2. Quantum information processing
The first step of a QKD protocol is the exchange and
measurement of signals on the quantum channel. Alice’s role is encoding: the protocol must specify which
quantum state |Ψ(Sn)i codes for the sequence of n symbols Sn = {s1, ..., sn}. In most protocols, but not
in all, the state |Ψ(Sn)i has the tensor product form
|ψ(s1)i ⊗ ... ⊗ |ψ(sn)i. In all cases, it is crucial that the
protocol uses a set of non-orthogonal states13, otherwise
12 Authentication schemes that do not rely on pre-shared secrecy
exist, but are not unconditionally secure. Since we aim at unconditional security for QKD, the same level of security must
in principle be guaranteed in all the auxiliary protocols. However, breaking the authentication code after one round of QKD
does not threaten security of the key that has been produced;
one may therefore consider authentication schemes that guarantee security only for a limited time, e.g.based on complexity
assumptions.
13 There is only one exception (Goldenberg and Vaidman, 1995)
when Alice uses just two orthogonal states. Alice prepares a
qubit in one of the two orthogonal superposition of two spatially
Eve could decode the sequence without introducing errors
by measuring in the appropriate basis (in other words, a
set of orthogonal states can be perfectly cloned). Bob’s
role is twofold: his measurements allow of course to decode the signal, but also to estimate the loss of quantum
coherence and therefore Eve’s information. For this to be
possible, non-compatible measurements must be used.
We have described the quantum coding of QKD protocols with the language of Prepare-and-Measure (P&M)
schemes: Alice chooses actively the sequence Sn she
wants to send, prepares the state |Ψ(Sn)i and sends it to
Bob, who performs some measurement. Any such scheme
can be immediately translated into an entanglementbased (EB) scheme: Alice prepares the entangled state
|ΦniAB = √1dn X
Sn
|SniA ⊗ |Ψ(Sn)iB (4)
where dn is the number of possible Sn sequences and the
|SniA form an orthogonal basis. By measuring in this
basis, Alice learns one Sn and prepares the corresponding |Ψ(Sn)i on the sub-system that is sent to Bob: from
Bob’s point of view, nothing changes. This formal translation obviously does not mean that both realizations are
equally practical or even feasible with present-day technology. However, it implies that the security proof for the
EB protocol translates immediately to the corresponding
P&M protocol and viceversa.
A frequently quoted statement concerning the role of
entanglement in QKD says that “entanglement is a necessary condition to extract a secret key” (Ac´ın and Gisin,
2005; Curty, Lewenstein and L¨utkenhaus, 2004). Two
important comments have to be made to understand it
correctly. First of all, this is not a statement about implementations, but about the quantum channel: it says that
no key can be extracted from an entanglement-breaking
channel14. In particular, the statement does not say that
entanglement-based implementations are the only secure
ones.
Second: as formulated above, the statement has been
derived under the assumption that Eve holds a purification of ρAB, where A and B are the degrees of freedom
that Alice and Bob are going to measure. One may ask
a more general question, namely, how to characterize all
the private states, i.e. the states out of which secrecy can
be extracted (Horodecki et al., 2005, 2008a,b). It was realized that, in the most general situation, Alice and Bob
separated states, then – at a random time instant – she sends one
component of this superposition to Bob. Only later she sends the
second component. Precise time synchronization between Alice
and Bob is crucial. See also Peres’ criticism (Peres, 1996), the
authors’ reply (Goldenberg and Vaidman, 1996) and a related
discussion (Koashi and Imoto, 1997). Unconditional security has
not been proved for this protocol.
14 As the name indicates, a channel ρ → ρ′ = C(ρ) is called
entanglement-breaking if (11⊗C)|ΨiAB is separable for any input
|ΨiAB. A typical example of such a channel is the one obtained
by performing a measurement on half of the entangled pair.9
may control some additional degrees of freedom A′ and
B′; thus, Eve is not given a purification of ρAB, but of
ρAA′BB′. In such situation, it turns out that ρAB can
even be separable; as for ρAA′BB′, it must be entangled,
but may even be bound entangled. The reason is quite
clear: A′ and B′ shield the meaningful degrees of freedom from Eve’s knowledge. We do not consider this most
general approach in what follows15, because at the moment of writing no practical QKD scheme with shielding
systems has been proposed.
3. Classical information processing
Once a large number N of signals have been exchanged
and measured on the quantum channel, Alice and Bob
start processing their data by exchanging communication on the classical channel. In all protocols, Alice and
Bob estimate the statistics of their data; in particular,
they can extract the meaningful parameters of the quantum channel: error rate in decoding, loss of quantum coherence, transmission rate, detection rates... This step,
called parameter estimation, may be preceded in some
protocols by a sifting phase, in which Alice and Bob
agree to discard some symbols (typically, because Bob
learns that he has not applied the suitable decoding on
those items). After parameter estimation and possibly
sifting, both Alice and Bob hold a list of n ≤ N symbols, called raw keys. These raw keys are only partially
correlated and only partially secret. Using some classical information post-processing (see III.B.1), they can be
transformed into a fully secure key K of length ℓ ≤ n.
The length ℓ of the final secret key depends of course on
Eve’s information on the raw keys.
4. Secret fraction and secret key rate
In the asymptotic case N → ∞ of infinitely long keys,
the meaningful quantity is the secret fraction16
r = lim
N→∞
ℓ/n . (5)
The secret fraction is clearly the heart of QKD: this is
the quantity for which the security proofs (II.C.3) must
provide an explicit expression. However, a more prosaic parameter must also be taken into account as well
in practical QKD: namely, the raw-key rate R, i.e. the
length of the raw key that can be produced per unit time.
This rate depends partly on the protocol: for instance, it
contains the sifting factor, i.e. the fraction of exchanged
15 In (Smith, Renes and Smolin, 2008), the formalism of private
states is used to study pre-processing, see III.B.1.
16 Often, especially in theoretical studies, this quantity is called
“secret key rate”. In this paper, we reserve this term to (6),
which is more meaningful for practical QKD.
symbols that is discarded in a possible sifting phase. But,
surely enough, its largest dependence is on the details of
the setup: repetition rate of the source, losses in the
channel, efficiency and dead time of the detectors, possible duty cycle, etc. In conclusion, in order to assess the
performances of practical QKD systems, it is natural to
define the secret key rate as the product
K = R r . (6)
The whole Section III will be devoted to a detailed discussion of this quantity.
As mentioned, these definitions hold in the asymptotic
regime of infinitely long keys. When finite-key corrections
are taken into account, a reduction of the secret fraction
is expected, mainly for two reasons. On the one hand,
parameter estimation is made on a finite number of samples, and consequently one has to consider the worst possible values compatible with statistical fluctuations. On
the other hand, the yield of the classical post-processing
contains terms that vanish only in the asymptotic limit;
intuitively, these correction take care of the fact that security is never absolute: the probability that Eve knows a
n-bit key is at least 2−n, which is strictly positive. In this
review, we restrict our attention to the asymptotic case,
not because finite-key corrections are negligible — quite
the opposite seems to be true17 — but because their estimate is still the object of on-going research (see VIII.A.1
for the state-of-the-art).
C. Notions of Security
1. Unconditional security, and its conditions
The appeal of QKD comes mainly from the fact that,
in principle, it can achieve unconditional security. This
technical term means that security can be proved without imposing any restriction on the computational resources or the manipulation techniques that are available
to the eavesdropper acting on the signal. The possibility of achieving unconditional security in QKD is deeply
rooted in quantum physics. To learn something about
the key, Eve must interact with the quantum system;
now, if the coding uses randomly chosen non-orthogonal
states, Eve’s intervention necessarily modifies the state
on average, and this modification can be observed by the
parties. As we discussed in Sec. I.B, there are many
equivalent formulations of this basic principle. However
formulated, it must be stressed that this criterion can
be made quantitative: the observed perturbations in the
quantum channel allow computing a bound on the information that Eve might have obtained.
17 For instance, in the only experiment analyzed with finite-key
formalism to date (Hasegawa et al., 2007), the authors extracted
r ≈ 2%, whereas, for the observed error rate, the asymptotic
bound would have yielded r > ∼ 40%!10
Like many other technical terms, the wording “unconditional security” has to be used in its precise meaning
given above, and not as a synonym of “absolute security” — something that does not exist. As a matter of
fact, unconditional security of QKD holds under some
conditions. First of all, there are some compulsory requirements:
1. Eve cannot intrude Alice’s and Bob’s devices to
access either the emerging key or their choices of
settings (we shall see in Sec. III.B.4 how complex
it is to check this point thoroughly).
2. Alice and Bob must trust the random number generators that select the state to be sent or the measurement to be performed.
3. The classical channel is authenticated with
unconditionally secure protocols, which exist (Carter and Wegman, 1979; Stinson, 1995;
Wegman and Carter, 1981).
4. Eve is limited by the laws of physics. This requirement can be sharpened: in particular, one can ask
whether security can be based on a restricted set
of laws18. In this review, as in the whole field of
practical QKD, we assume that Eve has to obey
the whole of quantum physics.
We shall take these requirements, the failure of which
would obviously compromise any security, as granted.
Even so, many other issues have to be settled, before
unconditional security is claimed for a given protocol:
for instance, the theoretical description of the quantum
states must match the signals that are really exchanged;
the implementations must be proved free of unwanted information leakage through side-channels or back-doors,
against which no theoretical protection can be invoked.
2. Definition of security
The security of a key K can be parametrized by its
deviation ε from a perfect key, which is defined as a list
18 As we have seen (I.B.2), intuition suggests that the security of
QKD can be traced back to a few specific principles or laws
like “no-cloning” or “non-locality without signaling”. One may
ask whether this intuition may be made fully rigorous. Concretely, since any theory that does not allow signaling and is
non-local exhibits a no-cloning theorem (Barnum et al., 2006;
Masanes, Ac´ın and Gisin, 2006), and since non-locality itself
can be checked, one may hope to derive security only from
the physical law of no-signaling. In this framework, as of today, unconditional security has been proved only in the case
of strictly error-free channels and for a key of vanishing length
(Barrett, Hardy and Kent, 2005). Only limited security has been
proved in more realistic cases (Ac´ın, Gisin and Masanes, 2006;
Scarani et al., 2006). Recently, Masanes showed that unconditional composable security can be proved if no-signaling is assumed not only between Alice and Bob, but also among the
systems that are measured by each partner (Masanes, 2009).
of perfectly correlated symbols shared between Alice and
Bob, on which Eve has no information (in particular, all
the possible lists must be equally probable a priori). A
definition of security is a choice of the quantity that is required to be bounded by ε; a key that deviates by ε from
a perfect key is called ε-secure. The main property that a
definition of security must fulfill is composability, meaning that the security of the key is guaranteed whatever
its application may be — more precisely: if an ε-secure
key is used in an ε′-secure task19, composability ensures
that the whole procedure is at least (ε + ε′)-secure.
A composable definition of security is the one based on
the trace-norm (Ben-Or et al., 2005; Renner and K¨onig,
2005): 12kρKE − τK ⊗ ρEk1 ≤ ε, where ρKE is the actual
state containing some correlations between the final key
and Eve, τK is the completely mixed state on the set K
of possible final keys and ρE is any state of Eve. In this
definition, the parameter ε has a clear interpretation as
the maximum failure probability of the process of key extraction. As the dates of the references show, the issue of
composability was raised rather late in the development
of QKD. Most, if not all, of the early security studies
had adopted a definition of security that is not composable, but the asymptotic bounds that were derived can
be “redeemed” using a composable definition20.
3. Security proofs
Once the security criterion is defined, one can derive a
full security proof, leading to an explicit (and hopefully
computable) expression for the length of the extractable
19 For instance, the One-Time Pad is a 0-secure task; while any
implementation of channel authentication, for which a part of
the key is used (II.B.1), must allow for a non-zero ε′.
20 The early proofs defined security by analogy with the classical definition: Eve, who holds a quantum state ρE, performs
the measurement M which maximizes her mutual information
with the key K. This defines the so-called accessible information Iacc(K : ρE) = maxE=M(ρE) I(K : E), and the security
criterion reads Iacc(K : ρE) ≤ ε. As for the history of claims,
it is quite intricate. Accessible information was first claimed to
provide composable security (Ben-Or et al., 2005). The proof is
correct, but composability follows from the use of two-universal
hashing in the privacy amplification step (see III.B.1), rather
than from the properties of accessible information itself. Indeed,
shortly later, an explicit counterexample showed that accessible information is in general not composable for any reasonable
choice of the security parameter ε (K¨onig et al., 2007). The reason why accessible information is not composable can be explained qualitatively: this criterion supposes that Eve performs
a measurement to guess the key at the end of the key exchange.
But Eve may prefer not to measure her systems until the key
is actually used in a further protocol: for instance, if a plaintext attack can reveal some information, Eve has certainly better adapt her measurement to this additional knowledge. The
counterexample also implies that the classical results on privacy
amplification by two-universal hashing (Bennett et al., 1995) do
not apply and have to be replaced by a quantum version of the
statement (Renner and K¨onig, 2005).11
secret key rate. Several techniques have been used:
• The very first proofs by Mayers were somehow
based on the uncertainty principle (Mayers, 1996,
2001). This approach has been revived recently by
Koashi (Koashi, 2006, 2007).
• Most of the subsequent security proofs have
been based on the correspondence between
entanglement distillation and classical postprocessing, generalizing the techniques of
Shor and Preskill (Shor and Preskill, 2000).
For instance, the most developed security
proofs for imperfect devices follow this pattern (Gottesman, Lo, L¨utkenhaus and Preskill,
2004).
• The most recent techniques use rather
information-theoretical notions (Ben-Or, 2002;
Kraus, Gisin and Renner, 2005; Renner, 2005;
Renner, Gisin and Kraus, 2005).
A detailed description on how a security proof is built
goes beyond the scope of this review. The core lies in
how to relate the security requirement 1 2kρKE − τK ⊗
ρEk1 ≤ ε to a statement about the length ℓ of the secret
key that can be extracted. This step is achieved using
inequalities that can be seen as a generalization of the
Chernoff bound. In other words, one must use or prove
an inequality of the form
Prob[kρKE − τK ⊗ ρEk1 > 2ε] < ∼ eℓ−F(ρKE,ε) (7)
where we omitted constant factors. From such an inequality, one immediately reads that the security requirement will fail with exponentially small probability provided ℓ <
∼ F(ρKE, ε). Explicit security bounds will be
provided below (Sec. III.B) for the asymptotic limit of
infinitely long keys — note that in this limit one can take
ε → 0, whence no explicit dependence on ε is manifest in
those expressions.
D. Explicit Protocols
1. Three families
The number of explicit QKD protocols is virtually infinite: after all, Bennett has proved that security can be
obtained when coding a bit in just two non-orthogonal
quantum states (Bennett, 1992). But as a matter of
fact, this possible variety has crystallized into three main
families: discrete-variable coding (II.D.2), continuousvariable coding (II.D.3), and more recently distributedphase-reference coding (II.D.4). The crucial difference
is the detection scheme: discrete-variable coding and
distributed-phase-reference coding use photon counting
and post-select the events in which a detection has effectively taken place, while continuous-variable coding
is defined by the use of homodyne detection (detection
techniques are reviewed in Sec. II.G).
Discrete-variable coding is the original one. Its main
advantage is that protocols can be designed in such a way
that, in the absence of errors, Alice and Bob would share
immediately a perfect secret key. They are still the most
implemented QKD protocols. Any discrete quantum degree of freedom can be chosen in principle, but the most
frequent ones are polarization for free-space implementations and phase-coding in fiber-based implementations21.
The case for continuous-variable coding stems from the
observation that photon counters normally feature low
quantum efficiencies, high dark count rates, and rather
long dead times; while these inconveniences can be overcome by using homodyne detection. The price to pay is
that the protocol provides Alice and Bob with correlated
but rather noisy realization of a continuous random variable, because losses translate into noise (see I.B.3): as a
consequence, a significant amount of error correction procedures must be used. In short, the issue is, whether it is
better to build up slowly a noiseless raw key, or rapidly a
noisy one. As for distributed-phase-reference coding, its
origin lies in the effort of some experimental groups toward a more and more practical implementation. From
the point of view of detection, these protocols produce
a discrete-valued result; but the nature of the quantum
signals is very different from the case of discrete-variable
coding, and this motivates a separate treatment.
Despite the differences originating from the use of a
different detection device, there is a strong conceptual
unity underlying discrete- and continuous-variable QKD.
To take just one example, in both cases the ability to
distribute a quantum key is closely related to the ability to distribute entanglement, regardless of the detection scheme used and even if no actual entanglement is
present. These similarities are not very surprising since
it has long been known that the quantum features of
light may be revealed either via photon counting (e.g.,
antibunching or anticorrelation experiments) or via homodyne detection (e.g., squeezing experiments). Being a
technique that exploits these quantum features of light,
QKD has thus no reason to be restricted to the photoncounting regime. Surprisingly, just like antibunching (or
a single-photon source) is not even needed in photoncounting based QKD, we shall see that squeezing is not
needed in homodyne-detection based QKD. The only
quantum feature that happens to be needed is the nonorthogonality of light states.
21 Other degrees of freedom have been explored, for instance coding in sidebands of phase-modulated light (M´erolla et al., 1999)
and time-coding (Boucher and Debuisschert, 2005). Energytime entanglement gives also rise to a peculiar form of coding
(Tittel et al., 2000).12
2. Discrete-variable Protocols
a. BB84-BBM. The best known discrete-variable protocol is of course BB84 (Bennett and Brassard, 1984), that
we introduced in Sec. I.B. The corresponding EB protocol is known as BBM (Bennett, Brassard and Mermin,
1992); the E91 protocol (Ekert, 1991) is equivalent to it
when implemented with qubits. Alice prepares a single
particle in one of the four states:
| + xi, | − xi , eigenstates of σx
| + yi, | − yi, eigenstates of σy (8)
where the σ’s are Pauli operators. The states with “+”
code for the bit value 0, the states with “−” for the bit
value 1. Bob measures either σx or σy. In the absence of
errors, measurement in the correct basis reveals the bitvalue encoded by Alice. The protocol includes a sifting
phase: Alice reveals the basis, X or Y , of each of her
signals; Bob accepts the values for which he has used the
same basis and discards the others22.
Unconditional security of BB84-BBM has
been proved with many different techniques
(Kraus, Gisin and Renner, 2005; Lo and Chau, 1999;
Mayers, 1996, 2001; Shor and Preskill, 2000). The same
coding can be implemented with other sources, leading
to a family of BB84-like protocols. We review them at
length in Sec. IV.B.
b. SARG04. The SARG04 protocol (Ac´ın, Gisin and Scarani, 2004;
Scarani, Ac´ın, Ribordy and Gisin, 2004) uses the
same four states (8) and the same measurements on
Bob’s side as BB84, but the bit is coded in the basis
rather than in the state (basis X codes for 0 and basis
Y codes for 1). Bob has to choose his bases with probability 1 2. The creation of the raw key is slightly more
complicated than in BB84. Suppose for definiteness
that Alice sends | + xi: in the absence of errors, if Bob
measures X he gets sb = +; if he measures Y , he may
get both sb = +/− with equal probability. In the sifting
phase, Bob reveals sb; Alice tells him to accept if she
had prepared a state with sa 6= sb, in which case Bob
accepts the bit corresponding to the basis he has not
used. The reason is clear in the example above: in the
22 In the original version of BB84, both bases are used with the
same probability, so that the sifting factor is psif t = 1 2 , i.e. only
half of the detected bits will be kept in the raw key. But the
protocol can be made asymmetric without changing the security
(Lo, Chau and Ardehali, 1998-2005): Alice and Bob can agree
on using one basis with probability 1 − ǫ where ǫ can be taken
as small as one wants, so as to have psif t ≈ 1 (recall that we
are considering only asymptotic bounds; in the finite key regime,
the optimal value of ǫ can be computed (Scarani and Renner,
2008)).
absence of errors, sb = − singles out the wrong basis 23.
SARG04 was invented for implementations with attenuated laser sources, because it is more robust than
BB84 against the PNS attacks. Unconditional security
has been proved, we shall review the main results in Sec.
IV.D.
c. Other discrete-variable protocols. A large number of
other discrete-variable protocols have been proposed; all
of them have features that makes them less interesting
for practical QKD than BB84 or SARG04.
The six-state protocol
(Bechmann-Pasquinucci and Gisin, 1999; Bennett et al.,
1984; Bruß, 1998) follows the same structure as BB84,
to which it adds the third mutually unbiased basis
Z defined by the Pauli matrix σz. Its unconditional
security has been proved quite early (Lo, 2001). The
interest of this protocol lies in the fact that the channel
estimation becomes “tomographically complete”, that
is, the measured parameters completely characterize the
channel. As a consequence, more noise can be tolerated
with respect to BB84 or SARG04. However, noise is
quite low in optical setups, while losses are a greater
concern (see II.F). Under this respect, six-state perform
worse, because it requires additional lossy optical components. Similar considerations apply to the six-state
version of the SARG04 coding (Tamaki and Lo, 2006)
and to the Singapore protocol (Englert et al., 2004).
The coding of BB84 and six-state has been
generalized to larger dimensional quantum systems (Bechmann-Pasquinucci and Peres, 2000;
Bechmann-Pasquinucci and Tittel, 2000). For any
d, protocols that use either two or d + 1 mutually
unbiased bases have been defined (Cerf et al., 2002).
Unconditional security was not studied; for restricted attacks, the robustness to noise increases with d. Time-bin
coding allows producing d-dimensional quantum states
of light in a rather natural way (De Riedmatten et al.,
2004; Thew et al., 2004). However, the production and
detection of these states requires d-arm interferometers
with couplers or switches, that must moreover be kept
stable. Thus again, the possible advantages are overcome
by the practical issues of losses and stability.
Finally, we have to mention the B92 protocol (Bennett,
1992), which uses only two non-orthogonal states, each
one coding for one bit-value. In terms of encoding,
this is obviously the most economic possibility. Un-
23 In an alternative version of the sifting, Alice reveals that the
state she sent belongs to one of the two sets {|saxi, |sayi}, and
Bob accepts if he has detected a state sb 6= sa. This is a simplified version with respect to the original proposal, where Alice
could declare any of the four sets of two non-orthogonal states.
The fact, that the two versions are equivalent in terms of security, was not clear when the first rigorous bounds were derived
(Branciard et al., 2005), but was verified later.13
fortunately, B92 is a rather sensitive protocol: as noticed already in the original paper, this protocol is secure only if some other signal (e.g. a strong reference
pulse) is present along with the two states that code the
bit. Unconditional security has been proved for singlephoton implementations (Tamaki, Koashi and Imoto,
2003; Tamaki and L¨utkenhaus, 2004) and for some implementations with a strong reference pulse (Koashi,
2004; Tamaki et al., 2006). Incidentally, SARG04 may
be seen as a modified B92, in which a second set of
non-orthogonal states is added — actually, an almost
forgotten protocol served as a link between the two
(Huttner et al., 1995).
3. Continuous-variable Protocols
Discrete-variable coding can be implemented with several sources, but requires photon-counting techniques.
An alternative approach to QKD has been suggested, in
which the photon counters are replaced by standard telecom PIN photodiodes, which are faster (GHz instead of
MHz) and more efficient (typically 80% instead of 10%).
The corresponding schemes are then based on homodyne
detection (II.G.2) and involve measuring data that are
real amplitudes instead of discrete events; hence these
schemes are named continuous-variable (CV) QKD.
The first proposals suggesting the use of homodyne detection in QKD are due to (Hillery, 2000; Ralph, 1999;
Reid, 2000). In particular, a squeezed-state version of
BB84 was proposed in (Hillery, 2000), where Alice’s basis
choice consists of selecting whether the state of light sent
to Bob is squeezed in either quadrature q = x or q = p.
Next, this q-squeezed state is displaced in q either by +c
or −c depending on a random bit chosen by Alice, where
c is an appropriately chosen constant. Bob’s random basis choice defines whether it is the x or p quadrature that
is measured. The sifting simply consists in keeping only
the instances where Alice and Bob’s chosen quadratures
coincide. In this case, the value measured by Bob is distributed according to a Gaussian distribution centered
on the value (+c or −c) sent by Alice. In some sense,
this protocol can be viewed as “hybrid” because Alice’s
data are binary while Bob’s data are real (Gaussian distributed).
These early proposals and their direct generalization
are called CV protocols with discrete modulation; at the
same time, another class of CV protocols was proposed
that rather use a continuous modulation, in particular a
Gaussian modulation. Although CV protocols are much
more recent than discrete-variable protocols, their security proofs have been progressing steadily over the last
years, and are now close to reach a comparable status:
see a thorough discussion in Sec. V.A.
a. Gaussian protocols. The first proposed Gaussian QKD
protocol was based on squeezed states of light, which are
modulated with a Gaussian distribution in the x or p
quadrature by Alice, and are measured via homodyne detection by Bob (Cerf, L´evy and Van Assche, 2001). This
protocol can be viewed as the proper continuous-variable
counterpart of BB84 in the sense that the average state
sent by Alice is the same regardless of the chosen basis (it
is a thermal state, replacing the maximally-mixed qubit
state in BB84). The security of this protocol can be
analyzed using the connection with continuous-variable
cloning (Cerf, Ipe and Rottenberg, 2000); using a connection with quantum error-correcting codes, unconditional security was proved when the squeezing exceeds
2.51 dB (Gottesman and Preskill, 2001). The main drawback of this protocol is the need for a source of squeezed
light.
A second Gaussian QKD protocol was therefore devised, in which Alice generates coherent states of
light, which are then Gaussian modulated both in
x and p, while Bob still performs homodyne detection (Grosshans and Grangier, 2002a). A first proof-ofprinciple experiment, supplemented with the technique
of reverse reconciliation24, was run with bulk optical elements on an optics table (Grosshans, Van Assche et al.,
2003). Subsequent experiments have used optical fibers
and telecom wavelengths. The scheme was thus implemented over distances up to 14 km using a Plug&Play
configuration (Legr´e, Zbinden and Gisin, 2006), then up
to 25 km by time-multiplexing the local oscillator pulses
with the signal pulses in the same optical fiber and using
an improved classical post-processing (Lodewyck et al.,
2005; Lodewyck, Bloch et al., 2007). Another fiberbased implementation over 5 km has been reported
(Qi, Huang et al., 2007).
Note that, in these two first protocols, Bob randomly
chooses to homodyning one quadrature, either x or p. In
the squeezed-state protocol, this implies the need for sifting. Bob indeed needs to reject the instances where he
measured the other quadrature than the one modulated
by Alice, which results in a decrease of the key rate by a
factor of 2 (this factor may actually be reduced arbitrarily close to 1 by making an asymmetric choice between x
and p, provided that the key length is sufficiently large)
(Lo, Chau and Ardehali, 1998-2005). In the coherentstate protocol, Alice simply forgets the quadrature that
is not measured by Bob, so that all pulses do carry useful
information that is exploited to establish the final secret
key.
The fact that Alice, in this second protocol, discards half of her data may look like a loss of efficiency
since some information is transmitted and then lost. A
third Gaussian QKD protocol was therefore proposed
24 In all Gaussian QKD protocols, reversing the one-way reconciliation procedure (i.e., using Bob’s measured data instead of Alice’s sent data as the raw key) is beneficial in terms of attainable
range, provided that the noise is not too large. We will come
back to this point in Section V.14
(Weedbrook et al., 2004), in which Alice still transmits
doubly-modulated coherent states drawn from a bivariate Gaussian distribution, but Bob performs heterodyne
instead of homodyne measurements25, that is, he measures both x and p quadratures simultaneously. At first
sight, this seems to imply that the rate is doubled since
Bob then acquires a pair of quadratures (x, p). Actually,
since heterodyne measurement effects one additional unit
of vacuum noise on the measured quadratures, the two
quadratures received by Bob are noisier than the single
quadrature in the homodyne-based protocol. The net effect, however, is often an increase of the key rate when
the two quadratures are measured simultaneously. In
addition, a technological advantage of this heterodynebased coherent-state protocol is that there is no need to
choose a random quadrature at Bob’s side (that is, no
active basis choice is needed). The experiment has been
realized (Lance et al., 2005).
Finally, a fourth Gaussian QKD protocol was introduced recently (Garc´ıa-Patr´on, 2007), which completes this family of Gaussian QKD protocols. Here,
Alice sends again squeezed states, as in the protocol of (Cerf, L´evy and Van Assche, 2001), but Bob performs heterodyne measurements, as in the protocol of
(Weedbrook et al., 2004). This protocol is associated
with the highest rate and range among all Gaussian QKD
protocols, but requires a source of squeezed light.
As seen in the discussion about BB84 and SARG04
above, it turns out also for the CV QKD protocols that
the classical processing is an essential element of the
protocol. As will be discussed later (V.A), the performance of CV-QKD protocols depends crucially on
the exact protocol that extracts the secret key from
the experimental data. Two important tools here are
reverse reconciliation (Grosshans and Grangier, 2002a)
and post-selection (Silberhorn et al., 2002). As shown in
(Heid and L¨utkenhaus, 2007), the combination of both
will lead to the optimal key rate.
b. Discrete-modulation protocols. On the side of practical
implementation, it is desirable to keep the number of signals as low as possible, and also to minimize the number
of parameters in the detection process that needs to be
monitored. The deep reason behind this is that in practical implementation at some stage one has to consider
finite size effects in the statistics and also in the security
proof stage. For a continuous family of signals, it will be
intuitively harder to get hold of these finite size effects
and to include statistical fluctuations of observations into
a full security proof.
For this reason, it becomes interesting to have a look
25 This possibility was also suggested for postselection-based protocols in (Lorenz, Korolkova and Leuchs, 2004), and the experiment has been performed (Lorenz et al., 2006).
at QKD systems that combine a finite number of signals with the continuous variable detection schemes:
discrete-modulation protocols have been devised following this proposal, some based on coherent states instead
of squeezed states (Silberhorn et al., 2002). The signals
consist here of a weak coherent state together with a
strong phase reference. The signal is imprinted onto the
weak coherent state by setting the relative optical phase
between weak coherent state and reference pulse either
to 0 or π. Schematically, the strong phase reference could
be represented by two local oscillators, e.g. phase-locked
lasers at the sending and receiving station. These type
of signals have been used already in the original B92 protocol (Bennett, 1992). The receiver then uses the local
oscillator in the homodyne or heterodyne measurement.
The security of this protocol is still based on the fact
that the weak signal pulses represent non-orthogonal signal states.
On the receiver side, homodyne detection is performed
by choosing at random one of the two relevant quadrature measurement (one quadrature serves the purpose
of being able to measure the bit values, the other one
serves the purpose to monitor the channel to limit possible eavesdropping attacks). Alternatively, a heterodyne
measurement can, in a way, monitor both quadratures.
Consider for definiteness a simple detection scheme, in
which bit-values are assigned by the sign of the detection signal, + or −, with respect to the half-planes in
the quantum optical phase space in which the two signals reside. As a result, both sender and receiver have
binary data at hand. As in the case of Gaussian modulation, they can now perform post-selection of data, and
use error-correction and privacy amplification to extract
secret keys from these data.
4. Distributed-phase-reference Protocols
Both discrete- and continuous-variable protocols have
been invented by theorists. Some experimental groups, in
their developments toward practical QKD systems, have
conceived new protocols, which do not fit in the categories above. In these, like in discrete-variable protocols,
the raw keys are made of realizations of a discrete variable
(a bit) and are already perfectly correlated in the absence
of errors. However, the quantum channel is monitored using the properties of coherent states — more specifically,
by observing the phase coherence of subsequent pulses;
whence the name distributed-phase-reference protocols.
The first such protocol has been called DifferentialPhase-Shift (DPS) (Inoue, Waks and Yamamoto, 2002,
2003). Alice produces a sequence of coherent states of
same intensity
|Ψ(Sn)i = ...|eiϕk−1√µi|eiϕk√µi|eiϕk+1√µi... (9)
where each phase can be set at ϕ = 0 or ϕ = π
(Fig. 2). The bits are coded in the difference between
two successive phases: bk = 0 if eiϕk = eiϕk+1 and15
tB D
B
D
M1
D
M2
1 t -
B
Alice Bob
Laser IM
D
0
Alice
Laser PM
0 p p 0 0 p Bob
D
1
FIG. 2 The two distributed-phase reference protocol: differential phase shift (DPS, top) and coherent one-way (COW,
bottom). Legend: PM: phase modulator; IM: intensity modulator. See text for description.
bk = 1 otherwise. This can be unambiguously discriminated using an unbalanced interferometer. The complexity in the analysis of this protocol lies in the fact
that |Ψ(Sn)i 6= |ψ(b1)i ⊗ ... ⊗ |ψ(bn)i: the k-th pulse
contributes to both the k-th and the (k + 1)-st bit.
The DPS protocol has been already the object of several experimental demonstrations (Diamanti et al., 2006;
Takesue et al., 2005, 2007).
In the protocol called Coherent-One-Way (COW)
(Gisin et al., 2004; Stucki et al., 2005), each bit is coded
in a sequence of one non-empty and one empty pulse:
|0ik = |√µi2k−1|0i2k , |1ik = |0i2k−1|√µi2k . (10)
These two states can be unambiguously discriminated
in an optimal way by just measuring the time of arrival (Fig. 2). For the channel estimation, one checks
the coherence between two successive non-empty pulses;
these can be produced on purpose as a “decoy sequence”
|√µi2k−1|√µi2k, or can happen as |√µi2k|√µi2k+1
across a bit separation, when a sequence |1ik|0ik+1 is
coded. This last check, important to detect PNS attacks,
implies that the phase between any two successive pulses
must be controlled; therefore, as it happened for DPS,
the whole sequence must be considered as a single signal.
A prototype of a full QKD system based on COW has
been reported recently (Stucki et al., 2008).
Both DPS and COW are P&M schemes, tailored for
laser sources. It has not yet been possible to derive a
bound for unconditional security, because the existing
techniques apply only when |Ψ(Sn)i can be decomposed
in independent signals. We shall review the status of
partial security proofs in Sec. VI.
E. Sources
1. Lasers
Lasers are the most practical and versatile light sources
available today. For this reason, they are chosen by the
vast majority of groups working in the field. Of course,
all implementations in which the source is a laser are
P&M schemes. For the purposes of this review, we don’t
have to delve deep into laser physics. The output of a
laser in a given mode is described by a coherent state of
the field
|√µ eiθi ≡ |αi = e−µ/2
∞ X n
=0
αn
√n!|ni (11)
where µ = |α2| is the average photon number (also called
intensity). The phase factor eiθ is accessible if a reference
for the phase is available; if not, the emitted state is
rather described by the mixture
ρ = Z02π 2dθ π|αihα| = X
n
P(n|µ)|nihn| (12)
with
P(n|µ) = e−µ µn
n! . (13)
Since two equivalent decompositions of the same density
matrix cannot be distinguished, one may say as well that,
in the absence of a phase reference, the laser produces a
Poissonian mixture of number states.
The randomization of θ generalizes to multimode coherent states (Mølmer, 1997; van Enk and Fuchs, 2002).
Consider for instance the two-mode coherent state
|√µ ei(θ+ϕ)i|√µ′ eiθi that may describe for instance a
weak pulse and a reference beam. The phase ϕ is the relative phase between the two modes and is well-defined,
but the common phase θ is random. One can then carry
out the same integral as before; the resulting ρ is the Poissonian mixture with average photon number µ + µ′ and
the number states generated in the mode described by
the creation operator A† = eiϕ√µa† 1 +√µ′a† 2/√µ + µ′.
Let us turn now to QKD. The existence of a reference for the phase is essential in both continuous-variable
and distributed-phase-reference protocols: after all, these
protocols have been designed having specifically in mind
the laser as a source. On the contrary, when attenuated
lasers are used to approximate qubits in discrete protocols, the phase reference does not play any role. In this
implementations, ρ given in (12) is generically26 an accurate description of the quantum signal outside Alice’s lab.
26 One must be careful though: the fact that the phase reference is
not used in the protocol does not necessarily mean that such a
reference is physically not available. In particular, such reference
is available for some source, e.g. when a mode-locked laser is used16
Since ρ commutes with the measurement of the number of
photons, this opens the possibility of the photon-numbersplitting (PNS) attacks (Bennett, 1992; Brassard et al.,
2000; L¨utkenhaus, 2000), a major concern in practical
QKD that will be addressed in Sec. III.B.3.
2. Sub-Poissonian Sources
Sub-Poissonian sources (sometimes called “singlephoton sources”) come closer to a single-photon source
than an attenuated laser, in the sense that the probability of emitting two photons is smaller. The quantum
signal in each mode is taken to be a photon-number diagonal mixture with a very small contribution of the multiphoton terms. The quality of a sub-Poissonian source is
usually measured through the second order correlation
function
g2(τ) = h: I(t)I(t + τ) :i
hI(t)i2 (14)
where I(t) is the signal intensity emitted by the source
and : − : denotes normal ordering of the creation and annihilation operators. In particular, g2(0) ≈ 2p(2)/p(1)2,
while p(n) is the probability that the source emits n photons. For Poissonian sources, g2(0) = 1; the smaller
g2(0), the closer the source is to an ideal single-photon
source. It has been noticed that the knowledge of the
efficiency and of g2 is enough to characterize the performance of such a source in an implementation of BB84
(Waks, Santori and Yamamoto, 2002).
Sub-Poissonian sources have been, and still are, the
object of intensive research; recent reviews cover the
most meaningful developments (Lounis and Orrit, 2005;
Shields, 2007). In the context of QKD, the discovery of
PNS attacks triggered a lot of interest in sub-Poissonian
sources, because they would reach much higher secret
fractions. QKD experiments have been performed with
such sources (All´eaume et al., 2004; Beveratos et al.,
2002; Waks et al., 2002), also in fibers (Intallura et al.,
2007) thanks to the development of sources at telecom wavelengths (Saint-Girons et al., 2006; Ward et al.,
2005; Zinoni et al., 2006). At the moment of writing, this
interest has significantly dropped, as it was shown that
the same rate can be achieved with lasers by using decoy
states, see IV.B.3 and IV.B.4. But the tide may turn
again in the near future, for applications in QKD with
quantum repeaters (Sangouard et al., 2007).
to produce pulses. In such cases, even though Alice and Bob
don’t use the phase coherence in the protocol, the signal is no
longer correctly described by (12), and Eve can in principle take
advantage of the existing coherence to obtain more information
(Lo and Preskill, 2007). Therefore it is necessary to implement
active randomization (Gisin et al., 2006; Zhao, Qi and Lo, 2007).
3. Sources of Entangled Photons
Entangled photon pairs suitable for entanglementbased protocols or for heralded sub-Poissonian sources
are mostly generated by spontaneous parametric down
conversion (SPDC) (Mandel and Wolf, 1995). In this
process some photons from a pump laser beam are converted due to the non-linear interaction in an optical crystal27 into pairs of photons with lower energies. The total
energy and momentum are conserved. In QKD devices,
cw-pumped sources are predominantly used.
In the approximation of two output modes, the state
behind the crystal can be described as follows
|ψiPDC = p1 − λ2
∞ X n
=0
λn|nA, nBi, (15)
where λ = tanhξ with ξ proportional to the pump amplitude, and where |nA, nBi denotes the state with n photons in the mode destined to Alice and n photons in the
other mode aiming to Bob. This is the so called twomode squeezed vacuum.
The photons are entangled in time and in frequencies (energies); one can also prepare pairs of photons correlated in other degrees of freedom: polarization (Kwiat et al., 1995, 1999), time bins (Brendel et al.,
1999; Tittel et al., 2000), momenta (directions), or orbital angular momenta (Mair et al., 2001).
The state (15) can be directly utilized in continuousvariable protocols. In the case of discrete-variable
protocols, one would prefer only single pair of photons per signal; however, SPDC always produces multipair components, whose presence must be taken into
account. Let us describe this in the four-mode approximation, which is sufficient for the description of
fs-pulse pumped SPDC (Li et al., 2005). An ideal
two-photon maximally entangled state reads |Ψ2i =
1√
2 (|1, 0iA|1, 0iB + |0, 1iA|0, 1iB) where each photon can
be in two different modes (orthogonal polarizations, different time-bins...). This state can be approximately
achieved if λ ≪ 1, i.e. if the mean pair number per pulse
µ = 2λ2/(1 − λ2) ≪ 1. But there are multi-pair components: in fact, again in the case of a four-mode approximation, the generated state reads
|Ψi ≈ pp(0)|0i + pp(1)|Ψ2i + pp(2)|Ψ4i (16)
where p(1) ≈ µ and p(2) ≈ 34µ2, |0i is the vacuum state,
and the four-photon state is |Ψ4i = √13|0, 2i|0, 2i +
27 Crystals like KNbO3, LiIO3, LiNbO3, β-BaB2O4, etc.
Very promising are periodically-poled nonlinear materials
(Tanzilli at al., 2001). Besides the spontaneous parametric down
conversion, new sources of entangled photons based on quantum
dots are tested in laboratories (Young at al., 2006). But these
sources are still at an early stage of development. Their main
drawback is the need of cryogenic environment.17
|2, 0i|2, 0i+|1, 1i|1, 1i. We recall that this description is
good for short pump pulses; when a cw-pumped source
is used (or the pulse-pumped source with the pulse duration much larger than the coherence time τ of the
down-converted photons) the four-mode approximation
is not applicable and a continuum of frequency modes
must be taken into account. The multiple excitations
created during the coherence time τ are coherent and
partially correlated: in this case, the four-photon state
is a fully entangled state that cannot be written as “two
pairs” — see |Ψ4i above28. However, τ is usually much
shorter than the typical time ∆t that one can discriminate, this time being defined as the time resolution of the
detectors for cw-pumped sources29 or as the duration of
a pulse for pulsed sources. This implies that, when two
photons arrive “at the same time”, they may actually
arise from two incoherent processes, and in this case the
observed statistics corresponds to that of two independent pairs. This physics has been the object of several
studies (De Riedmatten et al., 2004b; Eisenberg et al.,
2004; Ou, Rhee and Wang, 1999; Scarani et al., 2005;
Tapster and Rarity, 1998; Tsujino et al., 2004).
What concerns us here is the advantage that Eve may
obtain, and in particular the efficiency of PNS attacks. If
the source is used in a P&M scheme as heralded singlephoton source, then the PNS attack is effective as usual,
because all the photons that travel to Bob have been
actively prepared in the same state (L¨utkenhaus, 2000);
ideas inspired from decoy states can be used to detect it
(Adachi et al., 2007; Mauerer and Silberhorn, 2007). In
an EB scheme, the PNS attack is effective on the fraction ζ ≈ τ/∆t of coherent four-photon states; besides,
all multi-pair contributions inevitably produce errors in
the correlations Alice-Bob. We shall come back to these
points in Sec. IV.B.5.
F. Physical Channels
As far as the security is concerned, the quantum channel must be characterized only a posteriori, because Eve
has full freedom of acting on it. However, the knowledge
of the a priori expected behavior is obviously important
at the moment of designing a setup. We review here the
physics of the two main quantum channels used for light,
namely optical fibers and free space beams.
An important parameter of the quantum channel is the
amount of losses. Surely enough, a key can be built by
post-selecting only those photons that have actually been
28 Though a nuisance in qubit-based protocols, the existence of such
four photon components can lead to new opportunities for QKD,
as pointed out independently in (Brassard, Mor and Sanders,
2000) and (Durkin et al., 2002).
29 However, a recent entanglement-swapping experiment combined
fast detectors and narrow filters to achieve ∆t < τ in cw-pumped
SPDC (Halder et al., 2007).
detected. But, since quantum signals cannot be amplified, the raw key rate decreases with the distance as the
transmission t of the channel; in addition, at some point
the detection rate reaches the level of the dark counts
of the detectors, and this effectively limits the maximal
achievable distance. Finally, in general the lost photons
are correlated to the signal and thus must be counted as
information that leaked to Eve.
Concerning the interaction of photons with the environment in the channel, the effect of decoherence depends
strongly on the quantum degree of freedom that is used;
therefore, although weak in principle, it cannot be fully
neglected and may become critical in some implementations.
1. Fiber Links
The physics of optical fibers has been explored in depth
because of its importance for communication (Agrawal,
1997). When we quote a value, we refer to the specifications of the standard fiber Corning SMF-28 (see e.g.
www.ee.byu.edu/photonics/connectors.parts/smf28.pdf);
obviously, the actual values must be measured in any
experiment.
The losses are due to random scattering processes and
depend therefore exponentially on the length ℓ:
t = 10−α ℓ/10 . (17)
The value of α is strongly dependent on the wavelength
and is minimal in the two “telecom windows” around
1330nm (α ≃ 0.34dB/km) and 1550nm (α ≃ 0.2dB/km).
The decoherence channels and their importance vary
with the coding of the information. Two main effects
modify the state of light in optical fibers. The first
effect is chromatic dispersion: different wavelengths
travel at slightly different velocities, thus leading to
an incoherent temporal spread of a light pulse. This
may become problematic as soon as subsequent pulses
start to overlap. However, chromatic dispersion is a
fixed quantity for a given fiber, and can be compensated (Fasel, Gisin, Ribordy and Zbinden, 2004). The
second effect is polarization mode dispersion (PMD)
(Galtarossa and Menyuk, 2005; Gisin and Pellaux,
1992). This is a birefringent effect, which defines a fast
and a slow polarization mode orthogonal to one another,
so that any pulse tends to split into two components.
This induces a depolarization of the pulse. Moreover,
the direction of the birefringence may vary in time due
to environmental factors: as such, it cannot be compensated statically. Birefringence effects induce decoherence
in polarization coding, and may be problematic for all
implementations that require a control on polarization.
The importance of such effects depend on the fibers and
on the sources; recent implementations can be made
stable, even though they use a rather broadband source
(H¨ubel et al., 2007).18
2. Free Space Links
A free space QKD link can be used in several
very different scenarios, from short distance lineof-sight links with small telescopes mounted on
rooftops in urban areas, to ground-space or even
space-space links, involving the use of astronomical telescopes (see also VIII.A.4). Free-space QKD
has been demonstrated in both the prepare-andmeasure (Buttler et al., 1998; Hughes et al., 2002;
Kurtsiefer et al., 2002; Rarity, Gorman and Tapster,
2001) and the entanglement-based configurations (Erven et al., 2008; Ling et al., 2008;
Marcikic, Lamas-Linares and Kurtsiefer, 2006;
Ursin et al., 2007).
The decoherence of polarization or of any other degree of freedom is practically negligible. The losses can
roughly be divided into geometric and atmospheric. The
geometric losses are related with the apertures of receiving telescopes and with the effective aperture of the sending telescope (the one perceived by the receiving telescope, which is influenced by alignment, moving buildings, atmospheric turbulence etc.). The atmospheric
losses are due to scattering and to scintillation. Concerning scattering, within the 700-10.000nm wavelength
range there are several ’atmospheric transmission windows’, e.g. 780-850nm and 1520-1600nm, which have an
attenuation α < 0.1dB/km in clear weather. Obviously,
the weather conditions influence heavily such losses; numerical values are available, see e.g. (Bloom et al., 2003;
Kim and Korevaar, 2001). A simple model of the losses
for a line-of-sight free space channel of length ℓ is therefore given by t ≈ ds+drD ℓ2 10−α ℓ/10, where the first
term is an estimate of the geometric losses (ds and dr are
the apertures of the sending and receiving telescopes, D
is the divergence of the beam) and the second describes
scattering (α is the atmospheric attenuation). We note
that this formula does not account for scintillation, which
is often the most critical factor in practice.
G. Detectors
1. Photon Counters
Discrete-variable protocols use photon-counters as detectors. The main quantities characterizing photoncounters are the quantum efficiency η that represents the
probability of a detector click when the detector is hit by
a photon, and the dark-count rate pd characterizing the
noise of the detector – dark counts are events when a
detector sends an impulse even if no photon has entered
it. An important parameter is also the dead time of the
detector, i.e. the time it takes to reset the detector after a click. These three quantities are not independent.
Most often, the overall repetition rate at which the detector can be operated is determined by the dead time.
For each of the detectors discussed below, the meaningful
parameters are listed in Table I.
The most commonly used photon counters in discretevariable systems are avalanche photodiodes (APD).
Specifically, for wavelengths from the interval approximately 400–1000nm Si APD can be used, for wavelengths from about 950nm to 1650nm, including telecom wavelengths, InGaAs/InP diodes are most often
applied. A whole savoir-faire on the use of APDs
has originated in the field of QKD (Cova et al., 2004;
Gisin, Ribordy, Tittel and Zbinden, 2002). Because they
can be operated with thermo-electric cooling, these detectors are an obvious choice for practical QKD, and in
particular for commercial devices (Ribordy et al., 2004;
Trifonov et al., 2004). Two recent developments are
worth mentioning. First: instead of direct use of InGaAs APDs, one can detect signals at telecom wavelengths (1310nm and 1550nm) by applying parametric
frequency up-conversion and then using efficient silicon
APDs (Diamanti et al., 2005; Thew et al., 2006). Compared with InGaAs APDs, these up-conversion detectors
have lower quantum efficiency but could in principle be
operated in continuous mode thus leading to repetition
rates (GHz); however, as of today’s knowledge, they suffer from an intrinsic noise source that leads to high dark
count rates. Second: more recently, an improvement
of the repetition rate and count rate by several orders
of magnitude has been obtained by using a circuit that
compares the output of the APD with that in the preceding clock cycle; such devices have been named selfdifferencing APDs (Yuan et al., 2007).
Single-photon detectors other than APDs have been
and are being developed. For instance, Visible Light Photon Counters are semiconductor detectors that can also distinguish the number of impinging photons (Kim et al., 1999; Waks et al., 2003;
Waks, Diamanti and Yamamoto, 2006). Other photoncounters are based on superconductors, for instance Superconducting Single Photon Detectors (Verevkin et al.,
2002, 2004) and Transition Edge Sensors (Miller et al.,
2003; Rosenberg et al., 2005); both types have been already used in QKD experiments (Hadfield et al., 2006;
Hiskett et al., 2006; Rosenberg et al., 2007, 2009). Each
type has its own strong and weak features; in particular,
all of them must be operated at cryogenic temperatures.
2. Homodyne Detection
Continuous-variable QKD is based on the measurement of quadrature components of light. This can conveniently be done by means of optical homodyne detection. This detection scheme uses two beams of the same
frequency: the signal and the so-called local oscillator
(much stronger and therefore often treated as classical).
The beams are superimposed at a balanced beam splitter. The intensity of light in each of the output modes
is measured with proportional detectors, and the difference between the resulting photocurrents is recorded. If19
Name λ η pd Rep. Count Jitter T n
[nm] [MHz] [MHz] [ps] [K]
APDs:
Si 600 50% 100Hz cw 15 50-200 250 N
InGaAs 1550 10% 10−5/g 10 0.1 500 220 N
Self-Diff. 1250 100 60
Others:
VLPC 650 58-85% 20kHz cw 0.015 N.A. 6 Y
SSPD 1550 0.9% 100Hz cw N.A. 68 2.9 N
TES 1550 65% 10Hz cw 0.001 9×104 0.1 Y
TABLE I Overview of typical parameters of single-photon detectors: detected wavelength λ, quantum efficiency η, fraction
of dark counts pd (g: gate), repetition rate (cw: continuous
wave), maximum count rate, jitter, temperature of operation
T; the last column refers to the possibility of distinguishing
the photon numbers. For acronyms and references, refer to
the main text.
the amplitude and the phase of the local oscillator are
stable, the differential current carries information about
a quadrature component of the input signal — what
quadrature component is actually measured depends on
the phase difference between the signal and local oscillator. To keep this phase difference constant, the signal
and local oscillator are usually derived from the same
light source: the local oscillator beam needs to be transmitted along with the signal from Alice to Bob; in practice, they are actually sent through the same channel,
so that they experience the same phase noise and the
relative phase remains unaltered — note however that
this practical change may render the scheme completely
insecure, unless additional measurements are performed
to verify the character of both the weak and the strong
signal (H¨aseler, Moroder and L¨utkenhaus, 2008).
The intensities are measured by PIN diodes, which
provide high detection efficiency (typically 80%) and
relatively low noise. Therefore homodyne detection
could in principle operate at GHz repetition rates
(Camatel and Ferrero, 2006) in contrast to photon counters based on APDs, whose detection rate is limited by
the detector dead-time.
The use of such a high-rate homodyne detection technique unfortunately comes with a price. Because of
the uncertainty principle, the measurement of complementary quadratures is intrinsically noisy. The vacuum
noise (or intrinsic noise) is the noise obtained when
there is vacuum in the signal port (only the local oscillator is present). Now, the unavoidable transmission
losses in the optical line, which simply cause “missing
clicks” in photon-counting based schemes, result in a decrease of the signal-to-noise ratio in homodyne-detection
based schemes. The vacuum noise is responsible for
a rather significant added noise in continuous-variable
QKD, which needs to be corrected during the classical
post-processing stage: an additional computing effort in
continuous-variable QKD.
In addition to the vacuum noise, an excess noise is generated mainly by detectors themselves and by the subsequent electronics. In real systems, it is possible to reduce
the excess noise even 20 dB below the shot noise; but this
ratio depends on the width of the spectral window, and
narrow spectral windows bound the modulation frequencies (i.e. the repetition rates).
H. Synchronization and alignment
1. Generalities
The problem of the synchronization of two distant
clocks, in itself, is a technical matter that has been solved
efficiently in several different ways; basically, either one
sends out a synchronization signal at regular intervals
during the whole protocol, or one relies on an initial synchronization of two sufficiently stable clocks. In the context of QKD, one has to consider possible hacking attacks
that would exploit this channel (more in Sec. III.B.4).
The physical meaning of alignment depends on the
coding. For coding in polarization, it obviously means
that Alice and Bob agree on the polarization directions.
For phase coding, it refers rather to the stabilization of interferometers. Both procedures are most often performed
by sending a servoing signal at a different frequency than
the quantum signal, taking advantage of the bandwidth
of the optical channel. Alternatively, self-stabilized setups have been proposed: this is the so-called Plug&Play
configuration, that we shall describe in the next paragraph in the context of phase-coding.
Before that, we have to mention that quantum mechanics allows also for a coding that does not require any
alignment by exploiting the so-called “decoherence-free
subspaces” (Boileau et al., 2004; Zanardi and Rasetti,
1997). However, though demonstrated in some
proof-of-principle experiments (Bourennane et al., 2004;
Chen et al., 2006), such coding is highly impractical, as
it requires the preparation and measurement of complex multi-photon states; moreover, it is very sensitive
to losses30.
30 The simplest example is the singlet state of two qubits: when
both qubits are sent into the quantum channel, the state is robust against any misalignment U since U ⊗U|Ψ−i = |Ψ−i. With
four physical qubits, there are two orthogonal states such that
U ⊗ U ⊗ U ⊗ U|ψ0,1i = |ψ0,1i; therefore, one can form an effective logical qubit |0i ≡ |ψ0i and |1i ≡ |ψ1i that is insensitive
to misalignments. The states |ψ0,1i are not easy to prepare and
to detect. As a matter of fact, the available experiments did
not produce those states: they produced a quite complex photonic state, that gives the required statistics conditioned on the
observation of a specific detection pattern. In turn, this implies
that all four photons must be transmitted and detected, therefore
losses lead to a very fast decrease of the detection rate.20
2. Phase coding: two configurations
D
0
Alice
Laser
a
a
Bob
D
1
b
D
0
Alice Bob Laser
D
1
R
FM C
DL
PD
Att.
FIG. 3 Comparison of the one-way and two-way configurations for phase coding. The one-way configuration is called
double Mach-Zehnder (top). Alice splits each laser pulse
into two pulses with relative phase α; if Bob’s phase is such
that α − β = 0 modulo π, the outcome is deterministic
in the absence of errors. In the two-way configuration, or
Plug&Play(bottom), the source of light is on Bob’s side. In
detail: an intense laser pulse is sent through a circulator (C)
into Bob’s interferometer. The phase modulator is passive at
this stage, but a polarization rotation (R) is implemented so
that all the light finally couples in the fiber. On Alice’s side,
part of the light is deflected to a proportional detector (PD)
that is used to monitor Trojan Horse attacks. The remaining
light goes to a Faraday mirror (FM) that sends each polarization on the orthogonal one. On the way back, the pulses
are attenuated down to the suitable level, then the coding is
done as above. The role of the delay line (DL) is explained in
the text.
We consider P&M schemes with phase coding. This
coding has been the preferential choice in fiber implementations and has given rise to two possible configurations (Fig. 3). In the configuration called one-way,
the laser is on Alice’s side; it is typically realized with
a double Mach-Zehnder interferometer (Bennett, 1992;
Townsend, Rarity and Tapster, 1993). The other possible configuration has been called Plug&Play configuration (Muller et al., 1997; Ribordy et al., 1998). As the
name suggests, the goal of the Plug&Play configuration
is to achieve self-alignment of the system. Contrary to
the one-way configuration, the Plug&Play configuration
puts the source of light on Bob’s side: a strong laser
pulse travels on the quantum channel from Bob to Alice.
Alice attenuates this light to the suitable weak intensity
(surely less than one photon per pulse in average, more
precisions below and in Sec. IV.B.4), codes the information and sends the remaining light back to Bob, who
detects. The coded signal goes as usual from Alice to
Bob; but the same photons have first traveled through
the line going from Bob to Alice. This way, interferometers become self-stabilized because the light passes twice
through them; if the reflection on Alice’s side is done
with a Faraday mirror, polarization effects in the channel
are compensated as well. These two configurations have
shaped the beginning of practical QKD; we refer to a previous review (Gisin, Ribordy, Tittel and Zbinden, 2002)
for a thorough discussion.
It is useful here to address some problems that are
specific for the Plug&Play configuration, since they illustrate the subtleties of practical QKD. The system has
an intrinsic duty cycle, which limits the rate at long distances: Bob must wait a go-and-return cycle before sending other strong signals, otherwise the weak signal coded
by Alice will be overwhelmed by the backscattered photons of the new strong ones31. The nuisance has been
reduced by having Bob send, not just one pulse, but a
train of pulses; on Alice’s side, a sufficiently long delay
line must be added: all the pulses must have passed the
phase modulator before the first one comes back and is
coded. Still, this duty cycle is a serious bottleneck compared to one-way configurations.
Also, two specific security concerns arise for the
Plug&Play configuration. First concern: in full generality, there is no reason to assume that Eve interacts only
with the signal going from Alice to Bob: she might as
well modify the signal going from Bob to Alice. A simple argument suggests that this is not helpful for Eve:
Alice attenuates the light strongly and should actively
randomize the global phase; then, whatever the state
of the incoming light, the outgoing coded light consists
of weak signals with almost exact Poissonian statistics
(Gisin et al., 2006). Indeed, the rigorous analysis shows
that unconditional security can be proved if the global
phase is actively randomize, and that the resulting secret fractions are only slightly lower than those achievable
with the one-way configuration (Zhao, Qi and Lo, 2008).
Second concern: since Alice’s box must allow two-way
transit of light, Trojan Horse attacks (see III.B.4) must
be monitored actively, whereas in one-way setups they
can be avoided by passive optical isolators. In practice,
this may decrease the limiting distance32.
31 As a matter of fact, the back-scattering and the corresponding
duty cycle could be avoided, but at the price of attenuating the
pulses already at Bob’s side. In turn, this implies that (i) a
different channel should be used for synchronization, and (ii) the
maximal operating distance is reduced in practice, especially if
one takes Trojan Horse attacks into account,see below. Such a
setup has been demonstrated (Bethune and Risk, 2000).
32 The argument goes as follows: upon receiving Bob’s pulse, Alice
attenuates it down to the desired intensity µ. Now, it turns out
that a simple error by a factor of 2, i.e. sending out 2µ instead
of µ, would spoil all security (see IV.B.4). This implies that the
intensity of the input pulse must be monitored to a precision far
better than this factor 2. This precision may be hard to achieve
at long distances, when Bob’s pulse has already been significantly
attenuated by transmission.21
It is not obvious what the future perspectives of the
Plug&Play configuration will be: recently, stabilized oneway configurations have been demonstrated, which can
also reach optical visibilities larger than 99% and have
a less constraining duty cycle (Gobby, Yuan and Shields,
2004). Still, the Plug&Play configuration is an important milestone of practical QKD: in particular, the first
commercial QKD systems are based on it33.
III. SECRET KEY RATE
We have seen in Sec. II.B.4 that the secret key rate
K is the product of two terms (6), the raw key rate R
and the secret fraction r. This section is devoted to a
detailed study of these two factors. Clearly, the latter is
by far the more complex one, and most security studies
are devoted only to it; however the raw key rate is crucial
as well in practice and its proper description involves
some subtleties as well. We will therefore start from this
description.
A. Raw key rate
The raw key rate reads
R = νS Prob(Bob accepts) (18)
The second factor depends both on the protocol and on
the hardware (losses, detectors) and will be studied for
each specific case. The factor νS is the repetition rate.
In the case of pulsed sources νS is the repetition rate of
the source of pulses. Of course, νS ≤ νSmax, the maximal
repetition rate allowed by the source itself; but two other
limitations may become important in limiting cases, so
that the correct expression reads
ν
pulse
S = min νSmax, τd µt t 1 Bη, T1dc . (19)
We explain now what the two last terms mean.
The first limitation is due to the dead-time of the detectors τd. In fact, it is useless to send more light than
can actually be detected (worse, an excess of light may
even give an advantage to Eve). One can require that
at most one photon is detected in an interval of time τd;
the detection probability is Prob(Bob detects) ≈ µ t tBη
with µ = hni < ∼ 1 the average number of photons produced by the source, t the transmittivity of the quantum
channel, tB the losses in Bob’s device and η the efficiency
of the detector. Therefore, νS < ∼ (τd µ t tBη)−1. It is clear
that this limitation plays a role only at short distances:
33 The configuration has been used also for continuous-variable coding (Legr´e, Zbinden and Gisin, 2006), for a distributed-phasereference protocol (Zhou et al., 2003) and for non-cryptographic
quantum information tasks (Brainis et al., 2003).
as soon as there are enough losses in the channel, fewer
photon will arrive to Bob than can actually be detected.
The second limitation is associated to the existence of
a duty cycle: two pulses cannot be sent at a time interval
smaller than a time Tdc determined by the setup. The
expression for Tdc depends on the details of the setup. In
Plug&Play configurations for instance, one cannot send
the next train of bright pulses before the weak signal of
the earlier train has come back (II.H.2): the effect becomes important at long distance. Another example of a
duty cycle is the one introduced by a stabilization scheme
for one-way configurations, in which each coded signal is
preceded by a strong reference signal (Yuan and Shields,
2005). Note finally that in any implementation with
time-bin coding, the advanced component of the next
signal must not overlap with the delayed component of
the previous one.
In the case of heralded photon sources or
entanglement-based schemes working in a continuouswave (cw) regime it is reasonable to define νS as an
average rate of Alice’s detections, thus34
νcw
S = min ηAtAµ′, τ1dA , τd t t 1Bη, ∆1t . (20)
Here ηAtAµ′ is the trigger rate, with which Alice announces the pair creations to Bob, with µ′ being the
pair-generation rate of the source, tA is the overall transmittance of Alice’s part of the apparatus, and ηA is the
efficiency of Alice’s detectors. Of course, in practice this
rate is limited by the dead time of Alice’s detectors τdA.
The whole repetition rate is limited by Bob’s detector
dead time τd and by the width of coincidence window ∆t
(usually ∆t ≪ τd).
B. Secret fraction
1. Classical information post-processing
To extract a short secret key from the raw key, classical post-processing is required. This is the object of
this paragraph, for more details see e.g. (Renner, 2005;
Van Assche, 2006). The security bounds for the secret
fraction crucially depend on how this step is performed.
a. One-way post-processing. These are the most studied
and best known procedures. One of the partners, the one
who is chosen to hold the reference raw key, sends classical information through the public channel to the other
one, who acts according to the established procedure on
34 The source is assumed to be safe at Alice’s side. It is supposed
that Alice’s detectors are still “open” (not gated). Dark counts
and multi-pair contributions were neglected in the estimation of
νcw
S .22
his data but never gives a feedback. If the sender in this
procedure is the same as the sender of the quantum states
(Alice with our convention), one speaks of direct reconciliation; in the other case, of reverse reconciliation. The
optimal one-way post-processing has been characterized
and consists of two steps.
The first step is error correction (EC), also called information reconciliation, at the end of which the lists of
symbols of Alice and Bob have become shorter but perfectly correlated. As proved by Shannon, the fraction of
perfectly correlated symbols that can be extracted from
a list of partially correlated symbols is bounded by the
mutual information I(A : B) = H(A) + H(B) − H(AB)
where H is the entropy of the probability distribution.
In the context of one-way procedures with a sender S
and a receiver R, it is natural to write I(A : B) in the
apparently asymmetric form H(S) − H(S|R). This formula has an intuitive interpretation, if one remembers
that the entropy is a measure of uncertainty: the sender
must reveal an amount of information at least as large
as the uncertainty the receiver has on the reference raw
key.
The second step is privacy amplification (PA). This
procedure is aimed at destroying Eve’s knowledge on the
reference raw key. Of course, Alice and Bob will have
chosen as a reference raw key the one on which Eve has
the smallest information: here is where the choice between direct and reverse reconciliation becomes meaningful35. The fraction to be further removed can therefore
be written min (IEA, IEB), where IE· is Eve’s information on the raw key of Alice or Bob, that will be defined
more precisely in the next paragraph III.B.2. PA was
first mentioned in (Bennett, Brassard and Robert, 1988),
then established in (Bennett et al., 1995). This reference
has been considered as valid for one decade but, after
the notion of universally composable security was introduced (see II.C.2), it had to be replaced by a generalized
version (Renner and K¨onig, 2005). At the moment of
writing, the only PA procedure that works in a provable
way is the one based on two-universal hash functions36.
35 Note that, I(A : B) being symmetric, there is no difference between direct and reverse reconciliation at the level of EC, as
expected from the nature of the task.
36 A set F of functions f : X → Z is called two-universal if
Pr[f(x) = f(x′)] ≤ |Z1 | for x 6= x′ and f chosen at random
with uniform probability. It is instructive to see why this definition is meaningful for privacy amplification. After EC, Alice
and Bob share the same list of bits x; Eve has an estimate x′ of
this list. For PA, Alice chooses f from the two-universal set and
announces it publicly to Bob. Both Alice and Bob end up with
the shorter key z = f(x); but the probability that Eve’s estimate
z′ = f(x′) coincides with z is roughly 1/|Z|: Eve might as well
choose randomly out of the set Z of possible final keys.
Two-universal hash-functions, e.g. in the form of matrix multiplication, can be implemented efficiently (Carter and Wegman,
1979; Wegman and Carter, 1981). The size of the matrices is
proportional to the length N of the raw key. Against a classical adversary, other extractors exist whose size grows only like
Also, for composability, the protocol must be symmetric
under permutations: in particular, the pairs for the parameter estimation must be chosen at random, and the
hash function has to be symmetric (as it is usually).
In summary, the expression for the secret fraction extractable using one-way classical post-processing reads
r = I(A : B) − min (IEA, IEB) . (21)
b. Remarks on practical EC. As mentioned above, the
performance of EC codes is bounded by Shannon’s mutual information. Practical EC codes however do not
reach up to the Shannon bound. For a priori theoretical
estimates, it is fair to increase the number of bits to be
removed by 10-20%; more precise estimates are available
(L¨utkenhaus, 1999) but ultimately the performance must
be evaluated on each code. We shall take this correction
explicitly into account in Sections IV-VII.
In addition, most of the efficient EC codes that are actually implemented, e.g. Cascade (Brassard and Salvail,
1994), use two-way communication. To fit these two-way
EC codes in the framework of one-way post-processing,
one can give the position of the errors to Eve and treat all
communication as one-way communication (L¨utkenhaus,
1999). Alternatively, one can use encryption of the EC
data, as suggested in (L¨utkenhaus, 1999) and formally
proved in (Lo, 2003).
Note finally that it is not necessary to estimate the
error rate with a small sample of the data: instead, the
parties learn naturally the precise number of errors during the EC procedure.
c. Other forms of post-processing. Bounds can be improved by two-way post-processing, one refers to any possible procedure in which both partners are allowed to
send information. Since its first appearance in QKD
(Chau, 2002; Gisin and Wolf, 1999; Gottesman and Lo,
2003), this possibility has been the object of several studies37. Contrary to the one-way case, the optimal procedure is still not known, basically because of the complexity of taking feedback into account.
More recently, a further trick to improve bounds was
found, called pre-processing: before post-processing, the
sender (for one-way) or both partners (for two-way) can
add locally some randomness to their data. Of course,
log N; but at the moment of writing, it is not known whether
a similar construction exists in the case where the adversary is
quantum (K¨onig and Renner, 2007).
37 We note that some of the security claims in the first paper dealing with advantage distillation (Gisin and Wolf, 1999)
were imprecise. These works have also had an intriguing offspring, the conjecture of the existence of “bound information”
(Gisin and Wolf, 2000), later proved for three-partite distributions (Ac´ın, Cirac and Masanes, 2004).23
this decreases the correlations between them, but it decreases Eve’s information as well, and remarkably the
overall effect may be positive (Kraus, Gisin and Renner,
2005; Renner, Gisin and Kraus, 2005).
Both pre-processing and two-way post-processing are
easy to implement and allow extracting a secret key
in a parameter region where one-way post-processing
would fail; in particular, the critical tolerable error rate
is pushed much higher38. To our knowledge though,
they have been implemented only once in real systems
(Ma et al., 2006). The reason is that, in terms of secret key rate, an improvement can be appreciated only
when the dark counts become dominant39, a regime
in which few systems tend to operate — see however
(Rosenberg et al., 2009; Tanaka et al., 2008; Yuan et al.,
2008). Therefore, in what follows, we shall present only
bounds for one-way classical post-processing without preprocessing.
2. Individual, Collective and Coherent Attacks
As stressed from the beginning (II.C.1), one aims ultimately at proving unconditional security, i.e. security
bounds in the case where Eve’s attack on the quantum
channel is not restricted. Such a lower bound for security
has been elusive for many years (II.A); it has nowadays
been proved for many protocols, but is still missing for
others. In order to provide an ordered view of the past,
as well as to keep ideas that may also be useful in the
future, we discuss now several levels of security.
a. Individual (or incoherent) attacks. This family describes the most constrained attacks that have been studied. They are characterized by the following properties:
(I1) Eve attacks each of the systems flying from Alice to
Bob independently from all the other, and using the
38 The order of magnitude of the improvements is roughly the same
for all examples that have been studied. Consider e.g. BB84
in a single-photon implementation, and security against the
most general attacks: the critical QBER for one-way postprocessing without pre-processing is 11% (Shor and Preskill,
2000); bitwise pre-processing brings this value up to 12.4%
(Kraus, Gisin and Renner, 2005), more complex pre-processing
up to 12.9% (Smith, Renes and Smolin, 2008); two-way postprocessing can increase it significantly further, at least up to
20.0%, but at the expenses of drastically reduced key rate
(Bae and Ac´ın, 2007; Chau, 2002; Gottesman and Lo, 2003). In
weak coherent pulses implementations, pre-processing increases
the critical distance of BB84 and of SARG04 by a few kilometers,
both for security against individual (Branciard et al., 2005) and
most general attacks (Kraus, Branciard and Renner, 2007).
39 Recall that optical error is routinely kept far below 5%; therefore,
the total error rate exceeds ∼ 10% when the error is largely due
to the dark counts.
same strategy40. This property is easily formalized
in the EB scheme: the state of n symbols for Alice
and Bob has the form ρn AB = (ρAB)⊗n.
(I2) Eve must measure her ancillae before the classical
post-processing. This means that, at the beginning
of the classical post-processing, Alice, Bob and Eve
share a product probability distribution of classical
symbols.
In this case, the security bound for one-way postprocessing is the Csisz´ar-K¨orner bound, given by (21)
with
IAE = max
Eve
I(A : E) (individual attacks) (22)
and of course similarly for IBE (Csisz´ar and K¨orner,
1978). Here, I(A : E) is the mutual information between the classical symbols; the notation
maxEve recalls that one must maximize this mutual
information over Eve’s strategies. There is actually an ambiguity in the literature, about the moment where Eve is forced to perform her measurement: namely, whether she is forced to measure immediately after the interaction (Bechmann-Pasquinucci,
2006; Curty and L¨utkenhaus, 2005; L¨utkenhaus, 1996)
or whether she can keep the signals in a quantum
memory until the end of the sifting and error correction phase (Bechmann-Pasquinucci and Gisin, 1999;
Brassard et al., 2000; Bruß, 1998; Cerf et al., 2002;
Fuchs et al., 1997; Herbauts et al., 2008; L¨utkenhaus,
1999; Slutsky et al., 1998). The first case is associated
to the hardware assumption that Eve is restricted not to
have a quantum memory41. The second case is associated to the hardware assumption that Eve cannot perform arbitrary coherent measurements and can be useful
as a step on the way to unconditional security proofs.
However, we stress that the bound for collective attacks
can nowadays be calculated more easily and gives more
powerful results42.
40 We note here that this “same strategy” may be probabilistic
(with probability p1, Eve does something; with probability p2,
something else; etc), provided the probabilities are fixed during
the whole key exchange. Strange as it may seem from the standpoint of practical QKD, an attack, in which Eve would simply
stop attacking for a while, belongs to the family of the most
general attacks!
41 Generalizing (Wang, 2001), it is conjectured that individual attacks should be optimal under the weaker assumption of a quantum memory that would be bounded, either in capacity or in
lifetime; but only rougher bounds have been derived so far
(Damgaard et al., 2005, 2007; K¨onig and Terhal, 2008).
42 At the moment of writing, there is still something that is known
only for individual attacks, and this is Eve’s full strategy; the optimal procedures been found both for the scenario without quantum memory (L¨utkenhaus, 1996) and with it (Herbauts et al.,
2008; L¨utkenhaus, 1999). On the contrary, the bound for collective and coherent attacks is computed by optimizing the Holevo24
An important sub-family of individual attacks are the
intercept-resend (IR) attacks. As the name indicates, Eve
intercepts the quantum signal flying from Alice to Bob,
performs a measurement on it, and conditioned on the result she obtains she prepares a new quantum signal that
she sends to Bob. If performed identically on all items,
this is an individual attack. Moreover, it obviously realizes an entanglement-breaking channel between Alice and
Bob, thus providing an easily computed upper bound on
the security of a protocol (Bechmann-Pasquinucci, 2006;
Curty and L¨utkenhaus, 2005).
b. Collective attacks. This notion was first proposed by
Biham, Mor and coworkers, who proved the security of
BB84 against them and conjectured that the same bound
would hold for the most general attacks (Biham and Mor,
1997; Biham et al., 2002). Collective attacks are defined
as follows:
(C1) The same as (I1).
(C2) Eve can keep her ancillae in a quantum memory
until the end of the classical post-processing, and
more generally until any later time convenient to
her (for instance: if the key is used to encode a
message, part of which is vulnerable to plaintext
attack, Eve may delay her measurement until she
obtains the information coming from this attack).
She can then perform the best measurement compatible with what she knows. In general, this will
be a collective measurement.
Only (C1) is an assumption on Eve’s power. The
generic bound for the secret key fraction achievable using one-way post-processing (Devetak-Winter bound) is
given by (21) with
IAE = max
Eve
χ(A : E) (collective attacks) (23)
and IBE defined in the analog way (Devetak and Winter,
2005). Here, χ(A : E) is the so-called Holevo quantity
(Holevo, 1973)
χ(A : E) = S(ρE) − X
a
p(a)S(ρE|a) (24)
where S is von Neumann entropy, a is a symbol of
Alice’s classical alphabet distributed with probability
p(a), ρE|a is the corresponding state of Eve’s ancilla and
ρE = Pa p(a)ρE|a is Eve’s partial state. The Holevo
quantity bounds the capacity of a channel, in which a
bound over all possible interactions between the signal and Eve’s
ancillae (see below): one implicitly assumes that suitable measurements and data processing exist, which will allow Eve to extract that amount of information. It would be surely interesting
to exhibit explicit procedures also for more general attacks.
classical value (here a) is encoded into a family of quantum states (here, the ρE|a): in this sense, it is the natural
generalization of the mutual information.
As mentioned, it is actually easier to compute (23)
than (22). The reason lies in the optimization of Eve’s
strategy. In fact, the Holevo quantity depends only on
Eve’s states ρE|a, that is, on the unitary operation with
which she couples her ancilla to the system flying to Bob.
In contrast to that, the mutual information depends both
on Eve’s states and on the best measurement that Eve
can perform to discriminate them, which can be constructed only for very specific examples of the set of states
(Helstrom, 1976).
c. General (or coherent) attacks. Eve’s most general strategy includes so many possible variations (she may entangle several systems flying from Alice to Bob, she may
modify her attack according to the result of an intermediate measurement...) that it cannot be efficiently
parametrized. A brute force optimization is therefore
impossible. Nevertheless, as mentioned several times already, bounds for unconditional security have been found
in many cases. In all these cases, it turns out the bound is
the same as for collective attacks. This remarkable result
calls for several comments.
First remark: this result has an intuitive justification.
If the state |Ψ(Sn)i that codes the sequence Sn has the
tensor product form |ψ(s1)i⊗...⊗|ψ(sn)i, then the states
flying from Alice to Bob are uncorrelated in the quantum
channel; therefore Eve does not seem to have any advantage in introducing artificial correlations at this point43.
However, correlations do appear later, during the classical post-processing of the raw key; such that in fact,
the final key is determined by the relations between the
symbols of the raw key, rather than by those symbols
themselves. Thus, Eve must not try and guess the value
of each symbol of the raw key, but rather some relation
between them — and this is typically a situation in which
entanglement is powerful. This vision also clarifies why
unconditional security is still elusive for those protocols,
for which |Ψ(Sn)i is not of the tensor product form (see
VI.A).
Second remark: for BB84, six-state and other protocols, assuming the squashing property of detectors (see IV.A.2), this result is a consequence of
the internal symmetries (Kraus, Gisin and Renner, 2005;
Renner, Gisin and Kraus, 2005). The explicit calculations are given in Appendix A. In a more general framework, the same conclusion can be reached by invoking
the exponential De Finetti theorem (Renner, 2005, 2007).
This theorem says that, after some suitable symmetriza-
43 Of course, one is not saying that Eve does fulfill (I1): Eve can
do whatever she wants; but there exist an attack that fulfills (I1)
and that performs as well as the best possible attack.25
tion, the statistics of the raw key are never significantly
different from those that would be obtained under constraint (I1). This is a very powerful result, but again
does not solve all the issues: for instance, because the actual exponential bound depends on the dimension of the
Hilbert space of the quantum signals, it cannot be applied to continuous-variable QKD (see however the Note
added in proof at the end of this paper). Also recall that
we consider only the asymptotic bound: the finite-key
bounds obtained by invoking the De Finetti theorem are
over-pessimistic (Scarani and Renner, 2008).
3. Quantum side channels and zero-error attacks
The possibility of zero-error attacks seems to be at
odds with the fundamental tenet of QKD, namely that
Eve must introduce modifications in the state as soon
as she obtains some information. However, there is no
contradiction: for instance, in the presence of losses the
quantum signal is also changed between the source and
the receiver. Even if in most protocols (see discussion in
Sec. I.B.3) losses do not lead to errors in the raw key,
some information about the value of the coded symbol
may have leaked to Eve.
Losses are the most universal example of leakage of information in a quantum side-channel, i.e. in some degree
of freedom other than the one which is monitored. We
stress that the existence of side-channels does not compromise the security, provided the corresponding attacks
are taken into account in the privacy amplification.
The beam-splitting (BS) attack translates the fact that
all the light that is lost in the channel must be given to
Eve: specifically, Eve could be simulating the losses by
putting a beam-splitter just outside Alice’s laboratory,
and then forwarding the remaining photons to Bob on a
lossless line. The BS attack does not modify the optical
mode that Bob receives: it is therefore always possible
for lossy channels and does not introduce any error44.
For an explicit computation of BS attacks, see VI.B.
When the signal can consist of more than one photon, Eve can count the number of photons in each signal and act differently according to the result n of this
measurement. Such attacks are called photon-number
splitting (PNS) attacks (Bennett, 1992; Brassard et al.,
2000; Duˇsek, Haderka and Hendrych, 1999; L¨utkenhaus,
2000) and can be much more powerful than the BS
attack. They were discovered as zero-error attacks
against BB84 implemented with weak laser pulses; in
the typical parameter regime of QKD, even the Poissonian photon number distribution can be preserved
(L¨utkenhaus and Jahma, 2002), so that the PNS attack
44 For some sources, this attack simply does not give Eve any information: for a perfect single-photon source, if the photon goes
to Eve, nothing goes to Bob, and viceversa.
cannot be detected even in principle as long as one known
signal intensity is used. To use different intensities in order to detect PNS attacks is the idea behind the decoy
states method (Hwang, 2003; Lo, Ma and Chen, 2005;
Wang, 2005). Also the distributed-phase-reference protocols detect the PNS attacks (Inoue and Honjo, 2005;
Stucki et al., 2005).
Finally, we mention the possibility of attacks based
on unambiguous state discrimination (USD) followed
by resend of a signal (Duˇsek, Jahma and L¨utkenhaus,
2000). These can be part of a PNS attack
(Scarani, Ac´ın, Ribordy and Gisin, 2004) or define an
attack of its own (Branciard et al., 2007; Curty et al.,
2007); they are clearly zero-error attacks and modify the
photon-number statistics in general.
Of course, a quantum side-channel may hide in any imperfect component of the device (e.g., a polarizer which
would also distort the wave function according to the
chosen polarization). The list of the possibilities is unbounded, whence the need for careful testing45.
4. Hacking on Practical QKD
In practical QKD, the security concerns are not limited
to the computation of security bounds for Eve’s action on
the quantum channel. Any specific implementation must
be checked against hacking attacks and classical leakage
of information.
Hacking attacks are related to the weaknesses of an
implementation. A first common feature of hacking attacks is that they are feasible, or almost feasible, with
present-day technology. The best-known example is the
family of Trojan Horse Attacks, in which Eve probes
the settings of Alice’s and/or Bob’s devices by sending some light into them and collecting the reflected
signal (Vakhitov, Makarov and Hjelme, 2001). Actually,
the first kind of hacking attack that was considered is
a form of Trojan Horse that would come for free: it
was in fact noticed that some photon counters (siliconbased avalanche photo-diodes) emit some light at various
wavelengths when they detect a photon (Kurtsiefer et al.,
2001). If this light carries some information about which
detector has fired, it must be prevented to propagate out,
where Eve could detect it. On these two examples, one
sees also the second common feature of all hacking attacks, namely, that once they have been noticed, they
can be countered by adding some component. In all setups where light goes only one way (out of Alice’s lab
and into Bob’s lab), the solution against Trojan Horse
attacks consists in simply putting an optical isolator; in
implementations where light must go both ways (typi-
45 Some very specific protocols and the corresponding security proofs can be made robust against such imperfections
(Ac´ın et al., 2007).26
cally, the Plug & Play setups), the solution is provided
by an additional monitoring detector (Gisin et al., 2006).
Apart from Trojan Horses, other hacking attacks
have been invented to exploit potential weaknesses
of specific implementations, e.g. faked state attacks (Makarov and Hjelme, 2005; Makarov et al., 2006;
Makarov and Skaar, 2008), phase-remapping attacks
(Fung et al., 2007), time-shift attacks (Qi, Fung et al.,
2007; Zhao et al., 2008). It has also been noticed that
a too precise timing disclosed in the Alice-Bob synchronization protocol may disclose information about which
detector actually fired (Lamas-Linares and Kurtsiefer,
2007).
5. A crutch: the “uncalibrated-device scenario”
As stressed, all the errors and losses in the quantum
channel must be attributed to Eve’s intervention. But
in a real experiment, there are errors and losses also inside the devices of the authorized partners. In particular, the detectors have finite efficiency (losses) and dark
counts (errors); these values are known to the authorized
partners, through calibration of their devices. A security
proof should take this fact into account.
The task of integrating this knowledge into security
proofs, however, has proved harder than one might think.
In general, the naive approach, consisting in taking an
attack and removing the device imperfections from the
parameters used in privacy amplification, gives only an
upper bound, even at the level of individual attacks46. In
particular, unconditional security proofs, whenever available, have been provided only under the assumption that
all the losses and all the errors are attributed to Eve and
must therefore be taken into account in privacy amplification. We refer to this assumption as to the uncalibrateddevice scenario, because it all happens as if Alice and
Bob would have no means of distinguishing the losses and
46 Consider a PNS attack (III.B.3) on BB84 implemented with weak
coherent pulses, and focus on the pulses for which Eve has found
n = 2 photons. The obvious PNS attack consists in Eve keeping
one photon in a quantum memory and sending the other one to
Bob, because in this case she obtains full information and introduces no error. But there is no information on non-detected
photons: in particular, if Eve cannot control the losses in Bob’s
apparatus tB and the detector efficiency η, her information rate
on such events will be I2→1+1 = tBη. Now, consider another
strategy: Eve applies a quantum cloner 2 → 3, keeps one photon and sends the other two to Bob. Since no perfect cloning
is possible, this introduces an error ε2 on Bob’s side and Eve’s
information on each detected bit is I(ε2) < 1. But Eve’s information rate is I2→2+1 = [1 − (1 − tBη)2]I(ε2) ≈ 2tBηI(ε2) and can
therefore become larger than I2→1+1. The full analysis must be
done carefully, taking into account the observed total error rate;
in the family of individual attacks, the cloning strategy performs
indeed better than the “obvious” one for typical values of tBη
(Curty and L¨utkenhaus, 2004; Niederberger, Scarani and Gisin,
2005). Note that there is no claim of optimality in this example:
another attack may be found that performs still better.
errors of their devices from those originating in the channel47. These issues have been raised in a non-uniform
way in the literature. Most of the discussions have taken
place for discrete-variable protocols; the security studies of distributed-phase-reference protocols are in a too
early stage, but will surely have to address the question.
The case of CV QKD may prove different because of the
difference in the detection process (homodyne detection
instead of photon counting).
At the moment of writing, the uncalibrated-device scenario is still a necessary condition to derive lower bounds.
In the following sections, we shall work with this scenario.
In IV.C and VII.B.2, we shall compare the best available
lower bounds with the upper bounds obtained with a
naive approach to calibrated devices: we shall show (for
the first time explicitly, to our knowledge) that in some
cases the two bounds coincide for every practical purpose. In VIII.A.2, we summarize the status of this open
problem.
IV. DISCRETE-VARIABLE PROTOCOLS
A. Generic Assumptions and Tools
As argued in Sec. III.B.5, in order to present lower
bounds as they are available today, we work systematically in the uncalibrated-device scenario; paragraph IV.C
will present how to derive an upper bound for calibrated
devices.
1. Photon-number statistics
We suppose that each signal is represented by a diagonal state in the photon-number basis, or in other words,
that there is no phase reference available and no coherence between successive signals48. Thus, Alice’s source
can be described as sending out a pulse that contains n
photons with probability pA(n); Eve can learn n without
modifying the state, so this step is indeed part of the
optimal collective attack (Eve may always choose not to
take advantage of this information).
The statistical parameters that describe a key exchange are basically detection rates and error rates49.
47 The name “uncalibrated-device scenario” is proposed here for the
first time. In the literature, the assumption used to be named
“untrusted-device scenario”; but this name is clearly inadequate
(see II.C.1 for the elements that must be always trusted in a
QKD setup, and VIII.A.3 for those may not be trusted in some
very specific protocols).
48 In some cases like Plug&Play implementations, the randomization of the phase should in principle be ensured actively
(Gisin et al., 2006; Zhao, Qi and Lo, 2008).
49 We assume that these parameters are independent of Bob’s measurements, either because they are really measured to be the
same for all bases (a reasonable case in practice), or because, af27
Here are the main notations:
• R: total detection rate;
• Rn: detection rate for the events when Alice sent
n photons (Pn Rn = R);
• Yn = Rn/R a convenient notation (Pn Yn = 1);
• Rw
n: wrong counts among the Rn;
• εn = Rnw/Rn the error rate on the n photon signals;
• Q = Pn Ynεn the total error rate (QBER).
Concerning photon statistics on Bob’s side, it is important to notice the following. If the channel introduces
random losses, the photons that enter Bob’s device are
distributed according to pBt (k) = Pn≥k pA(n)Cnktk(1 −
t)n−k where Cnk = n!(nk−! k)! is the binomial factor; one
could compute Rn from this value and the details of
the protocol. However, Eve can adapt her strategy to
the value of n, so the photon-number statistics pB(k)
on Bob’s side may be completely different from pBt (k)
(L¨utkenhaus and Jahma, 2002).
2. Qubits and Modes
Many, though not all, security proofs can be obtained
by finding qubit protocols in the optical implementations
that work with optical modes.
a. Sources: Tagging. On the source side, this can be
done by ’tagging’, by assuming that all multi-photon signals (with respect to the total signal) becoming fully
known to an eavesdropper. This leaves us effectively
with qubits, using the single photons and the coding
degree of freedom, for example polarization or relative phase between two modes. This method has been
used in (Inamori, L¨utkenhaus and Mayers, 2001-2007;
L¨utkenhaus, 2000), but the term tagging has been introduced only in (Gottesman, Lo, L¨utkenhaus and Preskill,
2004). Note that security proofs can be done without
this assumptions, e.g. in the case of the SARG protocol.
b. Detectors: Squashing. Detectors act on optical modes,
and typically threshold detectors are used that cannot resolve the incoming photon number. Some security proofs
(Koashi, 2006; Mayers, 1996, 2001) can directly deal with
this situation. In other security proofs one has either to
search through all possible photon number of arriving
signals to prove that it is Eve’s optimal strategy to send
ter the sifting procedure, Alice and Bob forget from which measurement each bit was derived and work with average values.
preferentially single photons to Bob (L¨utkenhaus, 1999).
It was there realized that double clicks in detection devices, resulting from multi-photon signals or dark counts,
cannot be simply ignored, as a security loophole would
open up. 50 As a countermeasure, in (L¨utkenhaus, 1999,
2000) it was introduced to assign double clicks at random
to the values corresponding to single click events.
The concept of squashing, originally introduced in a continuous variable context
(Gottesman and Preskill, 2001), has been coined in
(Gottesman, Lo, L¨utkenhaus and Preskill, 2004), where
it is assumed that the detection device can be described
by a two-step process: in a first step, the optical signal
is mapped (squashed) into a single photon (qubit),
and then the ideal measurement in the qubit description is performed. Only recently, it has been shown
that a squashing model actually exists for the BB84
protocol (Beaudry, Moroder and L¨utkenhaus, 2008;
Tsurumaru and Tamaki, 2008) with the given assignment of double clicks to random single detector clicks.
Actually, in (Beaudry, Moroder and L¨utkenhaus, 2008),
a framework has been developed to find squashing maps
for different detector set-ups, including the implementation of passive basis choice in the BB84 protocols via
a beamsplitter. Note that the existence of a squashing
model should not be taken for granted, as for example
the six-state protocol does not admit a squashing model.
However, a six-state protocol measurement with a
passive basis choice via a linear optics array admits a
squashing model for suitable assignment of multi-clicks.
(Beaudry et al., 2008b).
Note again that it is not necessary to find a squashing model to prove security, but it is certainly an elegant short cut, as now the combination of tagging in the
source and squashing in the detector allows to reduce the
security analysis of QKD to qubit protocols. For the remainder of this review, however, we adopt the squashing
model view.
3. Secret key rate
The bound for the secret fraction is (21). In the case
of the protocols under study, H(A) = H(B) = 1 and
H(A|B) = H(B|A) = h(Q), where h is binary entropy
and Q is the QBER. Therefore I(A : B) = 1 − h(Q).
However, we want to provide formulas that take imper-
50 A simple attack exploiting this loophole goes as follows: Eve performs an intercept/resend attack and resend a pulse containing
a large number of photons in the detected polarization. If Bob
measures in the same basis as Eve, he will receive a single detector click, about which Eve has full information. If Bob measures
in a different basis, he will receive almost always double clicks,
which he would discard. Therefore Eve has perfect information
about all signals retained by Eve, allowing her to break the QKD
scheme.28
fect error correction into account. Therefore we shall use
K = R [1 − leakEC(Q) − IE] (25)
with leakEC(Q) ≥ h(Q) and IE = min (IAE, IBE). Let
us study this last term. Eve gains information only on the
non-empty pulses, and provided Bob detects the photon
she has forwarded. Since, due to the squashing model,
the exponential De Finetti theorem applies to discretevariable protocols (see discussion in Sec. III.B.2), and
since the optimal collective attack includes the measurement of the number of photons, the generic structure for
the Eve’s information reads51
IE = max
Eve X
n
Yn IE,n (26)
where, as usual, the maximum is to be taken on all Eve’s
attacks compatible with the measured parameters.
B. BB84 coding: lower bounds
In the BB84 coding, the probability that Bob accepts
an item depends only on the fact that he has used the
same basis as Alice, which happens with probability psift.
Therefore, writing ˜ νS = νS psift, we have
Rn = ˜ νS pA(n)fn (27)
where fn is the probability that Eve forwards some signal to Bob for n-photon pulses. Eve’s attack must be
optimized over the possible {fn}n≥0 compatible with
Pn Rn = R. Now we consider different implementations
of this coding.
1. Prepare-and-Measure: Generalities
In P&M BB84, IAE = IBE. On the events when Alice sends no photons (n = 0) but Bob has a detection,
the intuitive result IE,0 = 0 (Lo, 2005) has indeed been
proved (Koashi, 2006b). On the single-photon pulses,
Eve can gain information only at the expense of introducing an error ε1; the maximal information that she can
obtain this way is IE,1 = h(ε1) where h is binary entropy
(Shor and Preskill, 2000). A possible demonstration of
this well-known result is given in Appendix A. For multiphoton pulses, the best attack is the PNS attack in which
Eve forwards one photon to Bob and keeps the others: i.e.
for n ≥ 2, εn = 0 and IE,n = 1 (Fung, Tamaki and Lo,
51 More explicitly, this formula should read IE = min (IAE, IBE)
with IAE = maxEve Pn Yn IAE,n and similarly for IBE.
In the development of QKD, this formula was derived first
for BB84 (Gottesman, Lo, L¨utkenhaus and Preskill, 2004), then
for SARG04 (Fung, Tamaki and Lo, 2006), then generalized
to all discrete-variable protocols (Kraus, Branciard and Renner,
2007).
2006; Gottesman, Lo, L¨utkenhaus and Preskill, 2004;
Kraus, Branciard and Renner, 2007). Therefore (26) becomes
IE = max
Eve
Y1h(ε1) + 1 − Y0 − Y1
= 1 − min
Eve
{Y0 + Y1[1 − h(ε1)]} . (28)
2. P&M without decoy states
In P&M schemes without decoy states, the only measured parameters are R and Q. We have to assume
εn≥2 = 0; therefore we obtain ε1 = Q/Y1. From this and
(28), we see52 that Eve’s optimal attack compatible with
the measured parameters is the one which minimizes Y1,
a situation which is obviously achieved by setting f0 = 0
and fn≥2 = 1. One finds then
Y1 = 1 − (˜ νS/R)pA(n ≥ 2). (29)
As a conclusion, for BB84 in a P&M scheme without
decoy states, the quantity to be subtracted in PA is
IE = 1 − Y1[1 − h(Q/Y1)] ; (30)
the corresponding achievable secret key rate (25) is
K = R [Y1 (1 − h(Q/Y1)) − leakEC(Q)] (31)
where Y1 is given in (29). As expected, K contains only
quantities that are known either from calibration or from
the parameter estimation of the protocol (R, Q).
3. P&M with decoy states
The idea of decoy states is simple and deep. Alice
changes the nature of the quantum signal at random
during the protocol; at the end of the exchange of quantum signals, she will reveal which state she sent in each
run. This way, Eve cannot adapt her attack to Alice’s state, but in the post-processing Alice and Bob
can estimate their parameters conditioned to that knowledge. The first proposal using one- and two-photon signals (Hwang, 2003) was rapidly modified to the more
realistic implementation in which Alice modulates the
intensity of the laser (Lo, Ma and Chen, 2005; Wang,
2005). As we mentioned, several experiments have already been performed (Ma et al., 2006; Peng et al., 2007;
Rosenberg et al., 2007; Yuan, Sharpe and Shields, 2007;
Zhao et al., 2006), more recently even including finitekey effects (Hasegawa et al., 2007).
Let ξ be some tunable parameter(s) in the source, the
typical example being ξ = µ the intensity (mean photonnumber) of a laser. Alice changes the value of ξ randomly
52 First proved in (Inamori, L¨utkenhaus and Mayers, 2001-2007) in
the context of unconditional security.29
from one pulse to the other; at the end of the exchange of
quantum signals, Alice reveals the list of values of ξ ∈ X,
and the data are sorted in order to estimate the parameters separately for each value. With this simple method,
Alice and Bob measure 2|X | parameters, namely the Rξ
and the Qξ.
The set X is publicly known as part of the protocol; but
if |X | > 1, Eve cannot adapt her strategy to the actual
value of ξ in each pulse, because she does not know it.
Therefore, fn and εn are independent of ξ; in particular,
Rξ
n = ˜ νS pA(n|ξ)fn. The measured parameters
Rξ = X
n≥0
Rξ
n and Qξ = X
n≥0
Rξ
n
Rξ εn (32)
define a linear system with 2|X | equations for the fn and
the εn. The optimization in (28) must then be performed
using the lower bounds for Y1ξ and the upper bound for
ε1 as obtained from the measured quantities {Rξ, Qξ}ξ∈X
(Tsurumaru, Soujaeff, Takeuchi, 2008). In practice, the
meaningful contributions are typically the n = 0, 1, 2
terms, and a decoy-state protocol with |X | = 3 reaches
very close an exact determination (Hayashi, 2007b). For
simplicity, here we suppose that all the fn and εn have
been determined exactly53. Also, we consider a protocol
in which the classical post-processing that extracts a key
is done separately on the data that correspond to different ξ. For each ξ, the quantity to be subtracted in PA
is54
Iξ
E = 1 − Y0ξ − Y1ξ[1 − h(ε1)] (33)
with Y ξ
0,1 = R0ξ,1/Rξ and the corresponding achievable
secret key rate is
Kξ = Rξ hY0ξ + Y1ξ (1 − h(ε1)) − leakEC(Qξ)i .(34)
The total secret key rate is K = P′ξ Kξ, where the sum
is taken on all the values of ξ such that Kξ ≥ 0. If
the classical post-processing were done on the whole raw
key, the total secret key rate would read K = R[1 −
leakEC(Q)] − Pξ RξIEξ . The two expressions coincide if
there exists a ξ which is used almost always.
4. P&M: analytical estimates
Alice and Bob can optimize K by playing with the parameters of the source, typically the intensity. A rigorous
optimization can be done only numerically. In this paragraph, we re-derive some often-quoted results for P&M
53 As a side remark: one might find εn≥2 > 0, but this does not
modify the discussion in Sec. IV.B.1 about the optimal attack.
Indeed, Eve might have performed the attack that gives εn≥2 =
0, then added some errors “for free”.
54 Note the presence of Y0ξ in the next two equations.
implementations of BB84. For this a priori estimate, one
has to assume that some “typical” values for the Rn and
the Qn will indeed be observed. As stressed above, security must be based on the actually measured values:
what follows provides only guidelines to start working
with the correct orders of magnitude. Here, we chose to
work in a regime in which the rate of detection of true
photons is much larger than the dark count rate. For
simplicity, we also assume optimal error correction, so
that leakEC(Q) = h(Q).
The reference case is the case of single-photon sources,
for which the meaningful scheme is P&M without decoy
states. For this source, pA(1) = 1 therefore Y1 = 1; the
expected detection rate is R = ˜ νSt tBη, and Eq. (31)
yields immediately
K ≈ ν˜St tBη [1 − 2h(Q)] (single photon). (35)
As expected, K scales linearly with the losses in the line
and the efficiency of the detector.
The most widespread source in P&M schemes are attenuated lasers. The estimate can be made by considering only the single-photon and the two-photon emissions: pA(1) = µe−µ, pA(2) = µ2e−µ/2. The expected
detection rate is R = ˜ νSµt tBη. The important feature,
which is absent in the study of single-photon sources, is
the existence of an optimal value for the intensity µ, a
compromise between a large R and a small pA(2). We
focus first on implementations without decoy states. We
can set pA(1) ≈ µ and pA(2) ≈ µ2/2, but still, the optimal value of µ cannot be estimated exactly in general, because Y1 = 1 − 2t tµBη depends on µ and appears in a non-algebraic function. Let us then consider first the limiting case Q = 0: Eq. (31) becomes
K/ν˜S ≈ µt tBη −µ2/2, whose maximal value is 12(t tBη)2
obtained for µ0 = t tBη (L¨utkenhaus, 2000). To obtain
estimates for the Q > 0 case, we can make the approximation of using µ0 to compute Y1, i.e. to set Y1 = 12.
Then, the optimization of Eq. (31) is also immediate:
writing F(Q) = 1−h(2Q)−h(Q), the highest achievable
secret key rate is
K
ν˜St tBη
≈
1 2
µopt F(Q) (laser, no decoy) (36)
obtained for the optimal mean photon number
µopt ≈ t tBη
F(Q)
1 − h(2Q) . (37)
Let us now perform the estimate for an implementation using decoy states. The decoy consists in varying
the intensity of the laser from one pulse to the other,
so that the general parameter ξ is in fact µ. We suppose that a given value µ is used almost always (and
this one we want to optimize), while sufficiently many
decoy values are used in order to provide a full parameter estimation. The expected values are Rµ = ˜ νSµt tBη,
Rµ
1 = ˜ νSµe−µt tBη and ε1 = Q. Inserted into Eq. (34),30
one obtains K ≈ ν˜Sµt tBη[e−µ(1 − h(Q)) − h(Q)]; using
e−µ ≈ 1 − µ, this expression reaches the maximal value
K
ν˜St tBη
≈
1 2
µopt [1 − 2h(Q)] (laser, decoy) (38)
for the optimal mean photon number
µopt ≈
1 2
1 − 1 −h(hQ()Q) . (39)
Let us summarize. Without decoy states, µopt ∼ t and
consequently K ∝ t2: the larger the losses, the more
attenuated must the laser be. The reason are PNS attacks: Alice must ensure that Eve cannot reproduce the
detection rate at Bob’s by using only photons that come
from 2-photon pulses (on which she has full information).
With decoy states, one can determine the fraction of
detections that involve photons coming from 2-photon
pulses; if this fraction is as low as expected, one can exclude a PNS attack by Eve — as a benefit, the linear
scaling K ∝ t is recovered. This is the same scaling obtained with single-photon sources, with the obvious benefit that lasers are much more versatile and well-developed
than strongly sub-Poissonian sources. Another interesting remark is that, both with and without decoy states,
µopt ≈ 1 2µcrit, where the critical value µcrit is defined as
the one for which K ≈ 0. In other words, an intensity
double than the optimal one is already enough to spoil all
security. In implementations without decoy states, where
µ decreases with t, this calibration may be critical at long
distances.
5. Entanglement-Based
If Alice holds the down-conversion source, as is the
case in almost all the EB QKD experiments performed
to date55, an EB scheme is equivalent to a P&M one (see
II.B.2) so the corresponding security proofs could be applied. The only specific difference to address concerns
the events in which more than one pair is produced inside a coincidence window. As described in Sec. II.E.3,
two kinds of such contributions exist and Eve is able to
distinguish between them:
• A fraction of the multi-pair events contain partial
correlations in the degrees of freedom used for symbol encoding; thus, Eve can get information on the
key bit by some form of PNS attacks. This situation is similar to the multi-photon case in P&M
schemes, although here it is difficult to determine
exactly the amount of information that leaks out.
55 We are aware of a single case, in which the source was in the
middle (Erven et al., 2008). As we shall discuss below in this
paragraph, security proofs have been provided also for this situation.
To be on the safe side we will suppose that Eve can
obtain full information without introducing any errors.
• The other, usually much larger fraction of multipair events consists of independent uncorrelated
pairs. In this case Eve cannot obtain any information on Bob’s symbol using the PNS attack. She
can only apply “standard” single particle attack.
We suppose that Eve can somehow find out which
one of multiple pairs were selected by Alice’s detector, so we treat all such multi-pair contributions as
if they were single pairs.
Therefore Eq. (28) is replaced by
IE ≤ Ym′ + Y1′ h YQ1′  , (40)
where Y1′ is the fraction of single-pair plus uncorrelated
multi-pair events and Ym′ is the fraction of multi-pair
events which are (partially) correlated in the degree of
freedom the information is encoded in. Explicitly,
Y ′
m = pA(n ≥ 2)ν˜S
R
ζ (41)
with ζ being the ratio of the number of partially correlated multi-pair contributions to all multi-pair contributions (see Sec. II.E.3). In total Ym′ +Y1′ = 1. Finally, the
achievable secret-key rate reads
K = R [Y1′ (1 − h(Q/Y1′)) − leakEC(Q)] . (42)
Recall that these formulas apply to implementations, in
which the source is safe on Alice’s side. Notice also that
two different sorts of multi-pair contributions are considered and for each of them different eavesdropping strategy is assumed. However, in reality there is a smooth
transition between correlated and uncorrelated pairs. All
multi-pair events which exhibit non-negligible correlations must be counted as correlated.
Recently security has been demonstrated also for EB
systems, in which the source is under Eve’s control
(Ma, Fung and Lo, 2007). The authors describe the conditions, under which the whole object “Eve’s state preparation and Alice’s measurement” behaves like an uncharacterized source in the sense of Koashi and Preskill
(Koashi and Preskill, 2003). Alice has a box where she
can dial a basis and gets an information bit from her box
indicating which signal (0 or 1) was sent. Whatever state
Eve prepares, when she gives one part into Alice’s box
and Alice chooses a measurement, then the average density matrix outside this box is independent of this choice
(assuming that the no-click event probability is basis independent).56 On Alice’s side no Hilbert space argument
56 This is clearly true for an active basis choice. In case of the passive basis selection some additional assumptions on the detection
may be necessary.31
is needed, but on Bob’s side the squshing property of the
detection is required (see IV.A.2). The formula for the
achievable secret-key rate then reads
K = R [1 − h(Q) − leakEC(Q)] . (43)
Formally, this is the same as obtained in a P&M scheme
using single photons [Eq. (31) with Y1 = 1]. As such,
it is a remarkable result: it states that, under the assumptions listed above, all the deviations from a perfect
two-photon source — in particular, the presence of multiphoton components — are taken care of by measuring the
error rate Q (Koashi and Preskill, 2003). Besides, it has
been found that the EB QKD can tolerate higher losses
if the source is placed in the middle between Alice and
Bob rather than if it is in Alice’s side (Ma, Fung and Lo,
2007; Waks, Zeevi and Yamamoto, 2002).
Finally, we note that very recently another proof of the
security of entanglement-based systems with real detectors was proposed, that does not rely on the squashing
property but rather on the measurement of the doubleclick rate (Koashi et al., 2008).
C. BB84 coding: upper bounds incorporating the
calibration of the devices
As explained in Sec. III.B.5, the bounds for unconditional security are always found for the uncalibrateddevice scenario, which is over-pessimistic. It is instructive to present some upper bounds that take the calibration of the devices into account: the comparison between
these and the lower bounds will determine the “realm of
hope”, i.e. the range in which improvements on K may
yet be found. Clearly, the contribution leakEC(Q) of error correction is independent of the scenario: one has to
correct for all the errors, whatever their origin. The difference appears in the quantity to be removed in privacy
amplification.
1. Statistical parameters
In order to single out the parameters of the devices,
one has first to recast the general notations (IV.A.1) in
a more elaborated form. The detection rates must be
explicitly written as
Rn = Rn,p + Rn,d (44)
where R
n,p is the contribution of detections and Rn,d is
the contribution of dark counts. Since Eve can act only
on the first part, it is convenient to redefine Yn = Rn,p/R,
so that Pn Yn ≡ Y < 1. The errors on the line εn are
introduced only on the photon contribution, while the
dark counts always give an error rate of 12; therefore the
total error is
Q = Y ε + δ (45)
where ε = Pn≥1 YYn εn and δ = 1−2Y .
Note that the content of this paragraph is not specific
to BB84; but all that follows is.
2. Upper bounds
To derive an upper bound, we use a simple recipe,
which consists in following closely the calculations of the
previous subsection IV.B and just making the necessary
modifications, although this is known to be sub-optimal
and no squashing model is known in this situation to justify the assumption. In particular, Eve is still supposed
to forward to Bob at most one photon, although this is
known to be sub-optimal. Therefore
R
n,p = ˜ νSpA(n)fn tBη (46)
Rn,d = ˜ νSpA(n)(1 − fn tBη)2pd (47)
where pd is the dark count rate. Note the presence of
tBη in these formulas: the detector efficiency has not
been incorporated into fn. Extracting fn tBη from these
equations, one finds
Y = (1 − 2pdν˜S/R)/(1 − 2pd) (48)
which means that the ratio between detections and dark
counts depends only on the total detection rate R. Also,
for our simple recipe, it is immediate that the modification of the general expression (28) reads
IE = max
Eve
Y1h(ε1) + Y − Y1
= Y − min
Eve
Y1[1 − h(ε1)] . (49)
We restrict now to the P&M schemes. In the implementation with decoy states, the Yn and the εn are known,
so the only difference with the uncalibrated-device formula (34) is the role of dark counts:
Kξ = Rξ hY1ξ (1 − h(ε1)) + 2δξ − leakEC(Qξ)i(50)
where Y0 is replaced by the very slightly larger term57
2δξ = 1−Y ξ. Things are different for the implementation
without decoy states, because now Y1 and ε1 are not directly measured, only R and Q are. Since we are supposing that the optimal strategy is still such that εn≥2 = 0
and fn≥2 = 1, we have
Y1 = Y − tBην˜S
R
pA(n ≥ 2) and ε1 = Q − δ
Y1
.(51)
57 In the notation of this paragraph, the previous Y0 would read
R0/R = R0,d/R; while 2δ = Pn≥0 Rn,d/R. Note that, strictly
speaking, R0 = R0,d is an assumption: a priori, one can imagine
that Eve creates some photons to send to Bob also when Alice is
sending no photons — but we don’t consider here such a highly
artificial situation.32
Note that Y1 can be significantly larger than in the
uncalibrated-device scenario, eq. (29): in fact, although
Y is slightly smaller than one, the term to be subtracted
is multiplied by tBη. This difference is specifically due
to the fact that Eve is not supposed to influence the efficiency of the detector. Finally, one obtains
K = R [Y1 (1 − h(ε1)) + 2δ − leakEC(Q)] (52)
with the expressions (51) and with 2δ = 1 − Y .
D. Bounds for the SARG04 coding
We sketch here the analysis of SARG04 because it contains a certain number of instructive differences with respect to BB84. Here we note ˜ νS = νS/2 because Bob
must always choose the bases with probability 12, even
if Alice would almost always use the same set of states.
The raw key rates are different from those of BB84. For
definiteness, suppose that Alice send | + xi, so the bit is
accepted if Bob finds “−”. If Bob measures X, he accepts the bit only if he obtains “−”, but this can only
be due to an error. We write Rw
n = ˜ νSpA(n)fn ε˜n where
the relation of ˜ εn to the induced error rate εn will be
computed just below. If Bob measures Y , he gets “−” in
half of the cases58 and the bit value is correct. So
Rn = ˜ νSpA(n)fn1 2 + ˜ εn. (53)
We see that the detection rate increases in the presence
of errors, contrary to BB84 where the detection rate is
determined only by psift. The error rate is
εn =
ε˜n
12
+ ˜ εn
: (54)
for a given perturbation ˜ εn in the quantum channel, the
error introduced in SARG04 is roughly twice the error
εn = ˜ εn which would be introduced in BB84.
The protocol can be analyzed following the same pattern as the one presented for BB84. Here we just review
the main results:
• SARG04 was invented as a method to reduce the
effect of PNS attacks, taking advantage of the fact
that Eve cannot extract full information from the
2-photon pulses (Ac´ın, Gisin and Scarani, 2004;
Scarani, Ac´ın, Ribordy and Gisin, 2004). This initial intuition has been confirmed by all subsequent,
more rigorous studies. In particular, it was proved
58 As such, this statement contains an assumption on Eve’s attack,
namely Tr[σyρ(±x)] = 0 where ρ(±x) is the state received by
Bob after Eve’s intervention, when Alice has sent | ± xi. But
the result holds in general for the average detection rate, if Alice
prepares all four states with equal probability.
that a fraction of fully secure secret key can be extracted from the 2-photon pulses (Tamaki and Lo,
2006), and that in implementations using weak coherent lasers and without decoy states, for small
error rate SARG04 performs indeed better than
BB84 and shows a scaling ∼ t3/2 as a function of
the distance (Branciard et al., 2005; Koashi, 2005;
Kraus, Branciard and Renner, 2007).
• In the literature one finds the claim that, when
implemented with decoy states, SARG04 performs
worse than BB84 (Fung, Tamaki and Lo, 2006;
Kraus, Branciard and Renner, 2007). This must
be properly understood: decoy states are a method
to gain additional knowledge on Eve’s attack. If
this method does not reveal any PNS attack (as
it will be the case in most experiments, because
losses appear random and therefore Eve is acting
as a beam-splitter), indeed the BB84 rate is better
than the one of SARG04. However, if one would
find that Eve is actually performing a PNS attack,
SARG04 would of course be more robust, consistently with what we wrote in the previous item.
• An interesting case arises if one considers implementations with single-photon sources. The
first unconditional security bound yielded that
SARG04 tolerates a smaller QBER than BB84
(Tamaki and Lo, 2006). But this bound was improved shortly later: the optimal IE,1, which is
not known analytically but can easily be computed numerically, goes to zero for ε1 ≈ 11.67%
(Kraus, Branciard and Renner, 2007). This improved value is slightly better than the corresponding value for BB84, ε1 ≈ 11.0%: it seems therefore
that SARG04 would perform better than BB84 also
in a single-photon implementation. The picture is
however different if one relates the error rate to the
parameters of the channel, typically the visibility
of interference fringes: this parameter is related to
the ones introduced here through ˜ ε1 = 1−2V . For
BB84, ˜ ε1 = ε1 and consequently the critical visibility is V ≈ 78%; while for SARG04, because of (54),
the critical visibility is worse, namely V ≈ 87%.
V. CONTINUOUS-VARIABLE PROTOCOLS
A. Status of security proofs
In the case of Gaussian modulation, security has been proved against collective attacks (Garc´ıa-Patr´on and Cerf, 2006;
Navascu´es, Grosshans and Ac´ın, 2006). We shall
present this bound below (V.B) and use it for the
comparison with the other platforms (VII). There is
some hope that the same bound would hold also for the
most general attack, as it is the case for discrete-variable
systems: in particular, we note that the “intuitive”33
reason behind that equivalence (III.B.2) would apply
also to CV protocols. Unfortunately, the exponential de
Finetti bound (Renner, 2007) does not help because it
explicitely depends on the dimension of the quantum
signals. On this issue, see Note add in proof at the end
of this paper.
In the case of discrete modulation, the security status
is even less advanced. Technically, the difficulty lies in
the fact that the raw key is made of discrete variables
for Alice, while Bob has a string of real numbers. A
full analysis has been possible only in the case where the
quantum channel does not add excess noise to the signal,
so that the observed conditional variances still describe
minimum uncertainty states. In this case, the eavesdropper’s attack is always describable as a generalized beamsplitting attack, simulating the observed loss. The corresponding key rates depend on the classical communication protocols chosen (with or without post-selection of
data, in reverse or direct reconciliation); the best known
protocol involves a combination of post-selection and reverse reconciliation, especially when the error correction
algorithms work away from the asymptotic Shannon efficiency (Heid and L¨utkenhaus, 2006). In the presence of
excess noise, the formula for the key rate is the object of
ongoing research; it has at least been possible to derive
entanglement witnesses (Rigas, G¨uhne and L¨utkenhaus,
2006). Entanglement verification has been performed
and has shown that excess noise in typical installations
does not wipe out the quantum correlation within the
experimentally accessible domain (Lorenz et al., 2006).
Finally, in all works on CV QKD with no exception,
it has been assumed that Eve does not act on the local
oscillator59 — of course, she is allowed to have access
to it in order to measure quadratures. Since the local
oscillator travels through Eve’s domain, this assumption
opens a security loophole60. Note that a similar situation
burdened until very recently the security of Plug&Play
configurations, for which finally unconditional security
could be proved (see II.H.2); it is not clear however that
the same approach will work here, since the strong pulses
have very different roles in the two schemes. In any case,
the open issue just discussed, together with the fact that
the existing exponential de Finetti theorem does not apply to infinitely-dimensional systems, are the main rea-
59 This amounts at viewing the local oscillator as an authenticated
channel, building on the closeness to classical signals. In an alternative set-up, this problem can be circumvented by Bob measuring the phase of the local oscillator, followed by the recreation
within Bob’s detector of a local oscillator with the measured
phase (Koashi, 2004).
60 For the setups as they have been implemented, all observed correlations are compatible with an intercept/resend attack involving both the signal and the local oscillator. Security against
this specific attack can be easily recovered by simple modifications of the setups, for example the independent measurement
of the intensity of the phase reference pulse and the signal pulse
(H¨aseler, Moroder and L¨utkenhaus, 2008).
sons unconditional security proofs are not available yet
for CV QKD.
As mentioned earlier (II.D.3), continuous variable
protocols show interesting features also on the classical
part. In contrast to typical discrete variable protocols,
where losses simply reduce the number of detected
signals, continuous variable protocols will always detect
a result, so that loss corresponds now to increased noise
in the signal. Two main methods have been formulated to deal with this situation at the protocol level:
reverse reconciliation (Grosshans and Grangier, 2002a)
and post-selection (Silberhorn et al., 2002). The first
method can be realized using one-way EC schemes, but
turns out to be sensitive to the efficiency of those very
schemes. Its main advantage is that its security can be
rigorously assessed versus general collective attacks (and
has been conjectured to hold even for coherent attacks)
In contrast, the second method can use both one-way and
two-way EC schemes, and is fairly stable even if those
schemes do not perform at the Shannon limit. However,
its security can be analyzed only by making assumptions
on Eve’s interception (see below). The status of its
security is not clear even for general individual attacks.
Note that for close-to-perfect EC, reverse reconciliation
outperforms post-selection. While progress is being
made in the efficiency of EC schemes, it turns out that
a combination of post-selection and reverse reconciliation provides a practical solution to obtain reasonable
rates with current technology, both for discretemodulation (Heid and L¨utkenhaus, 2006) and for
Gaussian-modulation protocols (Heid and L¨utkenhaus,
2007).
B. Bounds for Gaussian protocols
1. Generalities
As announced, we provide an explicit security
bound for coherent-state homodyne-detection protocol
of (Grosshans and Grangier, 2002a). Like all Gaussian protocols, this prepare-and-measure protocol can be
shown to be equivalent to an entanglement-based scheme
(Grosshans, Cerf et al., 2003). In such a scheme, Alice
prepares an EPR state — more precisely, the two-mode
squeezed vacuum state (15). By applying an heterodyne
measurement on mode A, she prepares in the second
mode of the EPR pair a coherent state, whose displacement vector is Gaussian distributed in x and p. Then,
Bob applies a homodyne measurement on mode B, measuring quadrature x or p. It can be shown that reverse
reconciliation is always favorable for Alice and Bob, so
we have to compute Eq. (21) with IEB on the right hand
side.
It has been proved that Eve’s optimal attack is Gaussian for both individual
(Garc´ıa-Patr´on, 2007; Grosshans and Cerf, 2004;
Lodewyck, Debuisschert et al., 2007) and col34
lective attacks (Garc´ıa-Patr´on and Cerf, 2006;
Navascu´es, Grosshans and Ac´ın, 2006). We can therefore assume that Eve effects a Gaussian channel, so
that the quantum state ρAB just before Alice and
Bob’s measurements can be assumed to be a Gaussian
two-mode state with zero mean value and covariance
matrix γAB.
The Gaussian channel is characterized by two parameters: the transmittance, which here, since we work in the
uncalibrated-device scenario, is tη with η the efficiency
of the detectors; and the noise δ referred to the input of
the channel61. Since the two-mode squeezed state (15)
is also symmetric and has no correlations between x and
p, the resulting covariance matrix of modes A and B can
be written in a block-diagonal form,
γAB =
γAB x 0
0 γAB p ! (55)
with
γ
x(p)
AB =
v ±ptη(v2 − 1)
±ptη(v2 − 1) tη(v + δ) ! (56)
where the signs + and − correspond to γAB x and γAB p ,
respectively. Here, v is the variance of both quadratures
of Alice’s output thermal state expressed in shot-noise
units, that is, v = vA+1, vA being the variance of Alice’s
Gaussian modulation.
For what follows, it is convenient to define vX|Y , the
conditional variance that quantifies the remaining uncertainty on X after the measurement of Y :
vX|Y = hx2i − hxyi2/hy2i, (57)
expressed in shot-noise units.
2. Modeling the noise
The noise δ is the total noise of the channel Alice-Bob.
It can be modeled as the sum of three terms:
δ = 1 − t
t
+
δh
t
+ ǫ . (58)
The first term (1−t)/t stands for the loss-induced vacuum
noise (referred to the input); this term is at the origin
of the higher sensitivity to losses of continuous-variable
QKD. The second term stands for the noise added by the
imperfection of the homodyne detection. This is modeled
by assuming that the signal reaching Bob’s station is attenuated by a factor η (detection efficiency) and mixed
61 The observed noise in channels such as optical fibers is typically
symmetric and uncorrelated in both quadratures x and p (there
is no preferred phase), so we restrict to this case here.
with some thermal noise vel (electronic noise of the detector), giving62
δh = 1 + vel
η
− 1 . (59)
The third term ǫ is the excess noise (referred to the input) that is not due to line losses nor detector imperfections. For a perfect detector, it can be viewed as the
continuous-variable counterpart of the QBER in discretevariable QKD; it is zero for a lossy but noiseless line.
3. Information Alice-Bob
In the EB version of the coherent-state protocol considered here (Grosshans and Grangier, 2002a), Alice performs heterodyne detection, so her uncertainty on Bob’s
quadratures is expressed as
vB|AM = tη(δ + 1). (60)
The mutual information between Alice and Bob is therefore given by
I(A : B) = 1
2
log2 vBv|BAM  = 1 2 log2 δδ ++ 1 v .(61)
As mentioned above, the main bottleneck of continuousvariable QKD schemes comes from the heavy postprocessing that is needed in order to correct the errors
due to the vacuum noise that is induced by the line losses.
In practice, the amount of information left after error
correction will be a fraction β of I(A : B). This value
has an important effect on the achievable secret key rate
and the limiting distance (as we shall discuss below, for
β = 1 a secure key can in principle be extracted for arbitrarily large distances). This provides a strong incentive for developing better reconciliation algorithms. The
first technique that was proposed to perform continuousvariable error correction relied on a so-called “sliced
reconciliation” method (Van Assche, Cardinal and Cerf,
2004), and gave an efficiency β ≈ 80%. These algorithms have been improved by using turbo-codes
(Nguyen, Van Assche and Cerf, 2004) and low-density
parity codes (LDPC) (Bloch et al., 2005), which both
allow to work with noisy data, hence longer distances.
More recently, multi-dimensional reconciliation algorithms have been introduced, which allow to deal with
even noisier data while keeping similar or higher reconciliation efficiencies (Leverrier et al., 2008).
62 Replacing the expression for δh into (58), one obtains δ = (1 −
tη + vel)/(tη) + ε, which depends only on tη as it should in the
uncalibrated-device scenario.35
4. Individual attacks
To become familiar with the security analysis, we first
present individual attacks. In order to address the security of the protocol, we assume as usual that Eve holds
the purification of ρAB. Then, by measuring their systems, Alice and Eve project Bob’s share of the joint pure
state |ΨABEi onto another pure state (we may assume
without loss of generality that Eve’s projection results
from a rank-one POVM). Applying the Heisenberg uncertainty relation on the pure state held by Bob conditionally on Alice and Eve’s measurements, we have
vXB|E vPB|A ≥ 1, vPB|E vXB|A ≥ 1, (62)
where XB and PB are the canonically conjugate quadratures of Bob’s mode. Equation (62) can be written as a
single uncertainty relation
vB|E vB|A ≥ 1 (63)
where B stands for any quadrature of Bob’s mode. This
inequality can be used to put a lower bound on the uncertainty of Eve’s estimate of the key in reverse reconciliation, that is, when the key is made out of Bob’s data
while Alice and Eve compete to estimate it.
Now, vB|A is not necessarily given by (60): Eve’s attack cannot depend on how the mixed state sent by Alice (i.e., the thermal state) has been prepared, since all
possible ensembles are indistinguishable. An acceptable
possibility is Alice performing homodyne measurement,
or, equivalently, preparing squeezed states just as in the
protocol of (Cerf, L´evy and Van Assche, 2001); in which
case we obtain
vB|A = tη(δ + 1/v). (64)
It can be shown that this is the lowest possible value of
vB|A, hence from (63)
vB|E ≥
1
tη(δ + 1/v) . (65)
This gives a bound for I(B : E), so the extractable secret key rate under the assumption of individual attacks
becomes
r = I(A : B) − I(E : B) = 1
2
log2 vvBB|A|EM 
≥
1 2
log2 (tη)2(δ + 11/v)(δ + 1) (66)
as shown in (Grosshans, Van Assche et al., 2003). Note
that the scheme that implements the optimal attack (saturating this bound) is the entanglement cloner defined in
(Grosshans and Grangier, 2002b). Using Eq. (58), it appears that in the case of high losses (tη → 0) and large
modulation (v → ∞), the secret key rate r remains nonzero provided that the excess noise satisfies ǫ < 1/2. This
is a remarkable result, due to reverse reconciliation: for
direct reconciliation, obviously there can be no security
when Eve has as much light as Bob, i.e. for tη ≤ 1 2.
A similar reasoning can be followed to derive the security of all Gaussian QKD protocols against individual
attacks (Garc´ıa-Patr´on, 2007). The only special case concerns the coherent-state heterodyne-detection protocol,
whose security study against individual attacks is more
involved (Lodewyck and Grangier, 2007; Sudjana et al.,
2007).
5. Collective attacks
The security of the coherent-state homodyne-detection
scheme against the class of collective attacks has
been fully studied. The corresponding rates were
first provided assuming that Eve’s collective attack
is Gaussian (Grosshans, 2005; Navascu´es and Ac´ın,
2005). Later on, it was proved that this choice
is actually optimal (Garc´ıa-Patr´on and Cerf, 2006;
Navascu´es, Grosshans and Ac´ın, 2006). This implies
that it remains sufficient to assess the security against
Gaussian collective attacks, which are completely characterized by the covariance matrix γAB estimated by Alice
and Bob. A long but straightforward calculation shows
that
χ(B : E) = g(λ˜1) + g(λ˜2) − g(λ˜3) (67)
where g(x) = (x + 1) log2(x + 1)− xlog2 x is the entropy
of a thermal state with a mean photon number of x and
λ˜k = λk2−1 where
λ2
1,2 =
1 2
(A ± pA2 − 4B) , λ2 3 = v1 + vδ
v + δ (68)
with A = v2(1−2tη)+2tη+[tη(v+δ)]2 and B = [tη(vδ+
1)]2.
In conclusion, the secret key rate achievable against
collective attacks is obtained by inserting expressions
(61) and (67) into
K = R [β I(A : B) − χ(B : E)] . (69)
Finally, we note that the optimality of Gaussian attacks
is actually valid also for protocols that use heterodyne
detection; a bound for security against Gaussian collective attacks in these protocols has been provided recently
(Pirandola, Braunstein and Lloyd, 2008).
6. Collective attacks and post-selection
In the case where all observed data are Gaussian, including the observed noise, we can again provide a security proof which also allows to include post-selection
of data in the procedure. The starting point of this security proof is the protocol with Gaussian distribution
of the amplitude together with the heterodyne detection
by Bob. In this case, in a collective attack scenario, we36
can assume a product structure of the subsequent signals, and the density matrix ρAB of the joint state of
Alice and Bob is completely determined due to the tomographic structure of the source replacement picture
and the measurement. In this scenario, we can therefore
determine the quantum states in the hand of the eavesdropper as Eve holds the system E of the purification
|ΨiABE of ρAB.
Let us consider the situation where all observed data
in this scenario are Gaussian distributions, which is the
typical observation made in experiments. Note that this
is an assumption that can be verified in each run of the
QKD protocol! In principle, one can now just use the
standard formula for the key rate in the collective scenario, Eq. (69). However, we would like to introduce a
post-selection procedure (Silberhorn et al., 2002) to improve the stability of the protocol against imperfections
in the error correction protocol.
To facilitate the introduction of post-selection, we add
further public announcements to the CV QKD protocol: Alice makes an announcement ’a’ consistent of the
imaginary component αy and the modulus of the real
component |αx| of the complex amplitude α of her signals. That leaves two possible signals state open. Similarly, Bob makes an announcement ’b’ which contains
again the complex component βy and the modulus |βx|
of the complex measurement result β of her heterodyne
measurement. That leaves, again, two possible measurements from Eve’s point of view. For any announcement
combination (a, b) we have therefore an effective binary
channel between Alice and Bob. As the purification of
the total state ρAB is known, we can calculate for each
effective binary channel a key rate
∆I(a, b) = max (1 − f(ea,b)h[ea,b] − χa,b), 0 . (70)
This expression contains the post-selection idea in the
way that whenever 1−h[ea,b]−χa,b is negative, the data
are discarded, leading to a zero contribution of the corresponding effective binary channel to the overall key rate.
The expressions for χa,b have been calculated analytically
in (Heid and L¨utkenhaus, 2007), which is possible since
now the conditional states of Eve, as calculated from the
purification of ρAB, are now at most of rank four. Several
scenarios have been considered there, but the one that is
of highest interest is the combination of post-selection
with reverse reconciliation. The explicit expressions are
omitted here, as they do not give additional insight. The
evaluations of the overall key rate
K = R Z da db ∆I(a, b) (71)
is then done numerically.
VI. DISTRIBUTED-PHASE-REFERENCE PROTOCOLS
A. Status of security proofs
As we said in Sec. II.D.4, distributed-phase-reference
protocols were invented by experimentalists, looking for
practical solutions. Only later it was noticed that these
protocols, in addition to be practical, may even yield better rates than the traditional discrete-variable protocols,
i.e. rates comparable to those of decoy-states implementations. The reason is that the PNS attacks are no longer
zero-error attacks both for DPS (Inoue and Honjo, 2005)
and for COW (Gisin et al., 2004; Stucki et al., 2005). In
fact, the number of photons in a given pulse and the
phase coherence between pulses are incompatible physical quantities. At the moment of writing, no lower
bound is known for the unconditional security of DPS or
COW, but several restricted attacks have been studied
(Branciard et al., 2007; Branciard, Gisin and Scarani,
2008; Curty et al., 2007; Curty, Tamaki and Moroder,
2008; Gomez-Sousa and Curty, 2009; Tsurumaru, 2007;
Waks, Takesue and Yamamoto, 2006). In these studies, it has also been noticed that DPS and especially
COW can be modified in a way that does not make
them more complicated, but may make them more robust
(Branciard, Gisin and Scarani, 2008). Since this point
has not been fully developed though, we restrict our attention to the original version of these protocols.
B. Bounds for DPS and COW
1. Collective beam-splitting attack
We present the calculation of the simplest zeroerror collective attack, namely the beam-splitting attack
(Branciard, Gisin and Scarani, 2008). For both DPS
and COW, Alice prepares a sequence of coherent states
Nk |α(k)i: each α(k) is chosen in {+α, −α} for DPS, in
{+α, 0} for COW. Eve simulates the losses with a beamsplitter, keeps a fraction of the signal and sends the remaining fraction τ = t tBη to Bob on a lossless line —
note that, although this security study does not provide
a lower bound, we work in the uncalibrated-device scenario for the sake of comparison with the other protocols.
Bob receives the state Nk |α(k)√τi: in particular, Bob’s
optical mode is not modified, i.e. BSA introduces no error63. Eve’s state is Nk |α(k)√1 − τi; let us introduce
the notations αE = α√1 − τ and
γ = e−|αE|2 = e−µ(1−τ) . (72)
63 Apart from BSA, other attacks exist that do not introduce errors:
for instance, photon-number-splitting attacks over the whole key,
preserving the coherence (these are hard to parametrize and have
never been studied in detail). For COW, there exist also attacks
based on unambiguous state discrimination (Branciard et al.,
2007).37
When Bob announces a detection involving pulses k − 1
and k, Eve tries to learn the value of his bit by looking
at her systems. Assuming that each bit value is equally
probable, Eve’s information is given by IEve = S(ρE) −
12
S(ρE|0) − 12S(ρE|1) with ρE = 1 2ρE|0 + 12ρE|1.
The information available to Eve differs for the two
protocols, because of the different coding of the bits.
In DPS, the bit is 0 when α(k − 1) = α(k) and is 1
when α(k − 1) = −α(k). So, writing Pψ the projector
on |ψi, the state of two consecutive pulses reads ρE|0 =
12
P+αE,+αE + 12P−αE,−αE and ρE|1 = 1 2P+αE,−αE +
12
P−
αE,+αE; therefore, noticing that |h+αE| − αEi| = γ2,
we obtain
IDPS
E,BS(µ) = 2h[(1 − γ2)/2] − h[(1 − γ4)/2] (73)
where h is the binary entropy function, and
K(µ) = νS 1 − e−µt tBη 1 − IE,BS DPS (µ) . (74)
In COW, the bit is 0 when α(k − 1) = √µ, α(k) = 0
and is 1 when α(k − 1) = 0 , α(k) = √µ; so, with similar
notations as above, ρE|0 = P+αE,0 and ρE|1 = P0,+αE;
therefore, noticing that |h+αE|0i| = γ, we obtain
ICOW
E,BS (µ) = h[(1 − γ)/2] . (75)
The secret key rate is given by
K(µ) = ˜ νS 1 − e−µt tBη 1 − IE,BS COW(µ) (76)
where ˜ νS = νS 1−2f because the fraction f of decoy sequences does not contribute to the raw key, and half of
the remaining pulses are empty.
2. More sophisticated attacks
For the purpose of comparison with other protocols
later in this review, it is useful to move away from the
strictly zero-error attacks. As mentioned above, several
examples of more sophisticated attacks have indeed been
found. Instead of looking for the exact optimum among
those attacks, we prefer to keep the discussion simple,
bearing in mind that all available bounds are to be replaced one day by unconditional security proofs.
We consider attacks in which Eve interacts coherently with pairs of pulses (Branciard, Gisin and Scarani,
2008). Upper bounds have been provided in the limit
µt ≪ 1 of not-too-short distances. Even within this
family, a simple formula is available only for COW. For
COW, there is no a priori relation between the error on
the key ε and the visibility V observed on the interferometer. If e−µ ≤ ξ ≡ 2pV (1 − V ), one finds IECOW(µ) = 1:
µ is too large and no security is possible. If on the contrary e−µ > ξ, the best attack in the family yields
ICOW
E (µ) = ε + (1 − ε)h 1 + F2V (µ) (77)
with FV (µ) = (2V − 1)e−µ − ξ√1 − e−2µ. Therefore
K(µ) = R 1 − IECOW(µ) − leakEC(Q) (78)
where the value of R is constrained by the definition of
the attack to be ˜ νS[µt tBη + 2pd].
As for DPS, numerical estimates show that its robustness under the same family of attacks is very similar (slightly better) than the one of COW. Therefore,
we shall use (78) as an estimate of the performances of
distributed-phase-reference protocols in the presence of
errors; again, for the sake of comparison with the other
protocols, we have adopted the uncalibrated-device scenario here64.
VII. COMPARISON OF EXPERIMENTAL PLATFORMS
A. Generalities
After having presented the various forms that practical QKD can take, it is legitimate to try and draw some
comparison. If one would dispose of unlimited financial
means and manpower, then obviously the best platform
would just be the one that maximizes the secret key rate
K for the desired distance. A choice in the real world
will obviously put other parameters in the balance, like
simplicity, stability, cost... Some partial comparisons are
available in the literature; but, to our knowledge, this is
the first systematic attempt of comparing all the most
meaningful platforms of practical QKD. Of course, any
attempt of putting all platforms on equal footing contains elements of arbitrariness, which we shall discuss.
Also, we are bounded by the state-of-the-art, both concerning the performance of the devices and the development of the security proofs, as largely discussed in the
previous sections. We have chosen to compare the best
available bounds, which however do not correspond to the
same degree of security: for the implementations of the
BB84 coding, we have bounds for unconditional security;
for continuous variable systems, we have security against
collective attacks; for the new protocols like COW and
DPS, we have security only against specific families of
attacks. Also, one must be reminded that all security
proofs hold under some assumptions: these have been
discussed in Sections IV, V and VI; it is crucial to check
if they apply correctly to any given implementation.
64 For the family of attacks under study, the rate scales linearly
with the losses, therefore the difference between calibrated and
uncalibrated devices is only due to the dark counts. We have to
warn that the attacks based on unambiguous state discrimination, which have been studied explicitly for calibrated devices
(Branciard et al., 2007), are expected to become significantly
more critical in the uncalibrated-device scenario. However, this
more complex family of attacks can be further restricted by a
careful statistical analysis of the data: we can therefore leave it
out of our analysis, which is anyway very partial.38
As stressed many times, the security of a given QKD
realization must be assessed using measured values. Here,
we have to present some a priori estimates: they necessarily involve choices, which have some degree of arbitrariness. The first step is to provide a model for the
channel: the one that we give (VII.A.1) corresponds well
to what is observed in all experiments and is therefore
rather universally accepted as an a priori model. At the
risk of being redundant, we stress that the actual realization of this specific channel is not a condition for security:
Eve might realize a completely different channel, and the
general formulas for security apply to any case65. Once
the model of the channel accepted, one still has to choose
the numerical values for all the parameters.
1. Model for the source and channel
We assume that the detection rates are those that are
expected in the absence of Eve, given the source and
the distance between Alice and Bob. As for the error
rates, we consider a depolarizing channel with visibility
V . For an a priori choice, the modeling of the channel
just sketched is rather universally accepted. In detail, it
gives the following:
Discrete-variable protocols, P&M. We consider implementations of the BB84 coding. The rate is estimated by
R = ˜ νS[P + Pd] with P = Pn≥1 pA(n)[1 − (1 − t tBη)n]
and Pd = 2pd Pn≥0 pA(n)(1 − t tBη)n. The error rate
in the channel is ε = (1 − V )/2, so the expected error rate is Q = [εP + Pd/2]/(R/ν˜S). For weak coherent pulses without decoy states, pA(1) = e−µµ, pA(n ≥
2) = 1 − e−µ(1 + µ), and we optimize K, given by (31),
over µ. For weak coherent pulses with decoy states, we
consider an implementation in which one value of µ is
used almost always, while sufficiently many others are
used, so that all the parameters are exactly evaluated.
The statistics of the source are as above; Y0 is estimated
by ˜ νS 2pdpA(0)/R, Y1 by ˜ νSpA(1)t tBη/R, and we optimize K given by (34) over µ. For perfect single-photon
sources, pA(1) = 1 and pA(n ≥ 2) = 0; we just compute
(31), as there is nothing to optimize.
Discrete-variable protocols, EB. Again, we consider
implementations of the BB84 coding. Since most of
the experiments have been performed using cw-pumped
sources, we shall restrict to this case66. For such sources,
65 The attacks we studied against DPS and COW, Section VI, do
suppose a model of the channel. This is a signature of the incompleteness of such studies. Security can be guaranteed by adding
that, if the channel deviates from the expected one, the protocol
is aborted. A full assessment of the channel, of course, requires
additional tests: the fact that data can be reproduced by a channel model does not imply that the channel model is correct (for
instance, in weak coherent pulses implementations of BB84 without decoy states, the observed parameters are compatible both
with a BS and a PNS attack).
66 Pulsed sources can be treated in a similar way. For short pulse
the probability of having multiple pairs is ζ = 0 with
good precision, therefore the bounds (42) and (43) for
K are identical. K will be optimized over µ′, the mean
pair-generation rate of the source. Note that νScw given
by Eq. (20) depends on µ′; given this, one has pA(1) ≈ 1
and pA(2) ≈ µ′ ∆t if µ′∆t ≪ 1: indeed, neglecting dark
counts, whenever any of Alice’s detectors fires there is
at least one photon going to Bob; and the probability
that another pair appears during the coincidence window ∆t is approximately µ′∆t. The total expected error
is Q = [(ε+ε′)P +Pd/2]/(R/ν˜S), where ε = (1−V )/2 as
above and ε′ ≈ µ′∆t
2 is the error rate due to double-pair
events.
Continuous-variable protocols. We consider the protocol that uses coherent states with Gaussian modulation,
and compute the best available bound (69), which give
security against collective attacks. The reference beam
is supposed to be so intense, that there is always a signal
arriving at the homodyne detection, so R = ˜ νS. The error is modeled by (58). Now, just as for discrete variable
protocols one can optimize K over the mean number of
photons (or of pairs) µ for each distance, here one can
optimize K over the variance v of the modulation. Note
that this optimization outputs rather demanding values,
so that only recently it has become possible to implement
them in practice, thanks to the latest developments in error correction codes (Leverrier et al., 2008).
Distributed-phase-reference protocols. As mentioned,
apart from the errorless case, a simple formula exists only
for COW, which moreover is valid only at not too short
distances. We use this bound to represent distributedphase reference protocols in this comparison, keeping in
mind that DPS performs slightly better, but that anyway only upper bounds are available. Specifically, we
have R ≈ ν˜S[µt tBη + 2pd]; we optimize then K(µ) given
by (78) over µ, and keep the value only if µoptt ≤ 0.1.
The expected error rate is formally the same as for P&M
BB84; recall however that here the bit-error ε is not related to the visibility of the channel and must be chosen
independently.
2. Choice of the parameters
We shall use two sets of parameters (Table II): set #1
corresponds to today’s state-of-the-art, while set #2 reflects a more optimistic but not unrealistic development.
Moreover, we make the following choices:
schemes, one would have pA(1) ≈ µ and pA(2) ≈ 3 4µ2 if µ ≪ 1;
for long-pulse pumping, the statistics of pairs is approximately
Poissonian: pA(1) ≈ µ and pA(2) ≈ µ2/2 if µ ≪ 1 and the
most of the multi-pair events are uncorrelated. In both cases,
the intrinsic error rate due to double-pair events is ε′ ≈ µ/2
(Eisenberg et al., 2004; Scarani et al., 2005). Note that the parameter ζ may be different from 0 in the case of short pulse
schemes.39
Platform Parameter Set #1 Set #2
µ mean intensity (opt.) (opt.)
V visibility: P&M 0.99 0.99
V visibility: EB 0.96 0.99
BB84, tB transmission in Bob’s device 1 1
COW η det. efficiency 0.1 0.2
pd dark counts 10−5 10−6
ε (COW) bit error 0.03 0.01
ζ (EB) coherent 4 photons 0 0
leak EC code 1.2 1
v = vA + 1 variance (opt.) (opt.)
ε optical noise 0.005 0.001
CV η det. efficiency 0.6 0.85
vel electronic noise 0.01 0
β EC code 0.9 0.9
TABLE II Parameters used for the a priori plots in this Section. See main text for notations and comments. The caption
(opt.) means that the parameter will be varied as a function
of the distance in order to optimize K.
• Unless specified otherwise (see VII.B.2), the plots
use the formulas for the uncalibrated-device scenario. The reason for this choice is the same as discussed in Sec. III.B.5: unconditional security has
been proved only in this over-pessimistic scenario.
• Since we are using formulas that are valid only in
the asymptotic regime of infinitely long keys, we remove the nuisance of sifting by allowing an asymmetric choice of bases or of quadratures. Specifically, this leads to ˜ νS = νS for both BB84 and
continuous-variables. Similarly, for COW we can
set f = 0, whence ˜ νS = νS/2.
• For definiteness, we consider fiber-based implementations; in particular, the relation between distance
and transmission will be (17) with α = 0.2dB/km;
and the parameters for photon counters are given at
telecom wavelengths (Table II). The reader must
keep in mind that in free space implementations,
where one can work with other frequencies, the
rates and the achievable distance may be larger.
B. Comparisons based on K
1. All platforms on a plot
As a first case study, we compare all the platforms on
the basis by plotting K/νS as a function of the transmittivity t of the channel. The result is shown in Fig. 4. As
promised, we have to stress the elements of arbitrariness
in this comparison (in addition to the choices discussed
above). First of all, we recall that the curves do not
correspond to the same degree of security (see VII.A).
Second, we have considered “steady-state” key rates, because we have neglected the time needed for the classical
post-processing; this supposes that the setup is stable
enough to run in that regime (and it is fair to say that
many of the existing platforms have not reached such a
stage of stability yet). Third, the real performance is of
course K: in particular, if some implementations have
bottlenecks at the level of νS (see III.A), the order of the
curves may change significantly.
0 5 10 15 20 25 30 35 40
10−6
10−4
10−2
100
t [dB]
K/ν
S
WCP COW decoy
EB
1−ph
CV
0 5 10 15 20 25 30 35 40
10−6
10−4
10−2
100
t [dB]
K/ν
S
WCP
COW
decoy
CV
EB
1−ph
FIG. 4 (Color online). K/νS as a function of the transmittivity t, for all the platforms. Legend: 1-ph: perfect singlephoton source, unconditional; WCP: weak coherent pulses
without decoy states, unconditional; decoy: weak coherent
pulses with decoy states, unconditional; EB: entanglementbased, unconditional; CV: continuous-variables with Gaussian modulation, security against collective attacks; COW:
Coherent-One-Way, security against the restricted family of
attacks described in Sec. VI.B.2. Parameters from Table II:
set #1 upper graph, set #2 lower graph.40
2. Upper bound incorporating the calibration of the devices
As a second case study, we show the difference between
the lower bounds derived in the uncalibrated-device scenario, and some upper bounds that incorporate the calibration of the devices.
We focus first on BB84 implemented with weak coherent pulses; the upper bounds under study have been
derived in Sec. IV.C. The plots in Fig. 5 show how
much one can hope to improve the unconditional security
bounds from their present status. As expected, the plot
confirms that basically no improvement is expected for
implementations with decoy states, because there only
the treatment of dark counts is different; while the bound
for implementations without decoy states may still be the
object of significant improvement.
0 5 10 15 20 25 30
10−6
10−4
10−2
t [dB]
K/ν
S
WCP decoy
FIG. 5 (Color online). K/νS as a function of the transmission
t for the P&M implementations of BB84 with weak coherent
pulses: comparison between the lower bound (solid lines, same
as in Fig. 4, upper graph) and the upper bound for calibrated
devices (dashed lines). Legend as in Fig. 4. Parameters from
Table II, set #1.
We turn now to CV QKD with Gaussian modulation.
Bounds for the security against collective attacks assuming calibrated devices are given in Eqs (5)-(12) of
(Lodewyck, Bloch et al., 2007). The plots are shown in
Fig. 6. One sees that the difference between the two
scenarios is significant for set #1 of parameters, but is
negligible for the more optimistic set #2. This is interesting, given that the efficiency η of the detectors is “only”
85% in set #2.
C. Comparison based on the “cost of a linear network”
We consider a linear chain of QKD devices, aimed at
achieving a secret key rate Ktarget over a distance L.
Many devices can be put in parallel, and trusted repeater
stations are built at the connecting points. Each individual QKD device is characterized by the point-to-point
0 5 10 15 20 25 30 35 40
10−4
10−2
100
t [dB]
K/ν
S
set #1
set #2
FIG. 6 (Color online). K/νS as a function of the transmission
t for CV QKD with Gaussian modulation, security against
collective attacks, comparison between the lower bound (solid
lines, same as in Fig. 4) and the upper bound for calibrated
devices (dashed lines) for both sets of parameters from Table
II. Compared to Fig. 4, the color of the lines of set #1 was
changed for clarity.
rate K(ℓ) it can achieve as a function of the distance ℓ,
and by its cost C1. We need N = Lℓ KKtarget (ℓ) devices to
achieve the goal, so the cost of the network is67
Ctot[ℓ] = C1 L
ℓ
K
target
K(ℓ) . (79)
The best platform is the one that minimizes this cost,
i.e., the one that maximizes F(ℓ) = ℓK(ℓ). This quantity,
normalized to νS, is plotted in Fig. 7 as a function of the
distance for both sets of parameters defined in Table II.
Of course, this comparison presents the same elements of
arbitrariness as the previous one.
The optimal distances are quite short, and this can be
understood from a simple analytical argument. Indeed,
typical behaviors are K(ℓ) ∝ t (single-photon sources, attenuated lasers with decoy states, strong reference pulses)
and K(ℓ) ∝ t2 (weak coherent pulses without decoy
states). Using t = 10−αℓ/10, it is easy to find ℓopt which
maximizes F(ℓ):
K(ℓ) ∝ tk −→ ℓopt = 10/(kαln 10). (80)
In particular, for α ≈ 0.2dB/km, one has ℓopt ≈ 20km
for k = 1 and ℓopt ≈ 10km for k = 2.
In conclusion, our toy model suggests that, in a network environment, one might not be interested in pushing the maximal distance of the devices; in particular, detector saturation (which we neglected in the plots
67 In this first toy model, we neglect the cost of the trusted repeater
stations; see (All´eaume et al., 2008) for a more elaborated model.41
above) may become the dominant problem instead of
dark counts.
0 50 100 150 200
10−4
10−3
10−2
10−1
100
distance [km]
F/ν
S
EB
COW
WCP
CV
1−ph
decoy
0 50 100 150 200
10−4
10−3
10−2
10−1
100
101
distance [km]
F/ν
S
EB
decoy
WCP COW
CV
1−ph
FIG. 7 (Color online). F/νS as a function of the distance ℓ
for all the platforms. Legend as in Fig. 4. Parameters from
Table II: set #1 upper graph, set #2 lower graph.
VIII. PERSPECTIVES
A. Perspectives within QKD
1. Finite-key analysis
As stressed, all the security bounds presented in this
review are valid only in the asymptotic limit of infinitely long keys. Proofs of security for finite-length
keys are obviously a crucial tool for practical QKD.
The estimate of finite-key effects, unfortunately, has
received very limited attention so far. The pioneering works (Inamori, L¨utkenhaus and Mayers, 2001-2007;
Mayers, 1996), as well as some subsequent ones (Hayashi,
2006; Watanabe et al., 2004), have used non-composable
definitions of security (see II.C.2). This is a problem
because the security of a finite key is never perfect, so
one needs to know how it composes with other tasks.
Others studied a new formalism but failed to prove
unconditional security (Meyer et al., 2006). The most
recent works comply with the requirements (Hayashi,
2007a; Scarani and Renner, 2008); finite statistics have
been incorporated in the analysis of an experiment
(Hasegawa et al., 2007). Without going into details, all
these works estimate that no key can be extracted if fewer
than N ≈ 105 signals are exchanged.
2. Open issues in unconditional security
We have said above that, for CV QKD and distributedphase reference protocols, no unconditional security
proof is available yet. However, there is an important
difference between these cases. In the existing CV QKD
protocols, the information is coded in independent signals; as such, it is believed that unconditional security
proofs can be built as generalizations of the existing ones
(see also Note added in proof below). On the contrary,
the impossibility of identifying signals with qubits in
distributed-phase reference protocols will require a completely different approach, which nobody has been able
to devise at the moment of writing.
As explained in Sec. III.B.5, all unconditional security proofs have been derived under the over-conservative
assumption of uncalibrated devices. Ideally, such an assumption should be removed: one should work out unconditional security proofs taking into account the knowledge about the detectors; this would lead to better rates.
A possible solution consists in including the calibration of
the devices in the protocol itself; the price to pay seems
to be a complication of the setup (Qi et al., 2007). The
idea is somehow similar to the one used in decoy states.
We also discussed how calibrated-device proofs may ultimately provide significant improvement only for some
protocols (see VII.B.2). The difference between protocols
can be understood from the fact that typically K ∼ tα
where t is the transmittance and α ≥ 1. When α = 1,
then the only advantage of calibrating the devices can
come from the dark count contribution. If on the contrary α > 1 (weak coherent pulses without decoy states:
α = 2 for BB84, α = 3 2 for SARG04), then the difference is much larger, because it matters whether tBη is
included in the losses or not. The urgency of this rather
ungrateful68 task is therefore relative to the choice of a
68 Here is an example of the complications that might appear.
When taking the calibration into account, it is often assumed
that the dark counts do not enter in Eve’s information. Actually, things are more subtle. On the one hand, most of the dark
counts will actually decrease Eve’s information, because she does
not know if a detection is due to the physical signal (on which she42
protocol.
3. Black-box security proofs
The development of commercial QKD systems makes
it natural to ask whether the “quantumness” of such devices can be proved in a black-box approach. Of course,
the compulsory requirements (II.C.1) must hold. For instance, the random number generator cannot be within
the black box, because it must be trusted; one must also
make sure that no output port is diffusing the keys on the
internet; and so on. Remarkably though, all the quantum part can in principle be kept in a black-box. The
idea is basically the one that triggered Ekert’s discovery (Ekert, 1991), although Ekert himself did not push
it that far: the fact, that Alice and Bob observe correlations that violate a Bell inequality, is enough to guarantee
entanglement, independent of the nature of the quantum
signals and even of the measurements that are performed
on them. This has been called “device-independent security”; a quantitative bound was computed for collective attacks on a modification of Ekert’s protocol, the
goal of proving unconditional security is still unattained
(Ac´ın et al., 2007). Device-independent security can be
proved only for entanglement-based schemes: for this definition of security, the equivalence EB-P&M presented in
Sec. II.B.2 does not hold. As long as the detection loophole is open, these security proofs cannot be applied to
any system; but by re-introducing some knowledge of the
devices, they might provide a good tool for disposing of
all quantum side-channels (III.B.4).
4. Toward longer distances: satellites and repeaters
The attempt of achieving efficient QKD over long
distances is triggering the most ambitious experimental developments. Basically two solutions are being envisaged. The first is to use the techniques of
free space quantum communication to realize groundto-satellite links (Aspelmeyer et al., 2003; Buttler et al.,
1998; Rarity et al., 2002). The main challenges are technical: to adapt the existing optical tracking techniques
to the needs of quantum communication, and to build
devices that can operate in a satellite without need of
maintenance.
The second solution are quantum repeaters
(Briegel et al., 1998; D¨ur et al., 1999). The basic
has gained some information) or is a completely random event.
On the other hand, if a detection happens shortly after a previous
one, Eve may guess that the second event is in fact a dark count
triggered by an afterpulse, and therefore learn some correlations
between the two results. Admittedly, these are fine-tuning corrections, and have never been fully discussed in the literature; but
if one wants to prove unconditional security, also these marginal
issues must be properly addressed.
idea is the following: the link A-B is cut in segments
A-C1, C1-C2, ..., Cn-B. On each segment independently,
the two partners exchange pairs of entangled photons,
which may of course be lost; but whenever both partners
receive the photon, they store it in a quantum memory.
As soon as there is an entangled pair on each link, the
intermediate stations perform a Bell measurement, thus
ultimately swapping all the entanglement into A-B.
Actually, variations of this basic scheme may be more
practical (Duan et al., 2001). Whatever the exact implementation, the advantage is clear: one does not have
to ensure that all the links are active simultaneously;
but the advantage can only be achieved if quantum
memories are available. The experimental research in
quantum memories has boosted over the last years, but
the applications in practical QKD are still far away
because the requirements are challenging (see Appendix
B).
Teleportation-based links have been studied also in
the absence of quantum memories (quantum relays).
They are rather inefficient, but allow to reduce the nuisance of the dark counts and therefore increase the limiting distance (Collins, Gisin and de Riedmatten, 2005;
Jacobs, Pittman and Franson, 2002); however, it seems
simpler and more cost-effective to solve the same problem by using cryogenic detectors (see II.G).
5. QKD in networks
QKD is a point-to-point link between two users. But
only a tiny fraction of all communication is done in dedicated point-to-point links, most communication takes
place in networks, where many users are interconnected.
Note that one-to-many connectivity between QKD devices can be obtained with optical switching (Elliott,
2002; Elliott et al., 2005; Townsend et al., 1994).
In all models of QKD networks, the nodes are operated
by authorized partners, while Eve can eavesdrop on all
the links. If the network is built with quantum repeaters
or quantum relays, no secret information is available to
the nodes: indeed, the role of these nodes is to perform
entanglement swapping, so that Alice and Bob end up
with a maximally entangled — therefore fully private
— state. Since quantum repeaters are still a challenge,
trusted relays QKD networks have been considered. In
this case, the nodes learn secret information during the
protocol. In the simplest model, a QKD key is created between two consecutive nodes and a message is encrypted
and decrypted hop-by-hop. This model has been adopted
by BBN Technologies and by the SECOQC QKD
networks (All´eaume et al., 2007; Dianati and All´eaume,
2006; Dianati et al., 2008; Elliott, 2002; Elliott et al.,
2005). Alternatively, the trusted relays can perform an
intercept-resend chain at the level of the quantum signal
(Bechmann-Pasquinucci and Pasquinucci, 2005).43
B. QKD versus other solutions
Information-theoretically (unconditionally) secure key
distribution (key agreement), is a cryptographic task
that, as is well known, cannot be solved by public communication alone, i.e. without employing additional resources or relying on additional assumptions. Besides
QKD, the additional resource in this case being the
quantum channel, a number of alternative schemes to
this end have been put forward (Ahlswede and Csisz´ar,
1993; Csisz´ar and K¨orner, 1978; Maurer, 1993; Wyner,
1975), to which one can also count the traditional trusted
courier approach (All´eaume et al., 2007). While the latter is still used in certain high security environments,
QKD is the sole automatic, practically feasible and efficient information-theoretically secure key agreement
technology, whereby in the point-to-point setting, limitations of distance and related key rate apply. These
limitations can be lifted by using QKD networks, see
VIII.A.
With this in mind, we address below typical secure
communication solutions in order to relate this subsequently to the assets offered by QKD. Secure communication in general requires encrypted (and authentic)
transition of communication data. In current standard
cryptographic practice both the encryption schemes and
the key agreement protocols used (whenever needed) are
not unconditionally secure. While there is really a very
broad range of possible alternatives and combinations,
the most typical pattern for confidential communication is the following: public key exchange protocols are
used to ensure agreement of two identical keys; the encryption itself is done using symmetric-key algorithms.
In particular, most often some realization of the DiffieHellman algorithm (Diffie and Hellman, 1976) is used in
the key agreement phase. The symmetric-encryption algorithms most widely used today belong to the bloccipher class and are typically 3DES (Coppersmith et al.,
1996)or AES (Daemen and Rijmen, 2001).
The security of the Diffie-Hellman algorithm is based
on the assumption that the so called Diffie-Hellman problem is hard to solve, the complexity of this problem being
ultimately related to the hardness of the discrete logarithm problem (see (Maurer and Wolf, 1999, 2000) for
a detailed discussion). It is widely believed, although
it was never proven, that the discrete logarithm problem is classically hard to solve. This is not true in the
quantum case, since a quantum computer, if available,
can execute a corresponding efficient algorithm by Peter Shor (Shor, 1994, 1997), which is based on the same
fundamental approach as is the Shor factoring algorithm,
already mentioned in Sec. I.A.
It should be further noted that that, similar to QKD,
the Diffie-Hellman protocol can trivially be broken, if
the authenticity of the communication channel is not
ensured. There are many means to guarantee communication authenticity with different degrees of security
but in any case additional resources are needed. In current common practice public key infrastructures are employed, which in turn rely on public-key cryptographic
primitives (digital signatures), i.e. rely on similar assumptions as for the Diffie-Hellman protocol itself, and
on trust in external certifying entities.
Turning now to encryption it should be underlined that
the security of a block-cipher algorithm is based on the
assumption that it has no structural weaknesses, i.e. that
only a brute force attack amounting to a thorough search
of the key space (utilizing pairs of cipher texts and corresponding known or even chosen plain texts) can actually
reveal the secret key. The cost of such an attack on a
classical computer is O(N) operations, where N is the
dimension of the key space. The speed-up of a quantum computer in this case is moderate, the total number
of operations to be performed being O(√N) (Grover,
1996, 1997). The assumption on the lack of structural
weaknesses itself is not related to any particular class of
mathematical problems and in the end relies merely on
the fact that such a weakness is not (yet) known. Cryptographic practice suggests that for a block-cipher algorithm such weaknesses are in fact discovered at the latest
a few decades after its introduction69.
Before turning to a direct comparison of the described
class of secure communication schemes with QKD-based
solutions, it should be explained why public-key based
generation combined with symmetric-key encryption is
actually the most proliferated solution. The reason is
that currently AES or 3DES encryption, in contrast to
direct public-key (asymmetric) encryption, can ensure a
high encryption speed and appears optimal in this respect. Typically high speed is achieved by designing dedicated hardware devices, which can perform encryption
at very high rate and ensure a secure throughput of up
to 10Gb per second. Such devices are offered by an increasing number of producers (see e.g. ATMedia GmbH,
www.atmedia.de) and it is beyond the scope of the current article to address these in any detail. We would like
however to underline an important side-aspect. In general, security of encryption in the described scenario is
increased by changing the key often, the rate of change
being proportional to the dimension of the key space. In
practice, however, even in the high speed case, the key
is changed at a rate lower than once per minute (often
once per day or even more seldom). The reason for this
is twofold: on the one hand public key agreement algorithms are generally slow and on the other, and more
importantly, current design of the mentioned dedicated
encryption devices is not compatible with a rapid key
change.
The question now is how QKD compares with the standard practice as outlined above. It is often argued that
QKD is too slow for practical uses and that the limited
distance due to the losses is a limitation to the system as
69 Vincent Rijmen, private communication.44
such. In order to allow for a correct comparison one has
to define the relevant secure communication scenarios.
There are two basic possibilities: (i) QKD is used in conjunction with One-Time Pad, (ii) QKD is used together
with some high speed encryptor (we note in passing that
the second scenario appears to be a main target for the
few QKD producers).
The rate as a function of distance has been discussed in
detail in the preceding sections. Here we shall consider an
average modern QKD device operating in the range of 1
to 10kbps over 25 km; the maximal distance of operation
at above 100 bps being around 100 km.
Case (i) obviously offers information-theoretic security
of communication if the classical channel, both in the
key generation and the encryption phase, is additionally authenticated with the same degree of security. As
this overhead to this end is negligible the QKD generation rates as presented above are also the rates for secure communication. Obviously this is not sufficient for
broad-band data transmission but pretty adequate for
communicating very-highly sensitive data. Another advantage of this combination is the fact that keys can be
stored for later use.
The security of the case (ii) is equivalent to the security
of the high speed encryption, which we addressed above,
while all treats related to the key generation-phase are
eliminated. At 25 km the QKD speed would allow key
refreshment (e.g. in the case of AES with 256 bit key
length) of several times per second. This is remarkable
for two reasons: first, this is on or rather beyond the
key-exchange capacity of current high speed encryptors;
second, it compares also to the performances of high level
classical link encryptors, which refresh AES keys a few
times per second using Diffie-Hellman elliptic curve cryptography for key generation.
So in the second scenario QKD over performs the standard solution at 25 km distance both in terms of speed
and security.
Regarding the distance an interesting point is that classical high-end encryptors use direct dark fibers, not for
reasons related to security but for achieving maximal
speed, which also gives them a limitation in distance.
However, classical key generation performed in software
is naturally not bounded by the distance. In this sense
standard public-key based key agreement appears superior. This is however a QKD limitation, which is typical
for the point-to-point regime. As mentioned above, it is
lifted in QKD networks.
Note added in proof
While this paper was being finalized, three groups have
independently claimed to have solved one of the pending issues toward unconditional security proofs of CV
QKD (see Sec. V.A): namely, the fact that the security
bound for collective and for general attacks should coincide asymptotically. On the one hand, a new exponential
de Finetti theorem has been presented, which would apply to infinite-dimensional systems under some assumptions that are fulfilled in CV QKD (Renner and Cirac,
2009; ?). A different argument reaches the same conclusion without any need for a de Finetti-type theorem
altogether (Leverrier, Karpov, Grangier and Cerf, 2008).
Acknowledgements
This paper has been written within the European
Project SECOQC. The following members of the QIT
sub-project have significantly contributed to the report
that formed the starting point of the present review: Stefano Bettelli, Kamil Br´adler, Cyril Branciard, Nicolas
Gisin, Matthias Heid, Louis Salvail.
During the preparation of this review, we had further fruitful exchanges with the above-mentioned colleagues, as well as with: Romain All´eaume, Lucie
Bart˚uˇskov´a, Alexios Beveratos, Hugues De Riedmatten,
Eleni Diamanti, Artur Ekert, Philippe Grangier, Fr´ed´eric
Grosshans, Hannes Huebel, Micha l Horodecki, Masato
Koashi, Christian Kurtsiefer, Antia Lamas-Linares, Anthony Leverrier, Hoi-Kwong Lo, Chiara Macchiavello,
Michele Mosca, Miguel Navascu´es, Andrea Pasquinucci, Renato Renner, Andrew Shields, Christoph Simon,
Kiyoshi Tamaki, Akihisa Tomita, Yasuhiro Tokura, Zhiliang Yuan, Hugo Zbinden.
APPENDIX A: Unconditional security bounds for BB84
and six-states, single-qubit signals
In this Appendix, we present a derivation of the unconditional security bounds for the BB84 (Shor and Preskill,
2000) and the six-state protocol (Lo, 2001) for the case
where each quantum signal is a single qubit, or more
generally when the quantum channel is a qubit channel
followed by a qubit detection70.
As usual, the proof is done in the EB scheme, the
application to the P&M case following immediately as
discussed in Sec. II.B.2. Alice produces the state
|Φ+i = √12 (|00i + |11i), she keeps the first qubit and
sends the other one to Bob. This state is such that
hσz ⊗ σzi = hσx ⊗ σxi = +1 (perfectly correlated outcomes) and hσy ⊗ σyi = −1 (perfectly anti-correlated
outcomes); to have perfect correlation in all three bases,
Bob flips his result when he measures σy. We suppose
an asymmetric implementation of the protocols: the key
is extracted only from the measurements in the Z basis,
which is used almost always; the other measurements are
used to estimate Eve’s knowledge on the Z basis, and
70 For real optical channels, we assume therefore the tagging
method for real sources and the squashing model for the detection, see IV.A.2.45
will be used on a negligible sample (recall that we work
in the asymptotic regime of infinitely long keys).
Now we follow the techniques
of (Kraus, Gisin and Renner, 2005;
Renner, Gisin and Kraus, 2005). Without loss of
generality, the symmetries of the BB84 and the six-state
protocols71 imply that one can compute the bound by
restricting to collective attacks, and even further, to
those collective attacks such that the final state of Alice
and Bob is Bell-diagonal:
ρAB = λ1|Φ+ihΦ+| + λ2|Φ−ihΦ−|
+λ3|Ψ+ihΨ+| + λ4|Ψ−ihΨ−| (A1)
with Pi λi = 1. Since |Φ±i give perfect correlations in
the Z basis, while |Ψ±i give perfect anti-correlations, the
QBER εz is given by
εz = λ3 + λ4 . (A2)
The error rates in the other bases are
εx = λ2 + λ4 , εy = λ2 + λ3 . (A3)
Eve’s information is given by the Holevo bound (24)
IE = S(ρE)−12S(ρE|0)−12S(ρE|1) since both values of the
bit are equiprobable in this attack. Since Eve has a purification of ρAB, S(ρE) = S(ρAB) = H ({λ1, λ2, λ3, λ4}) ≡
H(λ) where H is Shannon entropy. The computation of
ρE|b is made in two steps. First, one writes down explicitly the purification72 |ΨiABE = Pi √λi|ΦiiAB|eiiE,
where we used an obvious change of notation for the
Bell states, and where hei|eji = δij. Then, one traces
out Bob and projects Alice on | + zi for b = 0, on
| − zi for b = 1. All calculations done, the result is
S(ρE|0) = S(ρE|1) = h(εz). So we have obtained
IE(λ) = H(λ) − h(εz). (A4)
Now we have to particularize to the two protocols under
study.
Let’s start with the six-state protocol. In this case,
both εx and εy are measured, so all the four λ’s are directly determined. After easy algebra, one finds
IE(ε) = εz h 1 + (εx 2− εy)/εz 
+(1 − εz)h 1 − (εx1+−εyεz+ εz)/2 . (A5)
71 Actually, a lower bound can be computed in the same way for
a very general class of protocols; but it may not be tight, as
explicitly found in the case of SARG04 (Branciard et al., 2005;
Kraus, Branciard and Renner, 2007).
72 All purifications are equivalent under a local unitary operation
on Eve’s system, so Eve’s information does not change with the
choice of the purification.
Under the usual assumption of a depolarizing channel,
εx = εy = εz = Q, this becomes
IE(Q) = Q + (1 − Q)h 1 −1 −3Q/ Q 2 . (A6)
The corresponding secret fraction (one-way postprocessing, no pre-processing and perfect error correction) is r = 1 − h(Q) − IE(Q), which goes to 0 for
Q ≈ 12.61%.
The calculation is slightly more complicated for BB84,
because there only εx is measured; therefore, there is still
a free parameter, which must be chosen as to maximize
Eve’s information. The simplest way of performing this
calculation consists in writing λ1 = (1 − εz)(1 − u), λ2 =
(1 − εz)u, λ3 = εz(1 − v), λ4 = εzv, where u, v ∈ [0, 1]
are submitted to the additional constraint
(1 − εz)u + εzv = εx . (A7)
Under this parametrization, H(λ) = h(εz)+(1−εz)h(u)+
εzh(v) and consequently
IE(λ) = (1 − εz)h(u) + εzh(v) (A8)
to be maximized under the constraint (A7). This can be
done easily by inserting v = v(u) and taking the derivative with respect to u. The result is that the optimal
choice is u = v = εx so that
IE(ε) = h (εx). (A9)
The usual case is εx = εz = Q, which however here does
not correspond to the depolarizing channel: the relations
above imply εy = 2Q(1 − Q), which corresponds to the
application of the so-called “phase-covariant cloning machine” (Brußet al., 2000; Griffiths and Niu, 1997). The
corresponding secret fraction (again for one-way postprocessing, no pre-processing and perfect error correction) is r = 1 − h(Q) − IE(Q), which goes to 0 for
Q ≈ 11%.
APPENDIX B: Elementary estimates for quantum
repeaters
1. Quantum memories
A quantum memory is a device that can store an
incoming quantum state (typically, of light) and reemit it on demand without loss of coherence. A
full review of the research in quantum memories is
clearly beyond our scope. Experiments are being pursued using several techniques, like atomic ensembles
(Chou et al., 2007; Julsgaard et al., 2004), NV centers
(Childress et al., 2006), doped crystals (Alexander et al.,
2006; Staudt et al., 2007).
Two characteristics of quantum memories are especially relevant for quantum repeaters. A memory is called
multimode if it can store several light modes and one46
A B
A C B
M M
A B
M M
C1 D C2
FIG. 8 Three configurations for quantum repeaters: direct
link, two-link repeater and four-link repeater.
can select which mode to re-emit; multimode memories
are being realized (Simon et al., 2007). A memory is
called heralded if its status (loaded or not loaded) can
be learned without perturbation; there is no proposal
to date on how to realize such a memory, and repeater
schemes have been found that work without heralded
memories (Duan et al., 2001).
2. Model of quantum repeater
Here we present a rapid comparison of the direct link
with the two-link repeater and discuss the advantages and
problems that arise in more complex repeaters. We consider the architecture sketched in Fig. 8, corresponding
to the original idea (Briegel et al., 1998).
a. Definition of the model
Our elementary model is described as follows:
• Source: perfect two-photon source with repetition
rate νS;
• Quantum channel: the total distance between Alice
and Bob is ℓ. The channel is noiseless; its losses
characterized by α, we denote t = 10−αℓ/10 the
total transmittivity.
• Detectors of Alice and Bob: efficiency η; neglected
dark counts, dead-time and other nuisances.
• Quantum memories: multimode memories that can
store N modes. We write pM the probability that
a photon is absorbed, then re-emitted on demand
(contains all the losses due to coupling with other
elements). The memory has a typical time TM,
that we shall consider as a life-time73.
• Bell measurement: linear optics, i.e. probability
of success 1
2. Fidelity F, depolarized noise (i.e. a
detection comes from the desired Bell state with
probability F, from any of the others with equal
probability (1 − F)/3). The detectors have efficiency ηM and no dark counts.
b. Detection rates
For the direct link, the key rate is just the detection
rate in our simplified model:
K1 = R1 = νStη2 . (B1)
In the two-link repeater, the central station (Christoph)
holds the two sources and the memories. Consider one
of the links, say with Alice. The source produces groups
of N pairs, each pair in a different mode; one photon per
pair is kept in the memory, the other is sent to Alice.
Alice announces whether she has detected at least one
photon: if she has, Christoph notes which one; if she has
not, Christoph releases the memory and starts the protocol again. The same is happening on the other link,
the one with Bob, independently. As soon as both partners have announced a detection, Christoph releases the
corresponding photons, performs the Bell measurement
and communicates the result to Alice and Bob, who postselect their results accordingly74. Note that the memories
need not be heralded in this scheme.
Here is the quantitative analysis of the two-link repeater. Any elementary run takes the time for the photon
to go from the source to the detector, then for the communication to reach back Christoph, i.e. ℓ/c. In each run,
the probability of a detection is 1−(1− √tη)N ≈ N√tη.
Then, in average, the Bell measurement will be performed after a time75 τ ≈ 3
2
ℓ/c
N√tη. Consequently,
R2 = ( τ−1 1 20 otherwise p2 MηM2 if τ < TM (B2)
73 That is, photons may be lost but do not decohere in the memory.
Note that this can be the case even if the atoms, which form the
memory, do undergo some decoherence (Staudt et al., 2007).
74 Recall that there is no time-ordering in quantum correlations:
so, this procedure gives exactly the same statistics as the “usual”
entanglement swapping, in which the Bell measurement is made
beforehand.
75 In fact, let x = 1 − (1 − √tη)N : the probability that Alice’s
(Bob’s) detector is activated by the m-th group of N pairs is
p1(m) = x(1−x)m−1. Therefore, the probability that both links
are activated exactly by the n-th repetition is p(n) = 2p1(n)p1(<
n) + p1(n)2 = x(1 − x)n−1[2 − (2 − x)(1 − x)n−1] with p1(<
n) = Pn m−=1 1 p1(m). Finally, the number of repetitions needed
to establish the link is hni = Pn np(n) = x1 32−−2xx.47
0 100 200 300 400 500 600 700
10−5
100
105
1010
distance [km]
(b)
(a)
(c)
FIG. 9 Comparison of K1 (straight line) and K2. For all
curves: νS = 10GHz, η = 0.5, ηM = 0.9, pM = 0.9, α =
0.2dB/km (fibers), TM = 10s. Line (a): best case, N = 1000,
F = 0.95; line (b): N = 1000, fidelity reduced to F = 0.9;
line (c): supported modes reduced to N = 100, F = 0.95.
where we have supposed that the memory time TM defines a sharp cut, which is another simplification. This
is the expected result: R2 scales with √tη and not with
tη2, because each link can be activated independently.
Finally, in our model, the error rate is uncorrelated with
the other parameters and only due to the fidelity of the
Bell measurement; so
K2 = R2 [1 − 2h(ε)] (B3)
with ε = 2
3(1−F) because one of the “wrong” Bell states
gives nevertheless the correct bit correlations. In particular, the fidelity of a Bell measurement must exceed 83.5%
to have K2 > 0.
Some plots of K1 and K2 as a function of the distance
are shown in Fig. 9. The chosen values are already optimistic extrapolations of what could be achieved in a not
too distant future. We notice that quantum repeaters
overcome the direct link for ℓ >
∼ 500km in fibers; with
η = 0.5 and N = 1000, this requires TM ≈ 10s. Also,
the number of modes supported by the memory is a more
critical parameter than the fidelity of the Bell measurement. This analysis provides a rough idea of the performances to be reached in order for quantum repeaters to
be useful.
For the next step, the four-link repeater, we content
ourselves with a few remarks. The four-link repeater allows in principle to reach the scaling R4 ∝ t1/4. The
requirements for a practical implementation, however,
become more stringent: the four memories must be released before TM; there are three Bell measurements, so
ε < 11% requires F > ∼ 95%; also, pM′ ≈ pMt1/4. Moreover, it is easy to realize that the basic scheme (Fig. 8)
requires heralded memories, although other schemes do
not (Duan et al., 2001).
